/home/mdzhang/miniconda3/envs/llama/lib/python3.9/site-packages/trl/trainer/ppo_config.py:141: UserWarning: The `optimize_cuda_cache` arguement will be deprecated soon, please use `optimize_device_cache` instead.
  warnings.warn(
-->root_dir /root/autodl-tmp/mdzhang/text-classification
-->device cuda:0
-->debias_args
DebiasArguments(target='group', threshold=0.05, save_dir='models/hate_speech_white_llama/', baseline_metrics='dataset/hate_speech_white/baseline_metric_llama.jsonl', do_debias=True, do_get_baseline=False, do_get_baseline_with_editor=False, gamma=[0.6, 0.7, 0.8, 0.9, 1.0], epoch=5, batch_size=98, train_learning_rate=0.001, train_data='dataset/hate_speech_white/train.csv', test_data='dataset/hate_speech_white/test.csv', train_data_identity='dataset/hate_speech_white/train_identity.csv', test_data_identity='dataset/hate_speech_white/test_identity.csv', baseline_metric_group=0.000180115, baseline_metric_ind=0.069814164, baseline_fpr_train=0.002308568, baseline_fnr_train=0.000180115, privileged_label=1, debias_path_directory='models/hate_speech_white_llama/individual_0.05_0.0')
-->arguments:
ModelArguments(model_name_or_path='./output/hate_speech_white_llama/', config_name=None, tokenizer_name=None, cache_dir='/root/autodl-tmp/mdzhang/tmp', use_fast_tokenizer=True, model_revision='main', use_auth_token=False, ignore_mismatched_sizes=False)
DataTrainingArguments(task_name=None, dataset_name=None, dataset_config_name=None, max_seq_length=128, overwrite_cache=False, pad_to_max_length=True, max_train_samples=None, max_eval_samples=None, max_predict_samples=None, train_file='dataset/hate_speech_white/train.csv', validation_file='dataset/hate_speech_white/test.csv', test_file='dataset/hate_speech_white/test.csv')
TrainingArguments(
_n_gpu=3,
adafactor=False,
adam_beta1=0.9,
adam_beta2=0.999,
adam_epsilon=1e-08,
auto_find_batch_size=False,
bf16=False,
bf16_full_eval=False,
data_seed=None,
dataloader_drop_last=False,
dataloader_num_workers=0,
dataloader_pin_memory=True,
ddp_backend=None,
ddp_broadcast_buffers=None,
ddp_bucket_cap_mb=None,
ddp_find_unused_parameters=None,
ddp_timeout=1800,
debug=[],
deepspeed=None,
disable_tqdm=False,
dispatch_batches=None,
do_eval=False,
do_predict=False,
do_train=False,
eval_accumulation_steps=None,
eval_delay=0,
eval_steps=None,
evaluation_strategy=no,
fp16=true,
fp16_backend=auto,
fp16_full_eval=False,
fp16_opt_level=O1,
fsdp=[],
fsdp_config={'min_num_params': 0, 'xla': False, 'xla_fsdp_grad_ckpt': False},
fsdp_min_num_params=0,
fsdp_transformer_layer_cls_to_wrap=None,
full_determinism=False,
gradient_accumulation_steps=1,
gradient_checkpointing=False,
gradient_checkpointing_kwargs=None,
greater_is_better=None,
group_by_length=False,
half_precision_backend=auto,
hub_always_push=False,
hub_model_id=None,
hub_private_repo=False,
hub_strategy=every_save,
hub_token=<HUB_TOKEN>,
ignore_data_skip=False,
include_inputs_for_metrics=False,
include_tokens_per_second=False,
jit_mode_eval=False,
label_names=None,
label_smoothing_factor=0.0,
learning_rate=2e-05,
length_column_name=length,
load_best_model_at_end=False,
local_rank=0,
log_level=passive,
log_level_replica=warning,
log_on_each_node=True,
logging_dir=./output/test/runs/Apr22_00-54-50_autodl-container-63564b9725-5112def0,
logging_first_step=False,
logging_nan_inf_filter=True,
logging_steps=500,
logging_strategy=steps,
lr_scheduler_type=linear,
max_grad_norm=1.0,
max_steps=-1,
metric_for_best_model=None,
mp_parameters=,
neftune_noise_alpha=None,
no_cuda=False,
num_train_epochs=3,
optim=adamw_torch,
optim_args=None,
output_dir=./output/test/,
overwrite_output_dir=true,
past_index=-1,
per_device_eval_batch_size=8,
per_device_train_batch_size=32,
prediction_loss_only=False,
push_to_hub=False,
push_to_hub_model_id=None,
push_to_hub_organization=None,
push_to_hub_token=<PUSH_TO_HUB_TOKEN>,
ray_scope=last,
remove_unused_columns=True,
report_to=['tensorboard'],
resume_from_checkpoint=None,
run_name=./output/test/,
save_on_each_node=False,
save_safetensors=True,
save_steps=500,
save_strategy=steps,
save_total_limit=None,
seed=42,
skip_memory_metrics=True,
split_batches=False,
tf32=None,
torch_compile=False,
torch_compile_backend=None,
torch_compile_mode=None,
torchdynamo=None,
tpu_metrics_debug=False,
tpu_num_cores=None,
use_cpu=False,
use_ipex=False,
use_legacy_prediction_loop=False,
use_mps_device=False,
warmup_ratio=0.0,
warmup_steps=0,
weight_decay=0.0,
)
-->device cuda:0
-->is_available True
NVIDIA GeForce RTX 4090
-->current_device:  0
-->n_gpu 3
04/22/2024 00:54:50 - WARNING - __main__ - Process rank: 0, device: cuda:0, n_gpu: 3distributed training: True, 16-bits training: true
-->label_list [1, 0]
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:03<00:06,  3.02s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:05<00:02,  2.98s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:08<00:00,  2.55s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:08<00:00,  2.67s/it]
-->device cuda:0
-->model.device cuda:0
-->raw_datasets DatasetDict({
    train: Dataset({
        features: ['Unnamed: 0', 'text', 'label'],
        num_rows: 7492
    })
    validation: Dataset({
        features: ['Unnamed: 0', 'text', 'label'],
        num_rows: 3211
    })
    test: Dataset({
        features: ['Unnamed: 0', 'text', 'label'],
        num_rows: 3211
    })
})
load_metric
end load_metric
-->model.device cuda:0
3
-->Do Custom Model
-->model LlamaForSequenceClassification(
  (model): LlamaModel(
    (embed_tokens): Embedding(32000, 4096, padding_idx=2)
    (layers): ModuleList(
      (0-31): 32 x LlamaDecoderLayer(
        (self_attn): LlamaAttention(
          (q_proj): Linear(in_features=4096, out_features=4096, bias=False)
          (k_proj): Linear(in_features=4096, out_features=4096, bias=False)
          (v_proj): Linear(in_features=4096, out_features=4096, bias=False)
          (o_proj): Linear(in_features=4096, out_features=4096, bias=False)
          (rotary_emb): LlamaRotaryEmbedding()
        )
        (mlp): LlamaMLP(
          (gate_proj): Linear(in_features=4096, out_features=11008, bias=False)
          (up_proj): Linear(in_features=4096, out_features=11008, bias=False)
          (down_proj): Linear(in_features=11008, out_features=4096, bias=False)
          (act_fn): SiLUActivation()
        )
        (input_layernorm): LlamaRMSNorm()
        (post_attention_layernorm): LlamaRMSNorm()
      )
    )
    (norm): LlamaRMSNorm()
  )
  (score): Linear(in_features=4096, out_features=2, bias=False)
)
hidden_size:4096, bottleneck_size:328
-->debias_args.do_debias
-->gamma 0.6
-->gamma 0.6
-->model AddedLayers(
  (model): Sequential(
    (0): Linear(in_features=4096, out_features=328, bias=True)
    (1): GELU(approximate='none')
    (2): Linear(in_features=328, out_features=4096, bias=True)
    (3): GELU(approximate='none')
    (4): Linear(in_features=4096, out_features=328, bias=True)
    (5): GELU(approximate='none')
    (6): Linear(in_features=328, out_features=4096, bias=True)
  )
)
-->classifier Linear(in_features=4096, out_features=2, bias=False)
-->MinValue:-2.271099895830676, MaxValue:2.2792810789854263
-->epoch 0
-->batch_size 98
-->weights tensor([2.3148, 0.6378], device='cuda:2')
-->FUR:0.0, FU:0.0, P:40
-->FUR:0.0, FU:0.0, P:26
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:4
-->None
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:13
-->FUR:0.0, FU:0.0, P:43
-->show_identity_num 7
-->z_score:-2.262918710708618, p_hat:0.00018011502106674016, n:98.0
-->bias_loss * gamma tensor(0.0018, device='cuda:2', grad_fn=<AddBackward0>) tensor(0.6000, device='cuda:2')
-->bias_loss tensor(0.0011, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.3254, acc_loss, 0.3243, bias_loss:0.0011
-->batch_size 98
-->weights tensor([1.9412, 0.6735], device='cuda:2')
-->FUR:0.3142857253551483, FU:11.0, P:35
-->FUR:0.11538461595773697, FU:3.0, P:26
-->FUR:0.5, FU:1.0, P:2
-->FUR:0.3333333432674408, FU:1.0, P:3
-->None
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.1764705926179886, FU:3.0, P:17
-->FUR:0.20454545319080353, FU:9.0, P:44
-->show_identity_num 7
-->z_score:8.39086627960205, p_hat:0.23473133146762848, n:98.0
-->bias_loss * gamma tensor(1., device='cuda:2', grad_fn=<AddBackward0>) tensor(0.6000, device='cuda:2')
-->bias_loss tensor(0.6000, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.8536, acc_loss, 0.2536, bias_loss:0.6000
-->batch_size 98
-->weights tensor([2.7273, 0.6122], device='cuda:2')
-->FUR:0.0, FU:0.0, P:33
-->FUR:0.0, FU:0.0, P:16
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:11
-->FUR:0.0, FU:0.0, P:50
-->show_identity_num 8
-->z_score:-2.2639412879943848, p_hat:0.00015760063251946121, n:98.0
-->bias_loss * gamma tensor(0.0016, device='cuda:2', grad_fn=<AddBackward0>) tensor(0.6000, device='cuda:2')
-->bias_loss tensor(0.0009, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 1.0626, acc_loss, 1.0616, bias_loss:0.0009
-->batch_size 98
-->weights tensor([2.4600, 0.6276], device='cuda:2')
-->FUR:0.0, FU:0.0, P:35
-->FUR:0.0, FU:0.0, P:32
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:11
-->FUR:0.0, FU:0.0, P:41
-->show_identity_num 8
-->z_score:-2.2639412879943848, p_hat:0.00015760063251946121, n:98.0
-->bias_loss * gamma tensor(0.0016, device='cuda:2', grad_fn=<AddBackward0>) tensor(0.6000, device='cuda:2')
-->bias_loss tensor(0.0009, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.0143, acc_loss, 0.0134, bias_loss:0.0009
-->batch_size 98
-->weights tensor([1.9848, 0.6684], device='cuda:2')
-->FUR:0.11999999731779099, FU:3.0, P:25
-->FUR:0.3125, FU:5.0, P:16
-->FUR:0.6666666865348816, FU:2.0, P:3
-->FUR:0.5, FU:1.0, P:2
-->FUR:0.5, FU:1.0, P:2
-->FUR:0.5, FU:4.0, P:8
-->FUR:0.4545454680919647, FU:5.0, P:11
-->FUR:0.2291666716337204, FU:11.0, P:48
-->show_identity_num 8
-->z_score:16.36008071899414, p_hat:0.4101797044277191, n:98.0
-->bias_loss * gamma tensor(1., device='cuda:2', grad_fn=<AddBackward0>) tensor(0.6000, device='cuda:2')
-->bias_loss tensor(0.6000, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 1.0525, acc_loss, 0.4525, bias_loss:0.6000
-->batch_size 98
-->weights tensor([2.7273, 0.6122], device='cuda:2')
-->FUR:0.0, FU:0.0, P:43
-->FUR:0.0, FU:0.0, P:24
-->None
-->FUR:0.0, FU:0.0, P:3
-->None
-->FUR:0.20000000298023224, FU:1.0, P:5
-->FUR:0.0, FU:0.0, P:15
-->FUR:0.04545454680919647, FU:2.0, P:44
-->show_identity_num 6
-->z_score:-0.4102000594139099, p_hat:0.040969133377075195, n:98.0
-->bias_loss * gamma tensor(0.4090, device='cuda:2', grad_fn=<AddBackward0>) tensor(0.6000, device='cuda:2')
-->bias_loss tensor(0.2454, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.4102, acc_loss, 0.1648, bias_loss:0.2454
-->batch_size 98
-->weights tensor([2.0312, 0.6633], device='cuda:2')
-->FUR:0.022727273404598236, FU:1.0, P:44
-->FUR:0.0, FU:0.0, P:25
-->FUR:0.0, FU:0.0, P:2
-->None
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:6
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:39
-->show_identity_num 7
-->z_score:-2.1177821159362793, p_hat:0.00337540777400136, n:98.0
-->bias_loss * gamma tensor(0.0337, device='cuda:2', grad_fn=<AddBackward0>) tensor(0.6000, device='cuda:2')
-->bias_loss tensor(0.0202, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.0303, acc_loss, 0.0101, bias_loss:0.0202
-->batch_size 98
-->weights tensor([2.2500, 0.6429], device='cuda:2')
-->FUR:0.0, FU:0.0, P:40
-->FUR:0.0, FU:0.0, P:22
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:6
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.0, FU:0.0, P:44
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss * gamma tensor(0.0018, device='cuda:2', grad_fn=<AddBackward0>) tensor(0.6000, device='cuda:2')
-->bias_loss tensor(0.0011, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.0079, acc_loss, 0.0068, bias_loss:0.0011
-->batch_size 98
-->weights tensor([3.5625, 0.5816], device='cuda:2')
-->FUR:0.0, FU:0.0, P:44
-->FUR:0.03125, FU:1.0, P:32
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.3333333432674408, FU:1.0, P:3
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:8
-->FUR:0.0, FU:0.0, P:14
-->FUR:0.0, FU:0.0, P:29
-->show_identity_num 8
-->z_score:-0.19699612259864807, p_hat:0.045662980526685715, n:98.0
-->bias_loss * gamma tensor(0.4558, device='cuda:2', grad_fn=<AddBackward0>) tensor(0.6000, device='cuda:2')
-->bias_loss tensor(0.2735, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.3529, acc_loss, 0.0794, bias_loss:0.2735
-->batch_size 98
-->weights tensor([2.6304, 0.6173], device='cuda:2')
-->FUR:0.0, FU:0.0, P:35
-->FUR:0.0, FU:0.0, P:22
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:9
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.0, FU:0.0, P:46
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss * gamma tensor(0.0018, device='cuda:2', grad_fn=<AddBackward0>) tensor(0.6000, device='cuda:2')
-->bias_loss tensor(0.0011, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.0035, acc_loss, 0.0025, bias_loss:0.0011
-->batch_size 98
-->weights tensor([1.9412, 0.6735], device='cuda:2')
-->FUR:0.0, FU:0.0, P:36
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:25
-->FUR:0.0, FU:0.0, P:41
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss * gamma tensor(0.0018, device='cuda:2', grad_fn=<AddBackward0>) tensor(0.6000, device='cuda:2')
-->bias_loss tensor(0.0011, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.0042, acc_loss, 0.0031, bias_loss:0.0011
-->batch_size 98
-->weights tensor([1.9412, 0.6735], device='cuda:2')
-->FUR:0.0, FU:0.0, P:37
-->FUR:0.0, FU:0.0, P:23
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:21
-->FUR:0.019607843831181526, FU:1.0, P:51
-->show_identity_num 8
-->z_score:-2.1556808948516846, p_hat:0.0025410379748791456, n:98.0
-->bias_loss * gamma tensor(0.0254, device='cuda:2', grad_fn=<AddBackward0>) tensor(0.6000, device='cuda:2')
-->bias_loss tensor(0.0152, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.1012, acc_loss, 0.0860, bias_loss:0.0152
-->batch_size 98
-->weights tensor([2.0806, 0.6582], device='cuda:2')
-->FUR:0.0, FU:0.0, P:30
-->FUR:0.0, FU:0.0, P:26
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:5
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.02500000037252903, FU:1.0, P:40
-->show_identity_num 8
-->z_score:-2.1240429878234863, p_hat:0.0032375718001276255, n:98.0
-->bias_loss * gamma tensor(0.0323, device='cuda:2', grad_fn=<AddBackward0>) tensor(0.6000, device='cuda:2')
-->bias_loss tensor(0.0194, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.0357, acc_loss, 0.0163, bias_loss:0.0194
-->batch_size 98
-->weights tensor([2.0312, 0.6633], device='cuda:2')
-->FUR:0.0, FU:0.0, P:34
-->FUR:0.0, FU:0.0, P:23
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.020408162847161293, FU:1.0, P:49
-->show_identity_num 8
-->z_score:-2.1501142978668213, p_hat:0.0026635921094566584, n:98.0
-->bias_loss * gamma tensor(0.0266, device='cuda:2', grad_fn=<AddBackward0>) tensor(0.6000, device='cuda:2')
-->bias_loss tensor(0.0160, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.0417, acc_loss, 0.0258, bias_loss:0.0160
-->batch_size 98
-->weights tensor([2.3846, 0.6327], device='cuda:2')
-->FUR:0.09375, FU:3.0, P:32
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.3333333432674408, FU:1.0, P:3
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:12
-->FUR:0.0, FU:0.0, P:18
-->FUR:0.020408162847161293, FU:1.0, P:49
-->show_identity_num 8
-->z_score:0.27169036865234375, p_hat:0.05598147213459015, n:98.0
-->bias_loss * gamma tensor(0.5588, device='cuda:2', grad_fn=<AddBackward0>) tensor(0.6000, device='cuda:2')
-->bias_loss tensor(0.3353, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.4070, acc_loss, 0.0717, bias_loss:0.3353
-->batch_size 98
-->weights tensor([3.4000, 0.5862], device='cuda:2')
-->FUR:0.0, FU:0.0, P:38
-->FUR:0.0, FU:0.0, P:19
-->None
-->None
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:8
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:36
-->show_identity_num 6
-->z_score:-2.2642822265625, p_hat:0.00015009584603831172, n:98.0
-->bias_loss * gamma tensor(0.0015, device='cuda:2', grad_fn=<AddBackward0>) tensor(0.6000, device='cuda:2')
-->bias_loss tensor(0.0009, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.0037, acc_loss, 0.0028, bias_loss:0.0009
-->after epoch 0
-->overall baseline on testing dataset
-->ACC 0.9218312052320149
-->F1 0.9567315980003449
-->FPR: 0.5194805194805194
-->FNR: 0.018046709129511677
testing dataset
-->original metric score:
-->identity male
-->length 292
-->ACC 0.886986301369863
-->F1 0.9349112426035503
-->FPR 0.5217391304347826
-->FNR 0.036585365853658534
-->positive probability:0.8938356164383562, 261/292
-->group-truth label positive probability:0.8424657534246576, 246/292
-->identity female
-->length 195
-->ACC 0.8461538461538461
-->F1 0.9044585987261147
-->FPR 0.5
-->FNR 0.04697986577181208
-->positive probability:0.8461538461538461, 165/195
-->group-truth label positive probability:0.764102564102564, 149/195
-->identity homosexual
-->length 14
-->ACC 0.9285714285714286
-->F1 0.9473684210526316
-->FPR 0.2
-->FNR 0.0
-->positive probability:0.7142857142857143, 10/14
-->group-truth label positive probability:0.6428571428571429, 9/14
-->identity christian
-->length 25
-->ACC 0.88
-->F1 0.9333333333333332
-->FPR 0.6666666666666666
-->FNR 0.045454545454545456
-->positive probability:0.92, 23/25
-->group-truth label positive probability:0.88, 22/25
-->identity muslim
-->length 13
-->ACC 0.8461538461538461
-->F1 0.888888888888889
-->FPR 0.4
-->FNR 0.0
-->positive probability:0.7692307692307693, 10/13
-->group-truth label positive probability:0.6153846153846154, 8/13
-->identity jewish
-->length 72
-->ACC 0.7361111111111112
-->F1 0.7532467532467533
-->FPR 0.4
-->FNR 0.09375
-->positive probability:0.625, 45/72
-->group-truth label positive probability:0.4444444444444444, 32/72
-->identity black
-->length 157
-->ACC 0.7898089171974523
-->F1 0.8405797101449276
-->FPR 0.421875
-->FNR 0.06451612903225806
-->positive probability:0.7261146496815286, 114/157
-->group-truth label positive probability:0.5923566878980892, 93/157
-->identity white
-->length 381
-->ACC 0.847769028871391
-->F1 0.9067524115755626
-->FPR 0.5340909090909091
-->FNR 0.03754266211604096
-->positive probability:0.863517060367454, 329/381
-->group-truth label positive probability:0.7690288713910761, 293/381
-->fpr_diff [0.0022586109542631627, 0.01948051948051943, 0.3194805194805194, 0.1471861471861472, 0.11948051948051941, 0.11948051948051941, 0.09760551948051943, 0.01461038961038963]
-->fnr_diff [0.018538656724146858, 0.028933156642300405, 0.018046709129511677, 0.02740783632503378, 0.018046709129511677, 0.07570329087048833, 0.04646941990274639, 0.019495952986529282]
-->FPR:[0.5217391304347826, 0.5, 0.2, 0.6666666666666666, 0.4, 0.4, 0.421875, 0.5340909090909091], mean FPR:0.4555464632740448, mean FPR metric:0.10494784314417463
-->FNR:[0.036585365853658534, 0.04697986577181208, 0.0, 0.045454545454545456, 0.0, 0.09375, 0.06451612903225806, 0.03754266211604096], mean FNR:0.040603571028539384, mean FNR metric:0.03158021646378355
-->group metric: 0.03158021646378355
Traceback (most recent call last):
  File "/root/autodl-tmp/mdzhang/text-classification/experiments/main_test_llama.py", line 1503, in <module>
    main()
  File "/root/autodl-tmp/mdzhang/text-classification/experiments/main_test_llama.py", line 1216, in main
    dataset = OPTIMIZATION.debias_optimize_identity_diff_gamma(tokenizer,
  File "/root/autodl-tmp/mdzhang/text-classification/public_operation/custom_model_optimization.py", line 3096, in debias_optimize_identity_diff_gamma
    test_fnr_metric.append(fnr_metric)
NameError: name 'test_fnr_metric' is not defined
/home/mdzhang/miniconda3/envs/llama/lib/python3.9/site-packages/trl/trainer/ppo_config.py:141: UserWarning: The `optimize_cuda_cache` arguement will be deprecated soon, please use `optimize_device_cache` instead.
  warnings.warn(
-->root_dir /root/autodl-tmp/mdzhang/text-classification
-->device cuda:0
-->debias_args
DebiasArguments(target='group', threshold=0.05, save_dir='models/hate_speech_white_llama/', baseline_metrics='dataset/hate_speech_white/baseline_metric_llama.jsonl', do_debias=True, do_get_baseline=False, do_get_baseline_with_editor=False, gamma=[0.6, 0.7, 0.8, 0.9, 1.0], epoch=5, batch_size=98, train_learning_rate=0.001, train_data='dataset/hate_speech_white/train.csv', test_data='dataset/hate_speech_white/test.csv', train_data_identity='dataset/hate_speech_white/train_identity.csv', test_data_identity='dataset/hate_speech_white/test_identity.csv', baseline_metric_group=0.000180115, baseline_metric_ind=0.069814164, baseline_fpr_train=0.002308568, baseline_fnr_train=0.000180115, privileged_label=1, debias_path_directory='models/hate_speech_white_llama/individual_0.05_0.0')
-->arguments:
ModelArguments(model_name_or_path='./output/hate_speech_white_llama/', config_name=None, tokenizer_name=None, cache_dir='/root/autodl-tmp/mdzhang/tmp', use_fast_tokenizer=True, model_revision='main', use_auth_token=False, ignore_mismatched_sizes=False)
DataTrainingArguments(task_name=None, dataset_name=None, dataset_config_name=None, max_seq_length=128, overwrite_cache=False, pad_to_max_length=True, max_train_samples=None, max_eval_samples=None, max_predict_samples=None, train_file='dataset/hate_speech_white/train.csv', validation_file='dataset/hate_speech_white/test.csv', test_file='dataset/hate_speech_white/test.csv')
TrainingArguments(
_n_gpu=3,
adafactor=False,
adam_beta1=0.9,
adam_beta2=0.999,
adam_epsilon=1e-08,
auto_find_batch_size=False,
bf16=False,
bf16_full_eval=False,
data_seed=None,
dataloader_drop_last=False,
dataloader_num_workers=0,
dataloader_pin_memory=True,
ddp_backend=None,
ddp_broadcast_buffers=None,
ddp_bucket_cap_mb=None,
ddp_find_unused_parameters=None,
ddp_timeout=1800,
debug=[],
deepspeed=None,
disable_tqdm=False,
dispatch_batches=None,
do_eval=False,
do_predict=False,
do_train=False,
eval_accumulation_steps=None,
eval_delay=0,
eval_steps=None,
evaluation_strategy=no,
fp16=true,
fp16_backend=auto,
fp16_full_eval=False,
fp16_opt_level=O1,
fsdp=[],
fsdp_config={'min_num_params': 0, 'xla': False, 'xla_fsdp_grad_ckpt': False},
fsdp_min_num_params=0,
fsdp_transformer_layer_cls_to_wrap=None,
full_determinism=False,
gradient_accumulation_steps=1,
gradient_checkpointing=False,
gradient_checkpointing_kwargs=None,
greater_is_better=None,
group_by_length=False,
half_precision_backend=auto,
hub_always_push=False,
hub_model_id=None,
hub_private_repo=False,
hub_strategy=every_save,
hub_token=<HUB_TOKEN>,
ignore_data_skip=False,
include_inputs_for_metrics=False,
include_tokens_per_second=False,
jit_mode_eval=False,
label_names=None,
label_smoothing_factor=0.0,
learning_rate=2e-05,
length_column_name=length,
load_best_model_at_end=False,
local_rank=0,
log_level=passive,
log_level_replica=warning,
log_on_each_node=True,
logging_dir=./output/test/runs/Apr22_16-45-34_autodl-container-63564b9725-5112def0,
logging_first_step=False,
logging_nan_inf_filter=True,
logging_steps=500,
logging_strategy=steps,
lr_scheduler_type=linear,
max_grad_norm=1.0,
max_steps=-1,
metric_for_best_model=None,
mp_parameters=,
neftune_noise_alpha=None,
no_cuda=False,
num_train_epochs=3,
optim=adamw_torch,
optim_args=None,
output_dir=./output/test/,
overwrite_output_dir=true,
past_index=-1,
per_device_eval_batch_size=8,
per_device_train_batch_size=32,
prediction_loss_only=False,
push_to_hub=False,
push_to_hub_model_id=None,
push_to_hub_organization=None,
push_to_hub_token=<PUSH_TO_HUB_TOKEN>,
ray_scope=last,
remove_unused_columns=True,
report_to=['tensorboard'],
resume_from_checkpoint=None,
run_name=./output/test/,
save_on_each_node=False,
save_safetensors=True,
save_steps=500,
save_strategy=steps,
save_total_limit=None,
seed=42,
skip_memory_metrics=True,
split_batches=False,
tf32=None,
torch_compile=False,
torch_compile_backend=None,
torch_compile_mode=None,
torchdynamo=None,
tpu_metrics_debug=False,
tpu_num_cores=None,
use_cpu=False,
use_ipex=False,
use_legacy_prediction_loop=False,
use_mps_device=False,
warmup_ratio=0.0,
warmup_steps=0,
weight_decay=0.0,
)
-->device cuda:0
-->is_available True
NVIDIA GeForce RTX 4090
-->current_device:  0
-->n_gpu 3
04/22/2024 16:45:34 - WARNING - __main__ - Process rank: 0, device: cuda:0, n_gpu: 3distributed training: True, 16-bits training: true
-->label_list [1, 0]
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:03<00:06,  3.13s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:06<00:03,  3.12s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:08<00:00,  2.66s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:08<00:00,  2.79s/it]
-->device cuda:0
-->model.device cuda:0
-->raw_datasets DatasetDict({
    train: Dataset({
        features: ['Unnamed: 0', 'text', 'label'],
        num_rows: 7492
    })
    validation: Dataset({
        features: ['Unnamed: 0', 'text', 'label'],
        num_rows: 3211
    })
    test: Dataset({
        features: ['Unnamed: 0', 'text', 'label'],
        num_rows: 3211
    })
})
load_metric
end load_metric
-->model.device cuda:0
3
-->Do Custom Model
-->model LlamaForSequenceClassification(
  (model): LlamaModel(
    (embed_tokens): Embedding(32000, 4096, padding_idx=2)
    (layers): ModuleList(
      (0-31): 32 x LlamaDecoderLayer(
        (self_attn): LlamaAttention(
          (q_proj): Linear(in_features=4096, out_features=4096, bias=False)
          (k_proj): Linear(in_features=4096, out_features=4096, bias=False)
          (v_proj): Linear(in_features=4096, out_features=4096, bias=False)
          (o_proj): Linear(in_features=4096, out_features=4096, bias=False)
          (rotary_emb): LlamaRotaryEmbedding()
        )
        (mlp): LlamaMLP(
          (gate_proj): Linear(in_features=4096, out_features=11008, bias=False)
          (up_proj): Linear(in_features=4096, out_features=11008, bias=False)
          (down_proj): Linear(in_features=11008, out_features=4096, bias=False)
          (act_fn): SiLUActivation()
        )
        (input_layernorm): LlamaRMSNorm()
        (post_attention_layernorm): LlamaRMSNorm()
      )
    )
    (norm): LlamaRMSNorm()
  )
  (score): Linear(in_features=4096, out_features=2, bias=False)
)
hidden_size:4096, bottleneck_size:328
-->debias_args.do_debias
-->gamma 0.6
-->gamma 0.6
-->model AddedLayers(
  (model): Sequential(
    (0): Linear(in_features=4096, out_features=328, bias=True)
    (1): GELU(approximate='none')
    (2): Linear(in_features=328, out_features=4096, bias=True)
    (3): GELU(approximate='none')
    (4): Linear(in_features=4096, out_features=328, bias=True)
    (5): GELU(approximate='none')
    (6): Linear(in_features=328, out_features=4096, bias=True)
  )
)
-->classifier Linear(in_features=4096, out_features=2, bias=False)
-->MinValue:-2.271099895830676, MaxValue:2.2792810789854263
-->epoch 0
-->batch_size 98
-->weights tensor([2.3148, 0.6378], device='cuda:2')
-->FUR:0.0, FU:0.0, P:40
-->FUR:0.0, FU:0.0, P:26
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:4
-->None
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:13
-->FUR:0.0, FU:0.0, P:43
-->show_identity_num 7
-->z_score:-2.262918710708618, p_hat:0.00018011502106674016, n:98.0
-->bias_loss tensor(0.0011, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.3254, acc_loss, 0.3243, bias_loss:0.0011
-->batch_size 98
-->weights tensor([1.9412, 0.6735], device='cuda:2')
-->FUR:0.3142857253551483, FU:11.0, P:35
-->FUR:0.11328629404306412, FU:2.945443630218506, P:26
-->FUR:0.5, FU:1.0, P:2
-->FUR:0.3333333432674408, FU:1.0, P:3
-->None
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.1764705926179886, FU:3.0, P:17
-->FUR:0.20466011762619019, FU:9.005044937133789, P:44
-->show_identity_num 7
-->z_score:8.377994537353516, p_hat:0.23444795608520508, n:98.0
-->bias_loss tensor(0.6000, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.8536, acc_loss, 0.2536, bias_loss:0.6000
-->batch_size 98
-->weights tensor([2.7273, 0.6122], device='cuda:2')
-->FUR:0.0, FU:0.0, P:33
-->FUR:0.0, FU:0.0, P:16
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:11
-->FUR:0.0, FU:0.0, P:50
-->show_identity_num 8
-->z_score:-2.2639412879943848, p_hat:0.00015760063251946121, n:98.0
-->bias_loss tensor(0.0009, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 1.0626, acc_loss, 1.0616, bias_loss:0.0009
-->batch_size 98
-->weights tensor([2.4600, 0.6276], device='cuda:2')
-->FUR:0.0, FU:0.0, P:35
-->FUR:4.563480615615845e-06, FU:0.00014603137969970703, P:32
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:11
-->FUR:0.0, FU:0.0, P:41
-->show_identity_num 8
-->z_score:-2.263967514038086, p_hat:0.00015703019744250923, n:98.0
-->bias_loss tensor(0.0009, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.0143, acc_loss, 0.0134, bias_loss:0.0009
-->batch_size 98
-->weights tensor([1.9848, 0.6684], device='cuda:2')
-->FUR:0.11875853687524796, FU:2.968963384628296, P:25
-->FUR:0.3111749589443207, FU:4.978799343109131, P:16
-->FUR:0.6666666865348816, FU:2.0, P:3
-->FUR:0.5, FU:1.0, P:2
-->FUR:0.48449280858039856, FU:0.9689856171607971, P:2
-->FUR:0.5, FU:4.0, P:8
-->FUR:0.45177242159843445, FU:4.969496726989746, P:11
-->FUR:0.22872698307037354, FU:10.97889518737793, P:48
-->show_identity_num 8
-->z_score:16.23922348022461, p_hat:0.4075189232826233, n:98.0
-->bias_loss tensor(0.6000, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 1.0528, acc_loss, 0.4528, bias_loss:0.6000
-->batch_size 98
-->weights tensor([2.7273, 0.6122], device='cuda:2')
-->FUR:0.0, FU:0.0, P:43
-->FUR:0.0, FU:0.0, P:24
-->None
-->FUR:0.0, FU:0.0, P:3
-->None
-->FUR:0.19994711875915527, FU:0.9997355937957764, P:5
-->FUR:0.0, FU:0.0, P:15
-->FUR:0.04545454680919647, FU:2.0, P:44
-->show_identity_num 6
-->z_score:-0.4106003940105438, p_hat:0.040960319340229034, n:98.0
-->bias_loss tensor(0.2453, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.4102, acc_loss, 0.1648, bias_loss:0.2453
-->batch_size 98
-->weights tensor([2.0312, 0.6633], device='cuda:2')
-->FUR:0.022727273404598236, FU:1.0, P:44
-->FUR:0.0, FU:0.0, P:25
-->FUR:0.0, FU:0.0, P:2
-->None
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:6
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:39
-->show_identity_num 7
-->z_score:-2.1177821159362793, p_hat:0.00337540777400136, n:98.0
-->bias_loss tensor(0.0202, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.0323, acc_loss, 0.0120, bias_loss:0.0202
-->batch_size 98
-->weights tensor([2.2500, 0.6429], device='cuda:2')
-->FUR:0.0, FU:0.0, P:40
-->FUR:0.0, FU:0.0, P:22
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:6
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.0, FU:0.0, P:44
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss tensor(0.0011, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.0100, acc_loss, 0.0089, bias_loss:0.0011
-->batch_size 98
-->weights tensor([3.5625, 0.5816], device='cuda:2')
-->FUR:0.0, FU:0.0, P:44
-->FUR:0.03125, FU:1.0, P:32
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.3333333432674408, FU:1.0, P:3
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:8
-->FUR:0.0, FU:0.0, P:14
-->FUR:0.0, FU:0.0, P:29
-->show_identity_num 8
-->z_score:-0.19699612259864807, p_hat:0.045662980526685715, n:98.0
-->bias_loss tensor(0.2735, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.3474, acc_loss, 0.0740, bias_loss:0.2735
-->batch_size 98
-->weights tensor([2.6304, 0.6173], device='cuda:2')
-->FUR:0.0, FU:0.0, P:35
-->FUR:0.0, FU:0.0, P:22
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:9
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.0, FU:0.0, P:46
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss tensor(0.0011, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.0042, acc_loss, 0.0031, bias_loss:0.0011
-->batch_size 98
-->weights tensor([1.9412, 0.6735], device='cuda:2')
-->FUR:0.0, FU:0.0, P:36
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:25
-->FUR:0.0, FU:0.0, P:41
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss tensor(0.0011, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.0041, acc_loss, 0.0030, bias_loss:0.0011
-->batch_size 98
-->weights tensor([1.9412, 0.6735], device='cuda:2')
-->FUR:0.0, FU:0.0, P:37
-->FUR:0.0, FU:0.0, P:23
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:21
-->FUR:0.019607843831181526, FU:1.0, P:51
-->show_identity_num 8
-->z_score:-2.1556808948516846, p_hat:0.0025410379748791456, n:98.0
-->bias_loss tensor(0.0152, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.1099, acc_loss, 0.0947, bias_loss:0.0152
-->batch_size 98
-->weights tensor([2.0806, 0.6582], device='cuda:2')
-->FUR:0.0, FU:0.0, P:30
-->FUR:0.0, FU:0.0, P:26
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:5
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:40
-->show_identity_num 8
-->z_score:-2.2639412879943848, p_hat:0.00015760063251946121, n:98.0
-->bias_loss tensor(0.0009, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.0086, acc_loss, 0.0077, bias_loss:0.0009
-->batch_size 98
-->weights tensor([2.0312, 0.6633], device='cuda:2')
-->FUR:0.0, FU:0.0, P:34
-->FUR:0.0, FU:0.0, P:23
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.020408162847161293, FU:1.0, P:49
-->show_identity_num 8
-->z_score:-2.1501142978668213, p_hat:0.0026635921094566584, n:98.0
-->bias_loss tensor(0.0160, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.0423, acc_loss, 0.0264, bias_loss:0.0160
-->batch_size 98
-->weights tensor([2.3846, 0.6327], device='cuda:2')
-->FUR:0.09375, FU:3.0, P:32
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.3333333432674408, FU:1.0, P:3
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:12
-->FUR:0.0, FU:0.0, P:18
-->FUR:0.020408162847161293, FU:1.0, P:49
-->show_identity_num 8
-->z_score:0.27169036865234375, p_hat:0.05598147213459015, n:98.0
-->bias_loss tensor(0.3353, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.4172, acc_loss, 0.0819, bias_loss:0.3353
-->batch_size 98
-->weights tensor([3.4000, 0.5862], device='cuda:2')
-->FUR:0.0, FU:0.0, P:38
-->FUR:0.0, FU:0.0, P:19
-->None
-->None
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:8
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:36
-->show_identity_num 6
-->z_score:-2.2642822265625, p_hat:0.00015009584603831172, n:98.0
-->bias_loss tensor(0.0009, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.0033, acc_loss, 0.0024, bias_loss:0.0009
-->after epoch 0
-->overall baseline on testing dataset
-->ACC 0.9255683587667394
-->F1 0.9584853222164322
-->FPR: 0.44675324675324674
-->FNR: 0.023708421797593773
testing dataset
-->original metric score:
-->identity male
-->length 292
-->ACC 0.910958904109589
-->F1 0.9477911646586347
-->FPR 0.34782608695652173
-->FNR 0.04065040650406504
-->positive probability:0.863013698630137, 252/292
-->group-truth label positive probability:0.8424657534246576, 246/292
-->identity female
-->length 195
-->ACC 0.8564102564102564
-->F1 0.9078947368421052
-->FPR 0.3695652173913043
-->FNR 0.0738255033557047
-->positive probability:0.7948717948717948, 155/195
-->group-truth label positive probability:0.764102564102564, 149/195
-->identity homosexual
-->length 14
-->ACC 0.9285714285714286
-->F1 0.9473684210526316
-->FPR 0.2
-->FNR 0.0
-->positive probability:0.7142857142857143, 10/14
-->group-truth label positive probability:0.6428571428571429, 9/14
-->identity christian
-->length 25
-->ACC 0.88
-->F1 0.9333333333333332
-->FPR 0.6666666666666666
-->FNR 0.045454545454545456
-->positive probability:0.92, 23/25
-->group-truth label positive probability:0.88, 22/25
-->identity muslim
-->length 13
-->ACC 0.8461538461538461
-->F1 0.888888888888889
-->FPR 0.4
-->FNR 0.0
-->positive probability:0.7692307692307693, 10/13
-->group-truth label positive probability:0.6153846153846154, 8/13
-->identity jewish
-->length 72
-->ACC 0.75
-->F1 0.7567567567567567
-->FPR 0.35
-->FNR 0.125
-->positive probability:0.5833333333333334, 42/72
-->group-truth label positive probability:0.4444444444444444, 32/72
-->identity black
-->length 157
-->ACC 0.802547770700637
-->F1 0.8442211055276382
-->FPR 0.34375
-->FNR 0.0967741935483871
-->positive probability:0.6751592356687898, 106/157
-->group-truth label positive probability:0.5923566878980892, 93/157
-->identity white
-->length 381
-->ACC 0.868766404199475
-->F1 0.9183006535947713
-->FPR 0.4318181818181818
-->FNR 0.040955631399317405
-->positive probability:0.8372703412073491, 319/381
-->group-truth label positive probability:0.7690288713910761, 293/381
-->fpr_diff [0.098927159796725, 0.07718802936194241, 0.24675324675324672, 0.2199134199134199, 0.04675324675324671, 0.09675324675324676, 0.10300324675324674, 0.014935064935064912]
-->fnr_diff [0.016941984706471267, 0.050117081558110926, 0.023708421797593773, 0.021746123656951683, 0.023708421797593773, 0.10129157820240622, 0.07306577175079332, 0.017247209601723632]
-->FPR:[0.34782608695652173, 0.3695652173913043, 0.2, 0.6666666666666666, 0.4, 0.35, 0.34375, 0.4318181818181818], mean FPR:0.38870326910408437, mean FPR metric:0.11302833262751738
-->FNR:[0.04065040650406504, 0.0738255033557047, 0.0, 0.045454545454545456, 0.0, 0.125, 0.0967741935483871, 0.040955631399317405], mean FNR:0.05283253503275246, mean FNR metric:0.04097832413395557
-->group metric: 0.04097832413395557
-->epoch 1
-->batch_size 98
-->weights tensor([2.3148, 0.6378], device='cuda:2')
-->FUR:0.0, FU:0.0, P:40
-->FUR:0.0, FU:0.0, P:26
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:4
-->None
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:13
-->FUR:0.0, FU:0.0, P:43
-->show_identity_num 7
-->z_score:-2.262918710708618, p_hat:0.00018011502106674016, n:98.0
-->bias_loss tensor(0.0011, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [2/5], Loss: 0.0019, acc_loss, 0.0008, bias_loss:0.0011
-->batch_size 98
-->weights tensor([1.9412, 0.6735], device='cuda:2')
-->FUR:0.0, FU:0.0, P:35
-->FUR:0.03846153989434242, FU:1.0, P:26
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:3
-->None
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.0, FU:0.0, P:44
-->show_identity_num 7
-->z_score:-2.0156848430633545, p_hat:0.005623158998787403, n:98.0
-->bias_loss tensor(0.0337, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [2/5], Loss: 0.0775, acc_loss, 0.0439, bias_loss:0.0337
-->batch_size 98
-->weights tensor([2.7273, 0.6122], device='cuda:2')
-->FUR:0.0, FU:0.0, P:33
-->FUR:0.0, FU:0.0, P:16
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:11
-->FUR:0.0, FU:0.0, P:50
-->show_identity_num 8
-->z_score:-2.2639412879943848, p_hat:0.00015760063251946121, n:98.0
-->bias_loss tensor(0.0009, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [2/5], Loss: 0.0018, acc_loss, 0.0009, bias_loss:0.0009
-->batch_size 98
-->weights tensor([2.4600, 0.6276], device='cuda:2')
-->FUR:0.02857142873108387, FU:1.0, P:35
-->FUR:0.03125, FU:1.0, P:32
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:11
-->FUR:0.0, FU:0.0, P:41
-->show_identity_num 8
-->z_score:-1.9283808469772339, p_hat:0.007545221131294966, n:98.0
-->bias_loss tensor(0.0452, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [2/5], Loss: 0.0910, acc_loss, 0.0459, bias_loss:0.0452
-->batch_size 98
-->weights tensor([1.9848, 0.6684], device='cuda:2')
-->FUR:0.0, FU:0.0, P:25
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:8
-->FUR:0.0, FU:0.0, P:11
-->FUR:0.0, FU:0.0, P:48
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss tensor(0.0011, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [2/5], Loss: 0.0279, acc_loss, 0.0269, bias_loss:0.0011
-->batch_size 98
-->weights tensor([2.7273, 0.6122], device='cuda:2')
-->FUR:0.0, FU:0.0, P:43
-->FUR:0.0, FU:0.0, P:24
-->None
-->FUR:0.0, FU:0.0, P:3
-->None
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:15
-->FUR:0.0, FU:0.0, P:44
-->show_identity_num 6
-->z_score:-2.262918710708618, p_hat:0.00018011502106674016, n:98.0
-->bias_loss tensor(0.0011, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [2/5], Loss: 0.2311, acc_loss, 0.2300, bias_loss:0.0011
-->batch_size 98
-->weights tensor([2.0312, 0.6633], device='cuda:2')
-->FUR:0.0, FU:0.0, P:44
-->FUR:0.0, FU:0.0, P:25
-->FUR:0.0, FU:0.0, P:2
-->None
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:6
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:39
-->show_identity_num 7
-->z_score:-2.262918710708618, p_hat:0.00018011502106674016, n:98.0
-->bias_loss tensor(0.0011, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [2/5], Loss: 0.0013, acc_loss, 0.0002, bias_loss:0.0011
-->batch_size 98
-->weights tensor([2.2500, 0.6429], device='cuda:2')
-->FUR:0.0, FU:0.0, P:40
-->FUR:0.0, FU:0.0, P:22
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:6
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.0, FU:0.0, P:44
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss tensor(0.0011, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [2/5], Loss: 0.0466, acc_loss, 0.0455, bias_loss:0.0011
-->batch_size 98
-->weights tensor([3.5625, 0.5816], device='cuda:2')
-->FUR:0.0, FU:0.0, P:44
-->FUR:0.03125, FU:1.0, P:32
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.3333333432674408, FU:1.0, P:3
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:8
-->FUR:0.0714285746216774, FU:1.0, P:14
-->FUR:0.0, FU:0.0, P:29
-->show_identity_num 8
-->z_score:0.206511989235878, p_hat:0.05454652011394501, n:98.0
-->bias_loss tensor(0.3267, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [2/5], Loss: 0.5538, acc_loss, 0.2271, bias_loss:0.3267
-->batch_size 98
-->weights tensor([2.6304, 0.6173], device='cuda:2')
-->FUR:0.05714285746216774, FU:2.0, P:35
-->FUR:0.04545454680919647, FU:1.0, P:22
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:9
-->FUR:0.11764705926179886, FU:2.0, P:17
-->FUR:0.0, FU:0.0, P:46
-->show_identity_num 8
-->z_score:-1.018561601638794, p_hat:0.02757558785378933, n:98.0
-->bias_loss tensor(0.1652, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [2/5], Loss: 0.3002, acc_loss, 0.1350, bias_loss:0.1652
-->batch_size 98
-->weights tensor([1.9412, 0.6735], device='cuda:2')
-->FUR:0.028810987249016762, FU:1.0371955633163452, P:36
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:25
-->FUR:0.04878048598766327, FU:2.0, P:41
-->show_identity_num 8
-->z_score:-1.826464295387268, p_hat:0.009788991883397102, n:98.0
-->bias_loss tensor(0.0586, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [2/5], Loss: 0.1771, acc_loss, 0.1184, bias_loss:0.0586
-->batch_size 98
-->weights tensor([1.9412, 0.6735], device='cuda:2')
-->FUR:0.0, FU:0.0, P:37
-->FUR:0.0, FU:0.0, P:23
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:21
-->FUR:0.019607843831181526, FU:1.0, P:51
-->show_identity_num 8
-->z_score:-2.1556808948516846, p_hat:0.0025410379748791456, n:98.0
-->bias_loss tensor(0.0152, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [2/5], Loss: 0.0709, acc_loss, 0.0557, bias_loss:0.0152
-->batch_size 98
-->weights tensor([2.0806, 0.6582], device='cuda:2')
-->FUR:0.0, FU:0.0, P:30
-->FUR:0.0, FU:0.0, P:26
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:5
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.02500000037252903, FU:1.0, P:40
-->show_identity_num 8
-->z_score:-2.1240429878234863, p_hat:0.0032375718001276255, n:98.0
-->bias_loss tensor(0.0194, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [2/5], Loss: 0.0311, acc_loss, 0.0117, bias_loss:0.0194
-->batch_size 98
-->weights tensor([2.0312, 0.6633], device='cuda:2')
-->FUR:0.0, FU:0.0, P:34
-->FUR:0.0, FU:0.0, P:23
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.020408162847161293, FU:1.0, P:49
-->show_identity_num 8
-->z_score:-2.1501142978668213, p_hat:0.0026635921094566584, n:98.0
-->bias_loss tensor(0.0160, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [2/5], Loss: 0.0474, acc_loss, 0.0314, bias_loss:0.0160
-->batch_size 98
-->weights tensor([2.3846, 0.6327], device='cuda:2')
-->FUR:0.0, FU:0.0, P:32
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:12
-->FUR:0.0, FU:0.0, P:18
-->FUR:0.0, FU:0.0, P:49
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss tensor(0.0011, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [2/5], Loss: 0.0022, acc_loss, 0.0011, bias_loss:0.0011
-->batch_size 98
-->weights tensor([3.4000, 0.5862], device='cuda:2')
-->FUR:0.0, FU:0.0, P:38
-->FUR:0.0, FU:0.0, P:19
-->None
-->None
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:8
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:36
-->show_identity_num 6
-->z_score:-2.2642822265625, p_hat:0.00015009584603831172, n:98.0
-->bias_loss tensor(0.0009, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [2/5], Loss: 0.0011, acc_loss, 0.0002, bias_loss:0.0009
-->after epoch 1
-->overall baseline on testing dataset
-->ACC 0.9252569293055123
-->F1 0.9586349534643227
-->FPR: 0.5064935064935064
-->FNR: 0.01592356687898089
testing dataset
-->original metric score:
-->identity male
-->length 292
-->ACC 0.9041095890410958
-->F1 0.9446640316205533
-->FPR 0.45652173913043476
-->FNR 0.028455284552845527
-->positive probability:0.8904109589041096, 260/292
-->group-truth label positive probability:0.8424657534246576, 246/292
-->identity female
-->length 195
-->ACC 0.8615384615384616
-->F1 0.9137380191693291
-->FPR 0.45652173913043476
-->FNR 0.040268456375838924
-->positive probability:0.841025641025641, 164/195
-->group-truth label positive probability:0.764102564102564, 149/195
-->identity homosexual
-->length 14
-->ACC 0.9285714285714286
-->F1 0.9473684210526316
-->FPR 0.2
-->FNR 0.0
-->positive probability:0.7142857142857143, 10/14
-->group-truth label positive probability:0.6428571428571429, 9/14
-->identity christian
-->length 25
-->ACC 0.88
-->F1 0.9333333333333332
-->FPR 0.6666666666666666
-->FNR 0.045454545454545456
-->positive probability:0.92, 23/25
-->group-truth label positive probability:0.88, 22/25
-->identity muslim
-->length 13
-->ACC 0.8461538461538461
-->F1 0.888888888888889
-->FPR 0.4
-->FNR 0.0
-->positive probability:0.7692307692307693, 10/13
-->group-truth label positive probability:0.6153846153846154, 8/13
-->identity jewish
-->length 72
-->ACC 0.7361111111111112
-->F1 0.7532467532467533
-->FPR 0.4
-->FNR 0.09375
-->positive probability:0.625, 45/72
-->group-truth label positive probability:0.4444444444444444, 32/72
-->identity black
-->length 157
-->ACC 0.7961783439490446
-->F1 0.8446601941747574
-->FPR 0.40625
-->FNR 0.06451612903225806
-->positive probability:0.7197452229299363, 113/157
-->group-truth label positive probability:0.5923566878980892, 93/157
-->identity white
-->length 381
-->ACC 0.8556430446194225
-->F1 0.9111470113085622
-->FPR 0.5
-->FNR 0.03754266211604096
-->positive probability:0.8556430446194225, 326/381
-->group-truth label positive probability:0.7690288713910761, 293/381
-->fpr_diff [0.049971767363071684, 0.049971767363071684, 0.30649350649350643, 0.1601731601731602, 0.10649350649350642, 0.10649350649350642, 0.10024350649350644, 0.00649350649350644]
-->fnr_diff [0.012531717673864635, 0.024344889496858032, 0.01592356687898089, 0.029530978575564564, 0.01592356687898089, 0.07782643312101911, 0.048592562153277175, 0.021619095237060067]
-->FPR:[0.45652173913043476, 0.45652173913043476, 0.2, 0.6666666666666666, 0.4, 0.4, 0.40625, 0.5], mean FPR:0.435745018115942, mean FPR metric:0.11079177842085447
-->FNR:[0.028455284552845527, 0.040268456375838924, 0.0, 0.045454545454545456, 0.0, 0.09375, 0.06451612903225806, 0.03754266211604096], mean FNR:0.038748384691441116, mean FNR metric:0.030786601251950672
-->group metric: 0.030786601251950672
-->epoch 2
-->batch_size 98
-->weights tensor([2.3148, 0.6378], device='cuda:2')
-->FUR:0.0, FU:0.0, P:40
-->FUR:0.0, FU:0.0, P:26
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:4
-->None
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:13
-->FUR:0.0, FU:0.0, P:43
-->show_identity_num 7
-->z_score:-2.262918710708618, p_hat:0.00018011502106674016, n:98.0
-->bias_loss tensor(0.0011, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [3/5], Loss: 0.0012, acc_loss, 0.0001, bias_loss:0.0011
-->batch_size 98
-->weights tensor([1.9412, 0.6735], device='cuda:2')
-->FUR:0.0, FU:0.0, P:35
-->FUR:0.0, FU:0.0, P:26
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:3
-->None
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.0, FU:0.0, P:44
-->show_identity_num 7
-->z_score:-2.262918710708618, p_hat:0.00018011502106674016, n:98.0
-->bias_loss tensor(0.0011, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [3/5], Loss: 0.1347, acc_loss, 0.1336, bias_loss:0.0011
-->batch_size 98
-->weights tensor([2.7273, 0.6122], device='cuda:2')
-->FUR:0.0, FU:0.0, P:33
-->FUR:0.0, FU:0.0, P:16
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:11
-->FUR:0.0, FU:0.0, P:50
-->show_identity_num 8
-->z_score:-2.2639412879943848, p_hat:0.00015760063251946121, n:98.0
-->bias_loss tensor(0.0009, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [3/5], Loss: 0.8621, acc_loss, 0.8611, bias_loss:0.0009
-->batch_size 98
-->weights tensor([2.4600, 0.6276], device='cuda:2')
-->FUR:0.0, FU:0.0, P:35
-->FUR:0.03125, FU:1.0, P:32
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:11
-->FUR:0.0, FU:0.0, P:41
-->show_identity_num 8
-->z_score:-2.088557243347168, p_hat:0.004018821287900209, n:98.0
-->bias_loss tensor(0.0241, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [3/5], Loss: 0.0344, acc_loss, 0.0103, bias_loss:0.0241
-->batch_size 98
-->weights tensor([1.9848, 0.6684], device='cuda:2')
-->FUR:0.0, FU:0.0, P:25
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:8
-->FUR:0.0, FU:0.0, P:11
-->FUR:0.0, FU:0.0, P:48
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss tensor(0.0011, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [3/5], Loss: 0.0011, acc_loss, 0.0000, bias_loss:0.0011
-->batch_size 98
-->weights tensor([2.7273, 0.6122], device='cuda:2')
-->FUR:0.0, FU:0.0, P:43
-->FUR:0.0, FU:0.0, P:24
-->None
-->FUR:0.0, FU:0.0, P:3
-->None
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:15
-->FUR:0.0, FU:0.0, P:44
-->show_identity_num 6
-->z_score:-2.262918710708618, p_hat:0.00018011502106674016, n:98.0
-->bias_loss tensor(0.0011, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [3/5], Loss: 0.0167, acc_loss, 0.0156, bias_loss:0.0011
-->batch_size 98
-->weights tensor([2.0312, 0.6633], device='cuda:2')
-->FUR:0.0, FU:0.0, P:44
-->FUR:0.0, FU:0.0, P:25
-->FUR:0.0, FU:0.0, P:2
-->None
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:6
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:39
-->show_identity_num 7
-->z_score:-2.262918710708618, p_hat:0.00018011502106674016, n:98.0
-->bias_loss tensor(0.0011, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [3/5], Loss: 0.0011, acc_loss, 0.0000, bias_loss:0.0011
-->batch_size 98
-->weights tensor([2.2500, 0.6429], device='cuda:2')
-->FUR:0.025000054389238358, FU:1.000002145767212, P:40
-->FUR:0.0, FU:0.0, P:22
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:6
-->FUR:0.0, FU:0.0, P:17
-->FUR:4.876743631143654e-08, FU:2.1457672119140625e-06, P:44
-->show_identity_num 8
-->z_score:-2.1230204105377197, p_hat:0.0032600874546915293, n:98.0
-->bias_loss tensor(0.0195, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [3/5], Loss: 0.0558, acc_loss, 0.0363, bias_loss:0.0195
-->batch_size 98
-->weights tensor([3.5625, 0.5816], device='cuda:2')
-->FUR:0.0, FU:0.0, P:44
-->FUR:0.03125, FU:1.0, P:32
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.3333333432674408, FU:1.0, P:3
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:8
-->FUR:0.0, FU:0.0, P:14
-->FUR:0.0, FU:0.0, P:29
-->show_identity_num 8
-->z_score:-0.19699612259864807, p_hat:0.045662980526685715, n:98.0
-->bias_loss tensor(0.2735, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [3/5], Loss: 0.5553, acc_loss, 0.2818, bias_loss:0.2735
-->batch_size 98
-->weights tensor([2.6304, 0.6173], device='cuda:2')
-->FUR:0.02857142873108387, FU:1.0, P:35
-->FUR:0.04545454680919647, FU:1.0, P:22
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:9
-->FUR:0.05882352963089943, FU:1.0, P:17
-->FUR:0.0, FU:0.0, P:46
-->show_identity_num 8
-->z_score:-1.514768362045288, p_hat:0.016651218757033348, n:98.0
-->bias_loss tensor(0.0997, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [3/5], Loss: 0.1137, acc_loss, 0.0140, bias_loss:0.0997
-->batch_size 98
-->weights tensor([1.9412, 0.6735], device='cuda:2')
-->FUR:0.02777777798473835, FU:1.0, P:36
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:25
-->FUR:0.04878048598766327, FU:2.0, P:41
-->show_identity_num 8
-->z_score:-1.8323307037353516, p_hat:0.009659841656684875, n:98.0
-->bias_loss tensor(0.0579, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [3/5], Loss: 0.1493, acc_loss, 0.0914, bias_loss:0.0579
-->batch_size 98
-->weights tensor([1.9412, 0.6735], device='cuda:2')
-->FUR:0.0, FU:0.0, P:37
-->FUR:0.0, FU:0.0, P:23
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:21
-->FUR:0.019607843831181526, FU:1.0, P:51
-->show_identity_num 8
-->z_score:-2.1556808948516846, p_hat:0.0025410379748791456, n:98.0
-->bias_loss tensor(0.0152, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [3/5], Loss: 0.0884, acc_loss, 0.0732, bias_loss:0.0152
-->batch_size 98
-->weights tensor([2.0806, 0.6582], device='cuda:2')
-->FUR:0.03333333507180214, FU:1.0, P:30
-->FUR:0.0, FU:0.0, P:26
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:5
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.02500000037252903, FU:1.0, P:40
-->show_identity_num 8
-->z_score:-1.936829924583435, p_hat:0.007359209470450878, n:98.0
-->bias_loss tensor(0.0441, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [3/5], Loss: 0.0739, acc_loss, 0.0298, bias_loss:0.0441
-->batch_size 98
-->weights tensor([2.0312, 0.6633], device='cuda:2')
-->FUR:0.0, FU:0.0, P:34
-->FUR:0.0, FU:0.0, P:23
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.0008608175558038056, FU:0.04218006134033203, P:49
-->show_identity_num 8
-->z_score:-2.261099100112915, p_hat:0.0002201740862801671, n:98.0
-->bias_loss tensor(0.0013, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [3/5], Loss: 0.0057, acc_loss, 0.0044, bias_loss:0.0013
-->batch_size 98
-->weights tensor([2.3846, 0.6327], device='cuda:2')
-->FUR:0.0, FU:0.0, P:32
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:12
-->FUR:0.0, FU:0.0, P:18
-->FUR:0.0, FU:0.0, P:49
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss tensor(0.0011, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [3/5], Loss: 0.0013, acc_loss, 0.0002, bias_loss:0.0011
-->batch_size 98
-->weights tensor([3.4000, 0.5862], device='cuda:2')
-->FUR:0.0, FU:0.0, P:38
-->FUR:0.0, FU:0.0, P:19
-->None
-->None
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:8
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:36
-->show_identity_num 6
-->z_score:-2.2642822265625, p_hat:0.00015009584603831172, n:98.0
-->bias_loss tensor(0.0009, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [3/5], Loss: 0.0009, acc_loss, 0.0000, bias_loss:0.0009
-->after epoch 2
-->overall baseline on testing dataset
-->ACC 0.9199626284646527
-->F1 0.9560157453363
-->FPR: 0.5818181818181818
-->FNR: 0.01167728237791932
testing dataset
-->original metric score:
-->identity male
-->length 292
-->ACC 0.886986301369863
-->F1 0.9354207436399217
-->FPR 0.5652173913043478
-->FNR 0.028455284552845527
-->positive probability:0.9075342465753424, 265/292
-->group-truth label positive probability:0.8424657534246576, 246/292
-->identity female
-->length 195
-->ACC 0.8358974358974359
-->F1 0.9006211180124224
-->FPR 0.6086956521739131
-->FNR 0.026845637583892617
-->positive probability:0.8871794871794871, 173/195
-->group-truth label positive probability:0.764102564102564, 149/195
-->identity homosexual
-->length 14
-->ACC 0.8571428571428571
-->F1 0.9
-->FPR 0.4
-->FNR 0.0
-->positive probability:0.7857142857142857, 11/14
-->group-truth label positive probability:0.6428571428571429, 9/14
-->identity christian
-->length 25
-->ACC 0.88
-->F1 0.9333333333333332
-->FPR 0.6666666666666666
-->FNR 0.045454545454545456
-->positive probability:0.92, 23/25
-->group-truth label positive probability:0.88, 22/25
-->identity muslim
-->length 13
-->ACC 0.8461538461538461
-->F1 0.888888888888889
-->FPR 0.4
-->FNR 0.0
-->positive probability:0.7692307692307693, 10/13
-->group-truth label positive probability:0.6153846153846154, 8/13
-->identity jewish
-->length 72
-->ACC 0.7222222222222222
-->F1 0.75
-->FPR 0.45
-->FNR 0.0625
-->positive probability:0.6666666666666666, 48/72
-->group-truth label positive probability:0.4444444444444444, 32/72
-->identity black
-->length 157
-->ACC 0.7834394904458599
-->F1 0.838095238095238
-->FPR 0.453125
-->FNR 0.053763440860215055
-->positive probability:0.7452229299363057, 117/157
-->group-truth label positive probability:0.5923566878980892, 93/157
-->identity white
-->length 381
-->ACC 0.8398950131233596
-->F1 0.9036334913112165
-->FPR 0.6136363636363636
-->FNR 0.023890784982935155
-->positive probability:0.8923884514435696, 340/381
-->group-truth label positive probability:0.7690288713910761, 293/381
-->fpr_diff [0.016600790513834007, 0.026877470355731292, 0.18181818181818177, 0.08484848484848484, 0.18181818181818177, 0.13181818181818178, 0.1286931818181818, 0.03181818181818186]
-->fnr_diff [0.016778002174926206, 0.015168355205973297, 0.01167728237791932, 0.03377726307662614, 0.01167728237791932, 0.05082271762208068, 0.04208615848229574, 0.012213502605015835]
-->FPR:[0.5652173913043478, 0.6086956521739131, 0.4, 0.6666666666666666, 0.4, 0.45, 0.453125, 0.6136363636363636], mean FPR:0.5196676342226614, mean FPR metric:0.09803658185111988
-->FNR:[0.028455284552845527, 0.026845637583892617, 0.0, 0.045454545454545456, 0.0, 0.0625, 0.053763440860215055, 0.023890784982935155], mean FNR:0.030113711679304225, mean FNR metric:0.024275070490344566
-->group metric: 0.024275070490344566
-->epoch 3
-->batch_size 98
-->weights tensor([2.3148, 0.6378], device='cuda:2')
-->FUR:0.0, FU:0.0, P:40
-->FUR:0.0, FU:0.0, P:26
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:4
-->None
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:13
-->FUR:0.0, FU:0.0, P:43
-->show_identity_num 7
-->z_score:-2.262918710708618, p_hat:0.00018011502106674016, n:98.0
-->bias_loss tensor(0.0011, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [4/5], Loss: 0.0015, acc_loss, 0.0004, bias_loss:0.0011
-->batch_size 98
-->weights tensor([1.9412, 0.6735], device='cuda:2')
-->FUR:0.0, FU:0.0, P:35
-->FUR:0.0, FU:0.0, P:26
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:3
-->None
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.0, FU:0.0, P:44
-->show_identity_num 7
-->z_score:-2.262918710708618, p_hat:0.00018011502106674016, n:98.0
-->bias_loss tensor(0.0011, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [4/5], Loss: 0.5919, acc_loss, 0.5908, bias_loss:0.0011
-->batch_size 98
-->weights tensor([2.7273, 0.6122], device='cuda:2')
-->FUR:0.0, FU:0.0, P:33
-->FUR:0.0, FU:0.0, P:16
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:11
-->FUR:0.0, FU:0.0, P:50
-->show_identity_num 8
-->z_score:-2.2639412879943848, p_hat:0.00015760063251946121, n:98.0
-->bias_loss tensor(0.0009, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [4/5], Loss: 0.0115, acc_loss, 0.0106, bias_loss:0.0009
-->batch_size 98
-->weights tensor([2.4600, 0.6276], device='cuda:2')
-->FUR:0.0, FU:0.0, P:35
-->FUR:0.0, FU:0.0, P:32
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:11
-->FUR:0.0, FU:0.0, P:41
-->show_identity_num 8
-->z_score:-2.2639412879943848, p_hat:0.00015760063251946121, n:98.0
-->bias_loss tensor(0.0009, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [4/5], Loss: 0.0009, acc_loss, 0.0000, bias_loss:0.0009
-->batch_size 98
-->weights tensor([1.9848, 0.6684], device='cuda:2')
-->FUR:0.0, FU:0.0, P:25
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:8
-->FUR:0.0, FU:0.0, P:11
-->FUR:0.0, FU:0.0, P:48
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss tensor(0.0011, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [4/5], Loss: 0.2475, acc_loss, 0.2464, bias_loss:0.0011
-->batch_size 98
-->weights tensor([2.7273, 0.6122], device='cuda:2')
-->FUR:0.046511635184288025, FU:2.000000238418579, P:43
-->FUR:0.0, FU:0.0, P:24
-->None
-->FUR:0.0, FU:0.0, P:3
-->None
-->FUR:0.20000000298023224, FU:1.0, P:5
-->FUR:0.06666667014360428, FU:1.0, P:15
-->FUR:0.11363636702299118, FU:5.0, P:44
-->show_identity_num 6
-->z_score:0.9573020935058594, p_hat:0.07107573747634888, n:98.0
-->bias_loss tensor(0.4257, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [4/5], Loss: 0.5739, acc_loss, 0.1482, bias_loss:0.4257
-->batch_size 98
-->weights tensor([2.0312, 0.6633], device='cuda:2')
-->FUR:0.0, FU:0.0, P:44
-->FUR:0.0, FU:0.0, P:25
-->FUR:0.0, FU:0.0, P:2
-->None
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:6
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.025641025975346565, FU:1.0, P:39
-->show_identity_num 7
-->z_score:-2.0988752841949463, p_hat:0.0037916572764515877, n:98.0
-->bias_loss tensor(0.0227, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [4/5], Loss: 0.0605, acc_loss, 0.0378, bias_loss:0.0227
-->batch_size 98
-->weights tensor([2.2500, 0.6429], device='cuda:2')
-->FUR:0.0, FU:0.0, P:40
-->FUR:0.0, FU:0.0, P:22
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:6
-->FUR:0.05882352963089943, FU:1.0, P:17
-->FUR:0.06818182021379471, FU:3.0, P:44
-->show_identity_num 8
-->z_score:-1.5459047555923462, p_hat:0.015965726226568222, n:98.0
-->bias_loss tensor(0.0956, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [4/5], Loss: 0.1646, acc_loss, 0.0689, bias_loss:0.0956
-->batch_size 98
-->weights tensor([3.5625, 0.5816], device='cuda:2')
-->FUR:0.0, FU:0.0, P:44
-->FUR:0.0, FU:0.0, P:32
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:8
-->FUR:0.0, FU:0.0, P:14
-->FUR:0.0, FU:0.0, P:29
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss tensor(0.0011, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [4/5], Loss: 0.0011, acc_loss, 0.0000, bias_loss:0.0011
-->batch_size 98
-->weights tensor([2.6304, 0.6173], device='cuda:2')
-->FUR:0.0, FU:0.0, P:35
-->FUR:0.0, FU:0.0, P:22
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:9
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.0, FU:0.0, P:46
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss tensor(0.0011, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [4/5], Loss: 0.0011, acc_loss, 0.0000, bias_loss:0.0011
-->batch_size 98
-->weights tensor([1.9412, 0.6735], device='cuda:2')
-->FUR:0.0, FU:0.0, P:36
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:25
-->FUR:0.0, FU:0.0, P:41
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss tensor(0.0011, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [4/5], Loss: 0.0307, acc_loss, 0.0297, bias_loss:0.0011
-->batch_size 98
-->weights tensor([1.9412, 0.6735], device='cuda:2')
-->FUR:0.0, FU:0.0, P:37
-->FUR:0.0, FU:0.0, P:23
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:21
-->FUR:0.019607843831181526, FU:1.0, P:51
-->show_identity_num 8
-->z_score:-2.1556808948516846, p_hat:0.0025410379748791456, n:98.0
-->bias_loss tensor(0.0152, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [4/5], Loss: 0.0690, acc_loss, 0.0537, bias_loss:0.0152
-->batch_size 98
-->weights tensor([2.0806, 0.6582], device='cuda:2')
-->FUR:0.0, FU:0.0, P:30
-->FUR:0.0, FU:0.0, P:26
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:5
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:40
-->show_identity_num 8
-->z_score:-2.2639412879943848, p_hat:0.00015760063251946121, n:98.0
-->bias_loss tensor(0.0009, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [4/5], Loss: 0.0010, acc_loss, 0.0000, bias_loss:0.0009
-->batch_size 98
-->weights tensor([2.0312, 0.6633], device='cuda:2')
-->FUR:0.0, FU:0.0, P:34
-->FUR:0.0, FU:0.0, P:23
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.0, FU:0.0, P:49
-->show_identity_num 8
-->z_score:-2.2639412879943848, p_hat:0.00015760063251946121, n:98.0
-->bias_loss tensor(0.0009, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [4/5], Loss: 0.0009, acc_loss, 0.0000, bias_loss:0.0009
-->batch_size 98
-->weights tensor([2.3846, 0.6327], device='cuda:2')
-->FUR:0.03125, FU:1.0, P:32
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.3333333432674408, FU:1.0, P:3
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:12
-->FUR:0.0, FU:0.0, P:18
-->FUR:0.0, FU:0.0, P:49
-->show_identity_num 8
-->z_score:-0.19699612259864807, p_hat:0.045662980526685715, n:98.0
-->bias_loss tensor(0.2735, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [4/5], Loss: 0.2793, acc_loss, 0.0058, bias_loss:0.2735
-->batch_size 98
-->weights tensor([3.4000, 0.5862], device='cuda:2')
-->FUR:0.0, FU:0.0, P:38
-->FUR:0.0, FU:0.0, P:19
-->None
-->None
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:8
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:36
-->show_identity_num 6
-->z_score:-2.2642822265625, p_hat:0.00015009584603831172, n:98.0
-->bias_loss tensor(0.0009, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [4/5], Loss: 0.0009, acc_loss, 0.0000, bias_loss:0.0009
-->after epoch 3
-->overall baseline on testing dataset
-->ACC 0.9205854873871068
-->F1 0.9562231759656652
-->FPR: 0.5558441558441558
-->FNR: 0.014508138711960368
testing dataset
-->original metric score:
-->identity male
-->length 292
-->ACC 0.8904109589041096
-->F1 0.9370078740157479
-->FPR 0.5217391304347826
-->FNR 0.032520325203252036
-->positive probability:0.8972602739726028, 262/292
-->group-truth label positive probability:0.8424657534246576, 246/292
-->identity female
-->length 195
-->ACC 0.8512820512820513
-->F1 0.9090909090909091
-->FPR 0.5434782608695652
-->FNR 0.026845637583892617
-->positive probability:0.8717948717948718, 170/195
-->group-truth label positive probability:0.764102564102564, 149/195
-->identity homosexual
-->length 14
-->ACC 0.8571428571428571
-->F1 0.9
-->FPR 0.4
-->FNR 0.0
-->positive probability:0.7857142857142857, 11/14
-->group-truth label positive probability:0.6428571428571429, 9/14
-->identity christian
-->length 25
-->ACC 0.88
-->F1 0.9333333333333332
-->FPR 0.6666666666666666
-->FNR 0.045454545454545456
-->positive probability:0.92, 23/25
-->group-truth label positive probability:0.88, 22/25
-->identity muslim
-->length 13
-->ACC 0.8461538461538461
-->F1 0.888888888888889
-->FPR 0.4
-->FNR 0.0
-->positive probability:0.7692307692307693, 10/13
-->group-truth label positive probability:0.6153846153846154, 8/13
-->identity jewish
-->length 72
-->ACC 0.7361111111111112
-->F1 0.759493670886076
-->FPR 0.425
-->FNR 0.0625
-->positive probability:0.6527777777777778, 47/72
-->group-truth label positive probability:0.4444444444444444, 32/72
-->identity black
-->length 157
-->ACC 0.7961783439490446
-->F1 0.8461538461538463
-->FPR 0.421875
-->FNR 0.053763440860215055
-->positive probability:0.732484076433121, 115/157
-->group-truth label positive probability:0.5923566878980892, 93/157
-->identity white
-->length 381
-->ACC 0.8451443569553806
-->F1 0.9056000000000001
-->FPR 0.5568181818181818
-->FNR 0.034129692832764506
-->positive probability:0.8713910761154856, 332/381
-->group-truth label positive probability:0.7690288713910761, 293/381
-->fpr_diff [0.03410502540937321, 0.012365894974590619, 0.15584415584415579, 0.11082251082251082, 0.15584415584415579, 0.13084415584415582, 0.1339691558441558, 0.0009740259740259605]
-->fnr_diff [0.018012186491291667, 0.01233749887193225, 0.014508138711960368, 0.030946406742585086, 0.014508138711960368, 0.04799186128803963, 0.039255302148254685, 0.019621554120804137]
-->FPR:[0.5217391304347826, 0.5434782608695652, 0.4, 0.6666666666666666, 0.4, 0.425, 0.421875, 0.5568181818181818], mean FPR:0.4919471549736495, mean FPR metric:0.09184613506964048
-->FNR:[0.032520325203252036, 0.026845637583892617, 0.0, 0.045454545454545456, 0.0, 0.0625, 0.053763440860215055, 0.034129692832764506], mean FNR:0.03190170524183371, mean FNR metric:0.024647635885853524
-->group metric: 0.024647635885853524
-->epoch 4
-->batch_size 98
-->weights tensor([2.3148, 0.6378], device='cuda:2')
-->FUR:0.0, FU:0.0, P:40
-->FUR:0.0, FU:0.0, P:26
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:4
-->None
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:13
-->FUR:0.0, FU:0.0, P:43
-->show_identity_num 7
-->z_score:-2.262918710708618, p_hat:0.00018011502106674016, n:98.0
-->bias_loss tensor(0.0011, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [5/5], Loss: 0.0011, acc_loss, 0.0000, bias_loss:0.0011
-->batch_size 98
-->weights tensor([1.9412, 0.6735], device='cuda:2')
-->FUR:0.0, FU:0.0, P:35
-->FUR:0.0, FU:0.0, P:26
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:3
-->None
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.0, FU:0.0, P:44
-->show_identity_num 7
-->z_score:-2.262918710708618, p_hat:0.00018011502106674016, n:98.0
-->bias_loss tensor(0.0011, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [5/5], Loss: 0.1668, acc_loss, 0.1657, bias_loss:0.0011
-->batch_size 98
-->weights tensor([2.7273, 0.6122], device='cuda:2')
-->FUR:0.0, FU:0.0, P:33
-->FUR:0.0, FU:0.0, P:16
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:11
-->FUR:0.0, FU:0.0, P:50
-->show_identity_num 8
-->z_score:-2.2639412879943848, p_hat:0.00015760063251946121, n:98.0
-->bias_loss tensor(0.0009, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [5/5], Loss: 0.0010, acc_loss, 0.0000, bias_loss:0.0009
-->batch_size 98
-->weights tensor([2.4600, 0.6276], device='cuda:2')
-->FUR:0.0, FU:0.0, P:35
-->FUR:0.0, FU:0.0, P:32
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:11
-->FUR:0.0, FU:0.0, P:41
-->show_identity_num 8
-->z_score:-2.2639412879943848, p_hat:0.00015760063251946121, n:98.0
-->bias_loss tensor(0.0009, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [5/5], Loss: 0.0039, acc_loss, 0.0029, bias_loss:0.0009
-->batch_size 98
-->weights tensor([1.9848, 0.6684], device='cuda:2')
-->FUR:0.0, FU:0.0, P:25
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:8
-->FUR:0.0, FU:0.0, P:11
-->FUR:0.02083333395421505, FU:1.0, P:48
-->show_identity_num 8
-->z_score:-2.1466774940490723, p_hat:0.0027392529882490635, n:98.0
-->bias_loss tensor(0.0164, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [5/5], Loss: 0.0265, acc_loss, 0.0101, bias_loss:0.0164
-->batch_size 98
-->weights tensor([2.7273, 0.6122], device='cuda:2')
-->FUR:0.0, FU:0.0, P:43
-->FUR:0.0, FU:0.0, P:24
-->None
-->FUR:0.0, FU:0.0, P:3
-->None
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:15
-->FUR:0.0, FU:0.0, P:44
-->show_identity_num 6
-->z_score:-2.262918710708618, p_hat:0.00018011502106674016, n:98.0
-->bias_loss tensor(0.0011, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [5/5], Loss: 0.0032, acc_loss, 0.0021, bias_loss:0.0011
-->batch_size 98
-->weights tensor([2.0312, 0.6633], device='cuda:2')
-->FUR:0.0, FU:0.0, P:44
-->FUR:0.0, FU:0.0, P:25
-->FUR:0.0, FU:0.0, P:2
-->None
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:6
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:39
-->show_identity_num 7
-->z_score:-2.262918710708618, p_hat:0.00018011502106674016, n:98.0
-->bias_loss tensor(0.0011, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [5/5], Loss: 0.0011, acc_loss, 0.0001, bias_loss:0.0011
-->batch_size 98
-->weights tensor([2.2500, 0.6429], device='cuda:2')
-->FUR:0.0, FU:0.0, P:40
-->FUR:0.0, FU:0.0, P:22
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:6
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.022727273404598236, FU:1.0, P:44
-->show_identity_num 8
-->z_score:-2.1359243392944336, p_hat:0.002975995419546962, n:98.0
-->bias_loss tensor(0.0178, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [5/5], Loss: 0.0244, acc_loss, 0.0065, bias_loss:0.0178
-->batch_size 98
-->weights tensor([3.5625, 0.5816], device='cuda:2')
-->FUR:0.0, FU:0.0, P:44
-->FUR:0.0, FU:0.0, P:32
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:8
-->FUR:0.0, FU:0.0, P:14
-->FUR:0.0, FU:0.0, P:29
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss tensor(0.0011, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [5/5], Loss: 0.0011, acc_loss, 0.0000, bias_loss:0.0011
-->batch_size 98
-->weights tensor([2.6304, 0.6173], device='cuda:2')
-->FUR:0.0, FU:0.0, P:35
-->FUR:0.0, FU:0.0, P:22
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:9
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.0, FU:0.0, P:46
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss tensor(0.0011, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [5/5], Loss: 0.0011, acc_loss, 0.0000, bias_loss:0.0011
-->batch_size 98
-->weights tensor([1.9412, 0.6735], device='cuda:2')
-->FUR:0.0, FU:0.0, P:36
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:25
-->FUR:0.024390242993831635, FU:1.0, P:41
-->show_identity_num 8
-->z_score:-2.1264824867248535, p_hat:0.0031838666182011366, n:98.0
-->bias_loss tensor(0.0191, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [5/5], Loss: 0.0339, acc_loss, 0.0148, bias_loss:0.0191
-->batch_size 98
-->weights tensor([1.9412, 0.6735], device='cuda:2')
-->FUR:0.0, FU:0.0, P:37
-->FUR:0.0, FU:0.0, P:23
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:21
-->FUR:0.019607843831181526, FU:1.0, P:51
-->show_identity_num 8
-->z_score:-2.1556808948516846, p_hat:0.0025410379748791456, n:98.0
-->bias_loss tensor(0.0152, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [5/5], Loss: 0.1435, acc_loss, 0.1282, bias_loss:0.0152
-->batch_size 98
-->weights tensor([2.0806, 0.6582], device='cuda:2')
-->FUR:0.0, FU:0.0, P:30
-->FUR:0.0, FU:0.0, P:26
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:5
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.02500000037252903, FU:1.0, P:40
-->show_identity_num 8
-->z_score:-2.1240429878234863, p_hat:0.0032375718001276255, n:98.0
-->bias_loss tensor(0.0194, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [5/5], Loss: 0.0600, acc_loss, 0.0406, bias_loss:0.0194
-->batch_size 98
-->weights tensor([2.0312, 0.6633], device='cuda:2')
-->FUR:0.0, FU:0.0, P:34
-->FUR:0.0, FU:0.0, P:23
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.05882352963089943, FU:1.0, P:17
-->FUR:0.0, FU:0.0, P:49
-->show_identity_num 8
-->z_score:-1.9320015907287598, p_hat:0.007465512957423925, n:98.0
-->bias_loss tensor(0.0447, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [5/5], Loss: 0.0653, acc_loss, 0.0206, bias_loss:0.0447
-->batch_size 98
-->weights tensor([2.3846, 0.6327], device='cuda:2')
-->FUR:0.0, FU:0.0, P:32
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:12
-->FUR:0.0, FU:0.0, P:18
-->FUR:0.0, FU:0.0, P:49
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss tensor(0.0011, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [5/5], Loss: 0.0016, acc_loss, 0.0005, bias_loss:0.0011
-->batch_size 98
-->weights tensor([3.4000, 0.5862], device='cuda:2')
-->FUR:0.0, FU:0.0, P:38
-->FUR:0.0, FU:0.0, P:19
-->None
-->None
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:8
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:36
-->show_identity_num 6
-->z_score:-2.2642822265625, p_hat:0.00015009584603831172, n:98.0
-->bias_loss tensor(0.0009, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [5/5], Loss: 0.0009, acc_loss, 0.0000, bias_loss:0.0009
-->after epoch 4
-->overall baseline on testing dataset
-->ACC 0.9299283712239178
-->F1 0.9608082215641874
-->FPR: 0.4077922077922078
-->FNR: 0.024062278839348902
testing dataset
-->original metric score:
-->identity male
-->length 292
-->ACC 0.9006849315068494
-->F1 0.9418837675350701
-->FPR 0.391304347826087
-->FNR 0.044715447154471545
-->positive probability:0.8664383561643836, 253/292
-->group-truth label positive probability:0.8424657534246576, 246/292
-->identity female
-->length 195
-->ACC 0.8769230769230769
-->F1 0.92
-->FPR 0.2826086956521739
-->FNR 0.0738255033557047
-->positive probability:0.7743589743589744, 151/195
-->group-truth label positive probability:0.764102564102564, 149/195
-->identity homosexual
-->length 14
-->ACC 0.9285714285714286
-->F1 0.9473684210526316
-->FPR 0.2
-->FNR 0.0
-->positive probability:0.7142857142857143, 10/14
-->group-truth label positive probability:0.6428571428571429, 9/14
-->identity christian
-->length 25
-->ACC 0.88
-->F1 0.9333333333333332
-->FPR 0.6666666666666666
-->FNR 0.045454545454545456
-->positive probability:0.92, 23/25
-->group-truth label positive probability:0.88, 22/25
-->identity muslim
-->length 13
-->ACC 0.7692307692307693
-->F1 0.823529411764706
-->FPR 0.4
-->FNR 0.125
-->positive probability:0.6923076923076923, 9/13
-->group-truth label positive probability:0.6153846153846154, 8/13
-->identity jewish
-->length 72
-->ACC 0.7361111111111112
-->F1 0.7397260273972602
-->FPR 0.35
-->FNR 0.15625
-->positive probability:0.5694444444444444, 41/72
-->group-truth label positive probability:0.4444444444444444, 32/72
-->identity black
-->length 157
-->ACC 0.802547770700637
-->F1 0.841025641025641
-->FPR 0.3125
-->FNR 0.11827956989247312
-->positive probability:0.6496815286624203, 102/157
-->group-truth label positive probability:0.5923566878980892, 93/157
-->identity white
-->length 381
-->ACC 0.8713910761154856
-->F1 0.9190082644628099
-->FPR 0.38636363636363635
-->FNR 0.051194539249146756
-->positive probability:0.8188976377952756, 312/381
-->group-truth label positive probability:0.7690288713910761, 293/381
-->fpr_diff [0.016487859966120844, 0.12518351214003393, 0.2077922077922078, 0.2588744588744588, 0.007792207792207795, 0.05779220779220784, 0.09529220779220782, 0.021428571428571463]
-->fnr_diff [0.020653168315122643, 0.0497632245163558, 0.024062278839348902, 0.021392266615196553, 0.1009377211606511, 0.13218772116065108, 0.09421729105312422, 0.027132260409797854]
-->FPR:[0.391304347826087, 0.2826086956521739, 0.2, 0.6666666666666666, 0.4, 0.35, 0.3125, 0.38636363636363635], mean FPR:0.37368041831357046, mean FPR metric:0.09883040419725204
-->FNR:[0.044715447154471545, 0.0738255033557047, 0.0, 0.045454545454545456, 0.125, 0.15625, 0.11827956989247312, 0.051194539249146756], mean FNR:0.07683995063829269, mean FNR metric:0.05879324150878102
-->group metric: 0.05879324150878102
   test_acc   test_f1  ...  test_fnr_mean  test_fnr_metric
0  0.925568  0.958485  ...       0.052833         0.040978
1  0.925257  0.958635  ...       0.038748         0.030787
2  0.919963  0.956016  ...       0.030114         0.024275
3  0.920585  0.956223  ...       0.031902         0.024648
4  0.929928  0.960808  ...       0.076840         0.058793

[5 rows x 10 columns]
-->gamma 0.7
-->gamma 0.7
-->model AddedLayers(
  (model): Sequential(
    (0): Linear(in_features=4096, out_features=328, bias=True)
    (1): GELU(approximate='none')
    (2): Linear(in_features=328, out_features=4096, bias=True)
    (3): GELU(approximate='none')
    (4): Linear(in_features=4096, out_features=328, bias=True)
    (5): GELU(approximate='none')
    (6): Linear(in_features=328, out_features=4096, bias=True)
  )
)
-->classifier Linear(in_features=4096, out_features=2, bias=False)
-->MinValue:-2.271099895830676, MaxValue:2.2792810789854263
-->epoch 0
-->batch_size 98
-->weights tensor([2.3148, 0.6378], device='cuda:2')
-->FUR:0.0, FU:0.0, P:40
-->FUR:0.0, FU:0.0, P:26
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:4
-->None
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:13
-->FUR:0.0, FU:0.0, P:43
-->show_identity_num 7
-->z_score:-2.262918710708618, p_hat:0.00018011502106674016, n:98.0
-->bias_loss tensor(0.0013, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.3256, acc_loss, 0.3243, bias_loss:0.0013
-->batch_size 98
-->weights tensor([1.9412, 0.6735], device='cuda:2')
-->FUR:0.3142857253551483, FU:11.0, P:35
-->FUR:0.11328629404306412, FU:2.945443630218506, P:26
-->FUR:0.5, FU:1.0, P:2
-->FUR:0.3333333432674408, FU:1.0, P:3
-->None
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.1764705926179886, FU:3.0, P:17
-->FUR:0.20466011762619019, FU:9.005044937133789, P:44
-->show_identity_num 7
-->z_score:8.377994537353516, p_hat:0.23444795608520508, n:98.0
-->bias_loss tensor(0.7000, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.9536, acc_loss, 0.2536, bias_loss:0.7000
-->batch_size 98
-->weights tensor([2.7273, 0.6122], device='cuda:2')
-->FUR:0.0, FU:0.0, P:33
-->FUR:0.0, FU:0.0, P:16
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:11
-->FUR:0.0, FU:0.0, P:50
-->show_identity_num 8
-->z_score:-2.2639412879943848, p_hat:0.00015760063251946121, n:98.0
-->bias_loss tensor(0.0011, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 1.0627, acc_loss, 1.0616, bias_loss:0.0011
-->batch_size 98
-->weights tensor([2.4600, 0.6276], device='cuda:2')
-->FUR:0.0, FU:0.0, P:35
-->FUR:4.563480615615845e-06, FU:0.00014603137969970703, P:32
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:11
-->FUR:0.0, FU:0.0, P:41
-->show_identity_num 8
-->z_score:-2.263967514038086, p_hat:0.00015703019744250923, n:98.0
-->bias_loss tensor(0.0011, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.0145, acc_loss, 0.0134, bias_loss:0.0011
-->batch_size 98
-->weights tensor([1.9848, 0.6684], device='cuda:2')
-->FUR:0.11869090795516968, FU:2.9672727584838867, P:25
-->FUR:0.31117305159568787, FU:4.978768825531006, P:16
-->FUR:0.6666666865348816, FU:2.0, P:3
-->FUR:0.5, FU:1.0, P:2
-->FUR:0.48364728689193726, FU:0.9672945737838745, P:2
-->FUR:0.5, FU:4.0, P:8
-->FUR:0.45161864161491394, FU:4.967804908752441, P:11
-->FUR:0.22872649133205414, FU:10.97887134552002, P:48
-->show_identity_num 8
-->z_score:16.233152389526367, p_hat:0.4073852598667145, n:98.0
-->bias_loss tensor(0.7000, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 1.1528, acc_loss, 0.4528, bias_loss:0.7000
-->batch_size 98
-->weights tensor([2.7273, 0.6122], device='cuda:2')
-->FUR:0.0, FU:0.0, P:43
-->FUR:0.0, FU:0.0, P:24
-->None
-->FUR:0.0, FU:0.0, P:3
-->None
-->FUR:0.19994232058525085, FU:0.9997115731239319, P:5
-->FUR:0.0, FU:0.0, P:15
-->FUR:0.04545454680919647, FU:2.0, P:44
-->show_identity_num 6
-->z_score:-0.4106367826461792, p_hat:0.040959518402814865, n:98.0
-->bias_loss tensor(0.2862, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.4510, acc_loss, 0.1648, bias_loss:0.2862
-->batch_size 98
-->weights tensor([2.0312, 0.6633], device='cuda:2')
-->FUR:0.022727273404598236, FU:1.0, P:44
-->FUR:0.0, FU:0.0, P:25
-->FUR:0.0, FU:0.0, P:2
-->None
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:6
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:39
-->show_identity_num 7
-->z_score:-2.1177821159362793, p_hat:0.00337540777400136, n:98.0
-->bias_loss tensor(0.0236, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.0360, acc_loss, 0.0124, bias_loss:0.0236
-->batch_size 98
-->weights tensor([2.2500, 0.6429], device='cuda:2')
-->FUR:0.0, FU:0.0, P:40
-->FUR:0.0, FU:0.0, P:22
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:6
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.0, FU:0.0, P:44
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss tensor(0.0013, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.0109, acc_loss, 0.0096, bias_loss:0.0013
-->batch_size 98
-->weights tensor([3.5625, 0.5816], device='cuda:2')
-->FUR:0.0, FU:0.0, P:44
-->FUR:0.03125, FU:1.0, P:32
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.3333333432674408, FU:1.0, P:3
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:8
-->FUR:0.0, FU:0.0, P:14
-->FUR:0.0, FU:0.0, P:29
-->show_identity_num 8
-->z_score:-0.19699612259864807, p_hat:0.045662980526685715, n:98.0
-->bias_loss tensor(0.3191, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.3924, acc_loss, 0.0734, bias_loss:0.3191
-->batch_size 98
-->weights tensor([2.6304, 0.6173], device='cuda:2')
-->FUR:0.0, FU:0.0, P:35
-->FUR:0.0, FU:0.0, P:22
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:9
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.0, FU:0.0, P:46
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss tensor(0.0013, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.0042, acc_loss, 0.0030, bias_loss:0.0013
-->batch_size 98
-->weights tensor([1.9412, 0.6735], device='cuda:2')
-->FUR:0.0, FU:0.0, P:36
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:25
-->FUR:0.0, FU:0.0, P:41
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss tensor(0.0013, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.0042, acc_loss, 0.0030, bias_loss:0.0013
-->batch_size 98
-->weights tensor([1.9412, 0.6735], device='cuda:2')
-->FUR:0.0, FU:0.0, P:37
-->FUR:0.0, FU:0.0, P:23
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:21
-->FUR:0.019607843831181526, FU:1.0, P:51
-->show_identity_num 8
-->z_score:-2.1556808948516846, p_hat:0.0025410379748791456, n:98.0
-->bias_loss tensor(0.0178, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.1138, acc_loss, 0.0960, bias_loss:0.0178
-->batch_size 98
-->weights tensor([2.0806, 0.6582], device='cuda:2')
-->FUR:0.0, FU:0.0, P:30
-->FUR:0.0, FU:0.0, P:26
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:5
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:40
-->show_identity_num 8
-->z_score:-2.2639412879943848, p_hat:0.00015760063251946121, n:98.0
-->bias_loss tensor(0.0011, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.0080, acc_loss, 0.0069, bias_loss:0.0011
-->batch_size 98
-->weights tensor([2.0312, 0.6633], device='cuda:2')
-->FUR:0.0, FU:0.0, P:34
-->FUR:0.0, FU:0.0, P:23
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.020408162847161293, FU:1.0, P:49
-->show_identity_num 8
-->z_score:-2.1501142978668213, p_hat:0.0026635921094566584, n:98.0
-->bias_loss tensor(0.0186, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.0451, acc_loss, 0.0265, bias_loss:0.0186
-->batch_size 98
-->weights tensor([2.3846, 0.6327], device='cuda:2')
-->FUR:0.09375, FU:3.0, P:32
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.3333333432674408, FU:1.0, P:3
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:12
-->FUR:0.0, FU:0.0, P:18
-->FUR:0.020408162847161293, FU:1.0, P:49
-->show_identity_num 8
-->z_score:0.27169036865234375, p_hat:0.05598147213459015, n:98.0
-->bias_loss tensor(0.3912, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.4743, acc_loss, 0.0831, bias_loss:0.3912
-->batch_size 98
-->weights tensor([3.4000, 0.5862], device='cuda:2')
-->FUR:0.0, FU:0.0, P:38
-->FUR:0.0, FU:0.0, P:19
-->None
-->None
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:8
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:36
-->show_identity_num 6
-->z_score:-2.2642822265625, p_hat:0.00015009584603831172, n:98.0
-->bias_loss tensor(0.0010, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.0034, acc_loss, 0.0024, bias_loss:0.0010
-->after epoch 0
-->overall baseline on testing dataset
-->ACC 0.9265026471504204
-->F1 0.958970792767733
-->FPR: 0.43636363636363634
-->FNR: 0.024062278839348902
testing dataset
-->original metric score:
-->identity male
-->length 292
-->ACC 0.910958904109589
-->F1 0.9475806451612904
-->FPR 0.32608695652173914
-->FNR 0.044715447154471545
-->positive probability:0.8561643835616438, 250/292
-->group-truth label positive probability:0.8424657534246576, 246/292
-->identity female
-->length 195
-->ACC 0.8666666666666667
-->F1 0.9139072847682119
-->FPR 0.32608695652173914
-->FNR 0.0738255033557047
-->positive probability:0.7846153846153846, 153/195
-->group-truth label positive probability:0.764102564102564, 149/195
-->identity homosexual
-->length 14
-->ACC 0.9285714285714286
-->F1 0.9473684210526316
-->FPR 0.2
-->FNR 0.0
-->positive probability:0.7142857142857143, 10/14
-->group-truth label positive probability:0.6428571428571429, 9/14
-->identity christian
-->length 25
-->ACC 0.88
-->F1 0.9333333333333332
-->FPR 0.6666666666666666
-->FNR 0.045454545454545456
-->positive probability:0.92, 23/25
-->group-truth label positive probability:0.88, 22/25
-->identity muslim
-->length 13
-->ACC 0.8461538461538461
-->F1 0.888888888888889
-->FPR 0.4
-->FNR 0.0
-->positive probability:0.7692307692307693, 10/13
-->group-truth label positive probability:0.6153846153846154, 8/13
-->identity jewish
-->length 72
-->ACC 0.7638888888888888
-->F1 0.767123287671233
-->FPR 0.325
-->FNR 0.125
-->positive probability:0.5694444444444444, 41/72
-->group-truth label positive probability:0.4444444444444444, 32/72
-->identity black
-->length 157
-->ACC 0.802547770700637
-->F1 0.8426395939086294
-->FPR 0.328125
-->FNR 0.10752688172043011
-->positive probability:0.6624203821656051, 104/157
-->group-truth label positive probability:0.5923566878980892, 93/157
-->identity white
-->length 381
-->ACC 0.868766404199475
-->F1 0.9177631578947368
-->FPR 0.4090909090909091
-->FNR 0.04778156996587031
-->positive probability:0.8267716535433071, 315/381
-->group-truth label positive probability:0.7690288713910761, 293/381
-->fpr_diff [0.11027667984189721, 0.11027667984189721, 0.23636363636363633, 0.2303030303030303, 0.03636363636363632, 0.11136363636363633, 0.10823863636363634, 0.027272727272727226]
-->fnr_diff [0.020653168315122643, 0.0497632245163558, 0.024062278839348902, 0.021392266615196553, 0.024062278839348902, 0.1009377211606511, 0.0834646028810812, 0.023719291126521408]
-->FPR:[0.32608695652173914, 0.32608695652173914, 0.2, 0.6666666666666666, 0.4, 0.325, 0.328125, 0.4090909090909091], mean FPR:0.3726320611001318, mean FPR metric:0.12130733283926216
-->FNR:[0.044715447154471545, 0.0738255033557047, 0.0, 0.045454545454545456, 0.0, 0.125, 0.10752688172043011, 0.04778156996587031], mean FNR:0.05553799345637776, mean FNR metric:0.04350685403670331
-->group metric: 0.04350685403670331
-->epoch 1
-->batch_size 98
-->weights tensor([2.3148, 0.6378], device='cuda:2')
-->FUR:0.0, FU:0.0, P:40
-->FUR:0.0, FU:0.0, P:26
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:4
-->None
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:13
-->FUR:0.0, FU:0.0, P:43
-->show_identity_num 7
-->z_score:-2.262918710708618, p_hat:0.00018011502106674016, n:98.0
-->bias_loss tensor(0.0013, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [2/5], Loss: 0.0021, acc_loss, 0.0008, bias_loss:0.0013
-->batch_size 98
-->weights tensor([1.9412, 0.6735], device='cuda:2')
-->FUR:0.0, FU:0.0, P:35
-->FUR:0.03846153989434242, FU:1.0, P:26
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:3
-->None
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.0, FU:0.0, P:44
-->show_identity_num 7
-->z_score:-2.0156848430633545, p_hat:0.005623158998787403, n:98.0
-->bias_loss tensor(0.0393, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [2/5], Loss: 0.0762, acc_loss, 0.0370, bias_loss:0.0393
-->batch_size 98
-->weights tensor([2.7273, 0.6122], device='cuda:2')
-->FUR:0.0, FU:0.0, P:33
-->FUR:0.0, FU:0.0, P:16
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:11
-->FUR:0.0, FU:0.0, P:50
-->show_identity_num 8
-->z_score:-2.2639412879943848, p_hat:0.00015760063251946121, n:98.0
-->bias_loss tensor(0.0011, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [2/5], Loss: 0.0019, acc_loss, 0.0008, bias_loss:0.0011
-->batch_size 98
-->weights tensor([2.4600, 0.6276], device='cuda:2')
-->FUR:0.02857142873108387, FU:1.0, P:35
-->FUR:0.03125, FU:1.0, P:32
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:11
-->FUR:0.0, FU:0.0, P:41
-->show_identity_num 8
-->z_score:-1.9283808469772339, p_hat:0.007545221131294966, n:98.0
-->bias_loss tensor(0.0527, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [2/5], Loss: 0.0985, acc_loss, 0.0458, bias_loss:0.0527
-->batch_size 98
-->weights tensor([1.9848, 0.6684], device='cuda:2')
-->FUR:0.0, FU:0.0, P:25
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:8
-->FUR:0.0, FU:0.0, P:11
-->FUR:0.0, FU:0.0, P:48
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss tensor(0.0013, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [2/5], Loss: 0.0320, acc_loss, 0.0307, bias_loss:0.0013
-->batch_size 98
-->weights tensor([2.7273, 0.6122], device='cuda:2')
-->FUR:0.0, FU:0.0, P:43
-->FUR:0.0, FU:0.0, P:24
-->None
-->FUR:0.0, FU:0.0, P:3
-->None
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:15
-->FUR:0.0, FU:0.0, P:44
-->show_identity_num 6
-->z_score:-2.262918710708618, p_hat:0.00018011502106674016, n:98.0
-->bias_loss tensor(0.0013, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [2/5], Loss: 0.2286, acc_loss, 0.2273, bias_loss:0.0013
-->batch_size 98
-->weights tensor([2.0312, 0.6633], device='cuda:2')
-->FUR:0.0, FU:0.0, P:44
-->FUR:0.0, FU:0.0, P:25
-->FUR:0.0, FU:0.0, P:2
-->None
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:6
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:39
-->show_identity_num 7
-->z_score:-2.262918710708618, p_hat:0.00018011502106674016, n:98.0
-->bias_loss tensor(0.0013, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [2/5], Loss: 0.0027, acc_loss, 0.0015, bias_loss:0.0013
-->batch_size 98
-->weights tensor([2.2500, 0.6429], device='cuda:2')
-->FUR:0.0, FU:0.0, P:40
-->FUR:0.0, FU:0.0, P:22
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:6
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.0, FU:0.0, P:44
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss tensor(0.0013, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [2/5], Loss: 0.1125, acc_loss, 0.1112, bias_loss:0.0013
-->batch_size 98
-->weights tensor([3.5625, 0.5816], device='cuda:2')
-->FUR:0.26832011342048645, FU:11.806085586547852, P:44
-->FUR:0.1874999701976776, FU:5.999999046325684, P:32
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.6666666865348816, FU:2.0, P:3
-->FUR:1.0, FU:1.0, P:1
-->FUR:0.2499965876340866, FU:1.9999727010726929, P:8
-->FUR:0.14285656809806824, FU:1.9999918937683105, P:14
-->FUR:0.17148330807685852, FU:4.973015785217285, P:29
-->show_identity_num 8
-->z_score:12.977872848510742, p_hat:0.3357177972793579, n:98.0
-->bias_loss tensor(0.7000, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [2/5], Loss: 1.1365, acc_loss, 0.4365, bias_loss:0.7000
-->batch_size 98
-->weights tensor([2.6304, 0.6173], device='cuda:2')
-->FUR:0.0, FU:0.0, P:35
-->FUR:0.0, FU:0.0, P:22
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:9
-->FUR:0.05882352963089943, FU:1.0, P:17
-->FUR:0.0, FU:0.0, P:46
-->show_identity_num 8
-->z_score:-1.9309788942337036, p_hat:0.007488027680665255, n:98.0
-->bias_loss tensor(0.0523, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [2/5], Loss: 0.0989, acc_loss, 0.0465, bias_loss:0.0523
-->batch_size 98
-->weights tensor([1.9412, 0.6735], device='cuda:2')
-->FUR:0.02777777798473835, FU:1.0, P:36
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:25
-->FUR:0.024390242993831635, FU:1.0, P:41
-->show_identity_num 8
-->z_score:-1.9708123207092285, p_hat:0.0066110603511333466, n:98.0
-->bias_loss tensor(0.0462, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [2/5], Loss: 0.1277, acc_loss, 0.0815, bias_loss:0.0462
-->batch_size 98
-->weights tensor([1.9412, 0.6735], device='cuda:2')
-->FUR:0.0, FU:0.0, P:37
-->FUR:0.0, FU:0.0, P:23
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:21
-->FUR:0.019607843831181526, FU:1.0, P:51
-->show_identity_num 8
-->z_score:-2.1556808948516846, p_hat:0.0025410379748791456, n:98.0
-->bias_loss tensor(0.0178, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [2/5], Loss: 0.1270, acc_loss, 0.1093, bias_loss:0.0178
-->batch_size 98
-->weights tensor([2.0806, 0.6582], device='cuda:2')
-->FUR:0.0, FU:0.0, P:30
-->FUR:0.0, FU:0.0, P:26
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:5
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:40
-->show_identity_num 8
-->z_score:-2.2639412879943848, p_hat:0.00015760063251946121, n:98.0
-->bias_loss tensor(0.0011, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [2/5], Loss: 0.0026, acc_loss, 0.0015, bias_loss:0.0011
-->batch_size 98
-->weights tensor([2.0312, 0.6633], device='cuda:2')
-->FUR:0.0, FU:0.0, P:34
-->FUR:0.0, FU:0.0, P:23
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.020408162847161293, FU:1.0, P:49
-->show_identity_num 8
-->z_score:-2.1501142978668213, p_hat:0.0026635921094566584, n:98.0
-->bias_loss tensor(0.0186, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [2/5], Loss: 0.0329, acc_loss, 0.0142, bias_loss:0.0186
-->batch_size 98
-->weights tensor([2.3846, 0.6327], device='cuda:2')
-->FUR:0.0, FU:0.0, P:32
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:12
-->FUR:0.0, FU:0.0, P:18
-->FUR:0.0, FU:0.0, P:49
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss tensor(0.0013, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [2/5], Loss: 0.0013, acc_loss, 0.0000, bias_loss:0.0013
-->batch_size 98
-->weights tensor([3.4000, 0.5862], device='cuda:2')
-->FUR:0.0, FU:0.0, P:38
-->FUR:0.0, FU:0.0, P:19
-->None
-->None
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:8
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:36
-->show_identity_num 6
-->z_score:-2.2642822265625, p_hat:0.00015009584603831172, n:98.0
-->bias_loss tensor(0.0010, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [2/5], Loss: 0.0010, acc_loss, 0.0000, bias_loss:0.0010
-->after epoch 1
-->overall baseline on testing dataset
-->ACC 0.9293055123014637
-->F1 0.9598158966188706
-->FPR: 0.2909090909090909
-->FNR: 0.04069355980184006
testing dataset
-->original metric score:
-->identity male
-->length 292
-->ACC 0.9041095890410958
-->F1 0.9423868312757202
-->FPR 0.2391304347826087
-->FNR 0.06910569105691057
-->positive probability:0.821917808219178, 240/292
-->group-truth label positive probability:0.8424657534246576, 246/292
-->identity female
-->length 195
-->ACC 0.9025641025641026
-->F1 0.9347079037800687
-->FPR 0.13043478260869565
-->FNR 0.087248322147651
-->positive probability:0.7282051282051282, 142/195
-->group-truth label positive probability:0.764102564102564, 149/195
-->identity homosexual
-->length 14
-->ACC 1.0
-->F1 1.0
-->FPR 0.0
-->FNR 0.0
-->positive probability:0.6428571428571429, 9/14
-->group-truth label positive probability:0.6428571428571429, 9/14
-->identity christian
-->length 25
-->ACC 0.88
-->F1 0.9302325581395349
-->FPR 0.3333333333333333
-->FNR 0.09090909090909091
-->positive probability:0.84, 21/25
-->group-truth label positive probability:0.88, 22/25
-->identity muslim
-->length 13
-->ACC 0.7692307692307693
-->F1 0.823529411764706
-->FPR 0.4
-->FNR 0.125
-->positive probability:0.6923076923076923, 9/13
-->group-truth label positive probability:0.6153846153846154, 8/13
-->identity jewish
-->length 72
-->ACC 0.8194444444444444
-->F1 0.8
-->FPR 0.175
-->FNR 0.1875
-->positive probability:0.4583333333333333, 33/72
-->group-truth label positive probability:0.4444444444444444, 32/72
-->identity black
-->length 157
-->ACC 0.7961783439490446
-->F1 0.8260869565217392
-->FPR 0.234375
-->FNR 0.1827956989247312
-->positive probability:0.5796178343949044, 91/157
-->group-truth label positive probability:0.5923566878980892, 93/157
-->identity white
-->length 381
-->ACC 0.8713910761154856
-->F1 0.9153713298791019
-->FPR 0.23863636363636365
-->FNR 0.09556313993174062
-->positive probability:0.7506561679790026, 286/381
-->group-truth label positive probability:0.7690288713910761, 293/381
-->fpr_diff [0.05177865612648219, 0.16047430830039525, 0.2909090909090909, 0.04242424242424242, 0.10909090909090913, 0.1159090909090909, 0.056534090909090895, 0.05227272727272725]
-->fnr_diff [0.028412131255070514, 0.04655476234581095, 0.04069355980184006, 0.050215531107250855, 0.08430644019815994, 0.14680644019815994, 0.14210213912289113, 0.054869580129900564]
-->FPR:[0.2391304347826087, 0.13043478260869565, 0.0, 0.3333333333333333, 0.4, 0.175, 0.234375, 0.23863636363636365], mean FPR:0.21886373929512515, mean FPR metric:0.10992413949275362
-->FNR:[0.06910569105691057, 0.087248322147651, 0.0, 0.09090909090909091, 0.125, 0.1875, 0.1827956989247312, 0.09556313993174062], mean FNR:0.10476524287126554, mean FNR metric:0.0742450730198855
-->group metric: 0.0742450730198855
-->epoch 2
-->batch_size 98
-->weights tensor([2.3148, 0.6378], device='cuda:2')
-->FUR:0.0, FU:0.0, P:40
-->FUR:0.0, FU:0.0, P:26
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:4
-->None
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:13
-->FUR:0.0, FU:0.0, P:43
-->show_identity_num 7
-->z_score:-2.262918710708618, p_hat:0.00018011502106674016, n:98.0
-->bias_loss tensor(0.0013, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [3/5], Loss: 0.0014, acc_loss, 0.0001, bias_loss:0.0013
-->batch_size 98
-->weights tensor([1.9412, 0.6735], device='cuda:2')
-->FUR:0.0, FU:0.0, P:35
-->FUR:0.0, FU:0.0, P:26
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:3
-->None
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.0, FU:0.0, P:44
-->show_identity_num 7
-->z_score:-2.262918710708618, p_hat:0.00018011502106674016, n:98.0
-->bias_loss tensor(0.0013, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [3/5], Loss: 0.0020, acc_loss, 0.0007, bias_loss:0.0013
-->batch_size 98
-->weights tensor([2.7273, 0.6122], device='cuda:2')
-->FUR:0.0, FU:0.0, P:33
-->FUR:0.0, FU:0.0, P:16
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:11
-->FUR:0.0, FU:0.0, P:50
-->show_identity_num 8
-->z_score:-2.2639412879943848, p_hat:0.00015760063251946121, n:98.0
-->bias_loss tensor(0.0011, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [3/5], Loss: 0.5650, acc_loss, 0.5639, bias_loss:0.0011
-->batch_size 98
-->weights tensor([2.4600, 0.6276], device='cuda:2')
-->FUR:0.0, FU:0.0, P:35
-->FUR:0.03125, FU:1.0, P:32
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:11
-->FUR:0.024390242993831635, FU:1.0, P:41
-->show_identity_num 8
-->z_score:-1.9521207809448242, p_hat:0.007022572681307793, n:98.0
-->bias_loss tensor(0.0491, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [3/5], Loss: 0.1018, acc_loss, 0.0528, bias_loss:0.0491
-->batch_size 98
-->weights tensor([1.9848, 0.6684], device='cuda:2')
-->FUR:0.0, FU:0.0, P:25
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:8
-->FUR:0.0, FU:0.0, P:11
-->FUR:0.0, FU:0.0, P:48
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss tensor(0.0013, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [3/5], Loss: 0.0016, acc_loss, 0.0004, bias_loss:0.0013
-->batch_size 98
-->weights tensor([2.7273, 0.6122], device='cuda:2')
-->FUR:0.0, FU:0.0, P:43
-->FUR:0.0, FU:0.0, P:24
-->None
-->FUR:0.0, FU:0.0, P:3
-->None
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:15
-->FUR:0.0, FU:0.0, P:44
-->show_identity_num 6
-->z_score:-2.262918710708618, p_hat:0.00018011502106674016, n:98.0
-->bias_loss tensor(0.0013, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [3/5], Loss: 0.0020, acc_loss, 0.0007, bias_loss:0.0013
-->batch_size 98
-->weights tensor([2.0312, 0.6633], device='cuda:2')
-->FUR:0.0, FU:0.0, P:44
-->FUR:0.0, FU:0.0, P:25
-->FUR:0.0, FU:0.0, P:2
-->None
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:6
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:39
-->show_identity_num 7
-->z_score:-2.262918710708618, p_hat:0.00018011502106674016, n:98.0
-->bias_loss tensor(0.0013, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [3/5], Loss: 0.0013, acc_loss, 0.0000, bias_loss:0.0013
-->batch_size 98
-->weights tensor([2.2500, 0.6429], device='cuda:2')
-->FUR:0.0, FU:0.0, P:40
-->FUR:0.0, FU:0.0, P:22
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:6
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.0, FU:0.0, P:44
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss tensor(0.0013, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [3/5], Loss: 0.0040, acc_loss, 0.0028, bias_loss:0.0013
-->batch_size 98
-->weights tensor([3.5625, 0.5816], device='cuda:2')
-->FUR:0.0, FU:0.0, P:44
-->FUR:0.03125, FU:1.0, P:32
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.3333333432674408, FU:1.0, P:3
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:8
-->FUR:0.0, FU:0.0, P:14
-->FUR:0.0, FU:0.0, P:29
-->show_identity_num 8
-->z_score:-0.19699612259864807, p_hat:0.045662980526685715, n:98.0
-->bias_loss tensor(0.3191, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [3/5], Loss: 0.4252, acc_loss, 0.1061, bias_loss:0.3191
-->batch_size 98
-->weights tensor([2.6304, 0.6173], device='cuda:2')
-->FUR:0.0, FU:0.0, P:35
-->FUR:0.0, FU:0.0, P:22
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:9
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.0, FU:0.0, P:46
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss tensor(0.0013, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [3/5], Loss: 0.0013, acc_loss, 0.0000, bias_loss:0.0013
-->batch_size 98
-->weights tensor([1.9412, 0.6735], device='cuda:2')
-->FUR:0.0, FU:0.0, P:36
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:25
-->FUR:0.0, FU:0.0, P:41
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss tensor(0.0013, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [3/5], Loss: 0.0014, acc_loss, 0.0001, bias_loss:0.0013
-->batch_size 98
-->weights tensor([1.9412, 0.6735], device='cuda:2')
-->FUR:0.0, FU:0.0, P:37
-->FUR:0.0, FU:0.0, P:23
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:21
-->FUR:0.019607843831181526, FU:1.0, P:51
-->show_identity_num 8
-->z_score:-2.1556808948516846, p_hat:0.0025410379748791456, n:98.0
-->bias_loss tensor(0.0178, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [3/5], Loss: 0.0652, acc_loss, 0.0475, bias_loss:0.0178
-->batch_size 98
-->weights tensor([2.0806, 0.6582], device='cuda:2')
-->FUR:0.0, FU:0.0, P:30
-->FUR:0.0, FU:0.0, P:26
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:5
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:40
-->show_identity_num 8
-->z_score:-2.2639412879943848, p_hat:0.00015760063251946121, n:98.0
-->bias_loss tensor(0.0011, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [3/5], Loss: 0.0011, acc_loss, 0.0000, bias_loss:0.0011
-->batch_size 98
-->weights tensor([2.0312, 0.6633], device='cuda:2')
-->FUR:0.0, FU:0.0, P:34
-->FUR:0.0, FU:0.0, P:23
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.0, FU:0.0, P:49
-->show_identity_num 8
-->z_score:-2.2639412879943848, p_hat:0.00015760063251946121, n:98.0
-->bias_loss tensor(0.0011, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [3/5], Loss: 0.0011, acc_loss, 0.0000, bias_loss:0.0011
-->batch_size 98
-->weights tensor([2.3846, 0.6327], device='cuda:2')
-->FUR:0.0, FU:0.0, P:32
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:12
-->FUR:0.0, FU:0.0, P:18
-->FUR:0.0, FU:0.0, P:49
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss tensor(0.0013, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [3/5], Loss: 0.0013, acc_loss, 0.0001, bias_loss:0.0013
-->batch_size 98
-->weights tensor([3.4000, 0.5862], device='cuda:2')
-->FUR:0.0, FU:0.0, P:38
-->FUR:0.0, FU:0.0, P:19
-->None
-->None
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:8
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:36
-->show_identity_num 6
-->z_score:-2.2642822265625, p_hat:0.00015009584603831172, n:98.0
-->bias_loss tensor(0.0010, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [3/5], Loss: 0.1475, acc_loss, 0.1465, bias_loss:0.0010
-->after epoch 2
-->overall baseline on testing dataset
-->ACC 0.9314855185300529
-->F1 0.9614440939362074
-->FPR: 0.35584415584415585
-->FNR: 0.02937013446567587
testing dataset
-->original metric score:
-->identity male
-->length 292
-->ACC 0.910958904109589
-->F1 0.9473684210526316
-->FPR 0.30434782608695654
-->FNR 0.04878048780487805
-->positive probability:0.8493150684931506, 248/292
-->group-truth label positive probability:0.8424657534246576, 246/292
-->identity female
-->length 195
-->ACC 0.8666666666666667
-->F1 0.912751677852349
-->FPR 0.2826086956521739
-->FNR 0.087248322147651
-->positive probability:0.764102564102564, 149/195
-->group-truth label positive probability:0.764102564102564, 149/195
-->identity homosexual
-->length 14
-->ACC 1.0
-->F1 1.0
-->FPR 0.0
-->FNR 0.0
-->positive probability:0.6428571428571429, 9/14
-->group-truth label positive probability:0.6428571428571429, 9/14
-->identity christian
-->length 25
-->ACC 0.88
-->F1 0.9333333333333332
-->FPR 0.6666666666666666
-->FNR 0.045454545454545456
-->positive probability:0.92, 23/25
-->group-truth label positive probability:0.88, 22/25
-->identity muslim
-->length 13
-->ACC 0.7692307692307693
-->F1 0.823529411764706
-->FPR 0.4
-->FNR 0.125
-->positive probability:0.6923076923076923, 9/13
-->group-truth label positive probability:0.6153846153846154, 8/13
-->identity jewish
-->length 72
-->ACC 0.7638888888888888
-->F1 0.7605633802816902
-->FPR 0.3
-->FNR 0.15625
-->positive probability:0.5416666666666666, 39/72
-->group-truth label positive probability:0.4444444444444444, 32/72
-->identity black
-->length 157
-->ACC 0.7961783439490446
-->F1 0.8315789473684212
-->FPR 0.28125
-->FNR 0.15053763440860216
-->positive probability:0.6178343949044586, 97/157
-->group-truth label positive probability:0.5923566878980892, 93/157
-->identity white
-->length 381
-->ACC 0.868766404199475
-->F1 0.9163879598662208
-->FPR 0.3522727272727273
-->FNR 0.06484641638225255
-->positive probability:0.800524934383202, 305/381
-->group-truth label positive probability:0.7690288713910761, 293/381
-->fpr_diff [0.05149632975719931, 0.07323546019198196, 0.35584415584415585, 0.3108225108225108, 0.04415584415584417, 0.05584415584415586, 0.07459415584415585, 0.0035714285714285587]
-->fnr_diff [0.019410353339202182, 0.05787818768197514, 0.02937013446567587, 0.016084410988869587, 0.09562986553432413, 0.12687986553432412, 0.12116749994292629, 0.03547628191657669]
-->FPR:[0.30434782608695654, 0.2826086956521739, 0.0, 0.6666666666666666, 0.4, 0.3, 0.28125, 0.3522727272727273], mean FPR:0.3233932394598155, mean FPR metric:0.12119550512892904
-->FNR:[0.04878048780487805, 0.087248322147651, 0.0, 0.045454545454545456, 0.125, 0.15625, 0.15053763440860216, 0.06484641638225255], mean FNR:0.08476467577474114, mean FNR metric:0.06273707492548425
-->group metric: 0.06273707492548425
-->epoch 3
-->batch_size 98
-->weights tensor([2.3148, 0.6378], device='cuda:2')
-->FUR:0.0, FU:0.0, P:40
-->FUR:0.0, FU:0.0, P:26
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:4
-->None
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:13
-->FUR:0.0, FU:0.0, P:43
-->show_identity_num 7
-->z_score:-2.262918710708618, p_hat:0.00018011502106674016, n:98.0
-->bias_loss tensor(0.0013, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [4/5], Loss: 0.0013, acc_loss, 0.0000, bias_loss:0.0013
-->batch_size 98
-->weights tensor([1.9412, 0.6735], device='cuda:2')
-->FUR:0.0, FU:0.0, P:35
-->FUR:0.0, FU:0.0, P:26
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:3
-->None
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.0, FU:0.0, P:44
-->show_identity_num 7
-->z_score:-2.262918710708618, p_hat:0.00018011502106674016, n:98.0
-->bias_loss tensor(0.0013, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [4/5], Loss: 0.0062, acc_loss, 0.0050, bias_loss:0.0013
-->batch_size 98
-->weights tensor([2.7273, 0.6122], device='cuda:2')
-->FUR:0.03030303120613098, FU:1.0, P:33
-->FUR:0.0625, FU:1.0, P:16
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.28571173548698425, FU:1.9999821186065674, P:7
-->FUR:0.09090909361839294, FU:1.0, P:11
-->FUR:0.14000000059604645, FU:7.0, P:50
-->show_identity_num 8
-->z_score:1.185988187789917, p_hat:0.07611043751239777, n:98.0
-->bias_loss tensor(0.5318, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [4/5], Loss: 0.9215, acc_loss, 0.3897, bias_loss:0.5318
-->batch_size 98
-->weights tensor([2.4600, 0.6276], device='cuda:2')
-->FUR:0.0, FU:0.0, P:35
-->FUR:0.0, FU:0.0, P:32
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:11
-->FUR:0.0, FU:0.0, P:41
-->show_identity_num 8
-->z_score:-2.2639412879943848, p_hat:0.00015760063251946121, n:98.0
-->bias_loss tensor(0.0011, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [4/5], Loss: 0.0038, acc_loss, 0.0027, bias_loss:0.0011
-->batch_size 98
-->weights tensor([1.9848, 0.6684], device='cuda:2')
-->FUR:0.0, FU:0.0, P:25
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:8
-->FUR:0.0, FU:0.0, P:11
-->FUR:0.0, FU:0.0, P:48
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss tensor(0.0013, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [4/5], Loss: 0.0013, acc_loss, 0.0000, bias_loss:0.0013
-->batch_size 98
-->weights tensor([2.7273, 0.6122], device='cuda:2')
-->FUR:0.0, FU:0.0, P:43
-->FUR:0.0, FU:0.0, P:24
-->None
-->FUR:0.0, FU:0.0, P:3
-->None
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:15
-->FUR:0.0, FU:0.0, P:44
-->show_identity_num 6
-->z_score:-2.262918710708618, p_hat:0.00018011502106674016, n:98.0
-->bias_loss tensor(0.0013, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [4/5], Loss: 0.0013, acc_loss, 0.0000, bias_loss:0.0013
-->batch_size 98
-->weights tensor([2.0312, 0.6633], device='cuda:2')
-->FUR:0.0, FU:0.0, P:44
-->FUR:0.0, FU:0.0, P:25
-->FUR:0.0, FU:0.0, P:2
-->None
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:6
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:39
-->show_identity_num 7
-->z_score:-2.262918710708618, p_hat:0.00018011502106674016, n:98.0
-->bias_loss tensor(0.0013, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [4/5], Loss: 0.0013, acc_loss, 0.0000, bias_loss:0.0013
-->batch_size 98
-->weights tensor([2.2500, 0.6429], device='cuda:2')
-->FUR:0.0, FU:0.0, P:40
-->FUR:0.0, FU:0.0, P:22
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:6
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.0, FU:0.0, P:44
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss tensor(0.0013, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [4/5], Loss: 0.1193, acc_loss, 0.1181, bias_loss:0.0013
-->batch_size 98
-->weights tensor([3.5625, 0.5816], device='cuda:2')
-->FUR:0.0, FU:0.0, P:44
-->FUR:0.0, FU:0.0, P:32
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:8
-->FUR:0.0, FU:0.0, P:14
-->FUR:0.0, FU:0.0, P:29
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss tensor(0.0013, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [4/5], Loss: 0.0013, acc_loss, 0.0000, bias_loss:0.0013
-->batch_size 98
-->weights tensor([2.6304, 0.6173], device='cuda:2')
-->FUR:0.0, FU:0.0, P:35
-->FUR:0.0, FU:0.0, P:22
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:9
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.0, FU:0.0, P:46
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss tensor(0.0013, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [4/5], Loss: 0.0013, acc_loss, 0.0000, bias_loss:0.0013
-->batch_size 98
-->weights tensor([1.9412, 0.6735], device='cuda:2')
-->FUR:0.0, FU:0.0, P:36
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:25
-->FUR:0.024390242993831635, FU:1.0, P:41
-->show_identity_num 8
-->z_score:-2.1264824867248535, p_hat:0.0031838666182011366, n:98.0
-->bias_loss tensor(0.0222, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [4/5], Loss: 0.0489, acc_loss, 0.0266, bias_loss:0.0222
-->batch_size 98
-->weights tensor([1.9412, 0.6735], device='cuda:2')
-->FUR:0.0, FU:0.0, P:37
-->FUR:0.0, FU:0.0, P:23
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:21
-->FUR:0.019607843831181526, FU:1.0, P:51
-->show_identity_num 8
-->z_score:-2.1556808948516846, p_hat:0.0025410379748791456, n:98.0
-->bias_loss tensor(0.0178, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [4/5], Loss: 0.1005, acc_loss, 0.0827, bias_loss:0.0178
-->batch_size 98
-->weights tensor([2.0806, 0.6582], device='cuda:2')
-->FUR:0.0, FU:0.0, P:30
-->FUR:0.0, FU:0.0, P:26
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:5
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.02500000037252903, FU:1.0, P:40
-->show_identity_num 8
-->z_score:-2.1240429878234863, p_hat:0.0032375718001276255, n:98.0
-->bias_loss tensor(0.0226, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [4/5], Loss: 0.0353, acc_loss, 0.0126, bias_loss:0.0226
-->batch_size 98
-->weights tensor([2.0312, 0.6633], device='cuda:2')
-->FUR:0.0, FU:0.0, P:34
-->FUR:0.0, FU:0.0, P:23
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.05882352963089943, FU:1.0, P:17
-->FUR:0.0, FU:0.0, P:49
-->show_identity_num 8
-->z_score:-1.9320015907287598, p_hat:0.007465512957423925, n:98.0
-->bias_loss tensor(0.0522, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [4/5], Loss: 0.0628, acc_loss, 0.0106, bias_loss:0.0522
-->batch_size 98
-->weights tensor([2.3846, 0.6327], device='cuda:2')
-->FUR:0.0, FU:0.0, P:32
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:12
-->FUR:0.0, FU:0.0, P:18
-->FUR:0.0, FU:0.0, P:49
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss tensor(0.0013, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [4/5], Loss: 0.0013, acc_loss, 0.0000, bias_loss:0.0013
-->batch_size 98
-->weights tensor([3.4000, 0.5862], device='cuda:2')
-->FUR:0.0, FU:0.0, P:38
-->FUR:0.0, FU:0.0, P:19
-->None
-->None
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:8
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:36
-->show_identity_num 6
-->z_score:-2.2642822265625, p_hat:0.00015009584603831172, n:98.0
-->bias_loss tensor(0.0010, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [4/5], Loss: 0.0010, acc_loss, 0.0000, bias_loss:0.0010
-->after epoch 3
-->overall baseline on testing dataset
-->ACC 0.9286826533790097
-->F1 0.9604011758602802
-->FPR: 0.4675324675324675
-->FNR: 0.017338995046001414
testing dataset
-->original metric score:
-->identity male
-->length 292
-->ACC 0.9041095890410958
-->F1 0.9444444444444443
-->FPR 0.43478260869565216
-->FNR 0.032520325203252036
-->positive probability:0.8835616438356164, 258/292
-->group-truth label positive probability:0.8424657534246576, 246/292
-->identity female
-->length 195
-->ACC 0.8512820512820513
-->F1 0.9055374592833876
-->FPR 0.41304347826086957
-->FNR 0.06711409395973154
-->positive probability:0.8102564102564103, 158/195
-->group-truth label positive probability:0.764102564102564, 149/195
-->identity homosexual
-->length 14
-->ACC 0.9285714285714286
-->F1 0.9473684210526316
-->FPR 0.2
-->FNR 0.0
-->positive probability:0.7142857142857143, 10/14
-->group-truth label positive probability:0.6428571428571429, 9/14
-->identity christian
-->length 25
-->ACC 0.92
-->F1 0.9565217391304348
-->FPR 0.6666666666666666
-->FNR 0.0
-->positive probability:0.96, 24/25
-->group-truth label positive probability:0.88, 22/25
-->identity muslim
-->length 13
-->ACC 0.8461538461538461
-->F1 0.888888888888889
-->FPR 0.4
-->FNR 0.0
-->positive probability:0.7692307692307693, 10/13
-->group-truth label positive probability:0.6153846153846154, 8/13
-->identity jewish
-->length 72
-->ACC 0.7222222222222222
-->F1 0.7368421052631579
-->FPR 0.4
-->FNR 0.125
-->positive probability:0.6111111111111112, 44/72
-->group-truth label positive probability:0.4444444444444444, 32/72
-->identity black
-->length 157
-->ACC 0.7898089171974523
-->F1 0.8374384236453202
-->FPR 0.390625
-->FNR 0.08602150537634409
-->positive probability:0.7006369426751592, 110/157
-->group-truth label positive probability:0.5923566878980892, 93/157
-->identity white
-->length 381
-->ACC 0.8661417322834646
-->F1 0.9170731707317075
-->FPR 0.45454545454545453
-->FNR 0.03754266211604096
-->positive probability:0.8451443569553806, 322/381
-->group-truth label positive probability:0.7690288713910761, 293/381
-->fpr_diff [0.03274985883681536, 0.054488989271597954, 0.2675324675324675, 0.1991341991341991, 0.0675324675324675, 0.0675324675324675, 0.07690746753246752, 0.012987012987012991]
-->fnr_diff [0.015181330157250622, 0.04977509891373013, 0.017338995046001414, 0.017338995046001414, 0.017338995046001414, 0.10766100495399858, 0.06868251033034267, 0.020203667070039545]
-->FPR:[0.43478260869565216, 0.41304347826086957, 0.2, 0.6666666666666666, 0.4, 0.4, 0.390625, 0.45454545454545453], mean FPR:0.4199579010210804, mean FPR metric:0.09735811629493693
-->FNR:[0.032520325203252036, 0.06711409395973154, 0.0, 0.0, 0.0, 0.125, 0.08602150537634409, 0.03754266211604096], mean FNR:0.04352482333192108, mean FNR metric:0.03919007457042072
-->group metric: 0.03919007457042072
-->epoch 4
-->batch_size 98
-->weights tensor([2.3148, 0.6378], device='cuda:2')
-->FUR:0.0, FU:0.0, P:40
-->FUR:0.0, FU:0.0, P:26
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:4
-->None
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:13
-->FUR:0.0, FU:0.0, P:43
-->show_identity_num 7
-->z_score:-2.262918710708618, p_hat:0.00018011502106674016, n:98.0
-->bias_loss tensor(0.0013, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [5/5], Loss: 0.0013, acc_loss, 0.0000, bias_loss:0.0013
-->batch_size 98
-->weights tensor([1.9412, 0.6735], device='cuda:2')
-->FUR:0.0, FU:0.0, P:35
-->FUR:0.0, FU:0.0, P:26
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:3
-->None
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.0, FU:0.0, P:44
-->show_identity_num 7
-->z_score:-2.262918710708618, p_hat:0.00018011502106674016, n:98.0
-->bias_loss tensor(0.0013, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [5/5], Loss: 0.0013, acc_loss, 0.0000, bias_loss:0.0013
-->batch_size 98
-->weights tensor([2.7273, 0.6122], device='cuda:2')
-->FUR:0.0, FU:0.0, P:33
-->FUR:0.0, FU:0.0, P:16
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:11
-->FUR:0.0, FU:0.0, P:50
-->show_identity_num 8
-->z_score:-2.2639412879943848, p_hat:0.00015760063251946121, n:98.0
-->bias_loss tensor(0.0011, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [5/5], Loss: 1.5635, acc_loss, 1.5624, bias_loss:0.0011
-->batch_size 98
-->weights tensor([2.4600, 0.6276], device='cuda:2')
-->FUR:0.0, FU:0.0, P:35
-->FUR:0.0, FU:0.0, P:32
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:11
-->FUR:0.0, FU:0.0, P:41
-->show_identity_num 8
-->z_score:-2.2639412879943848, p_hat:0.00015760063251946121, n:98.0
-->bias_loss tensor(0.0011, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [5/5], Loss: 0.6760, acc_loss, 0.6749, bias_loss:0.0011
-->batch_size 98
-->weights tensor([1.9848, 0.6684], device='cuda:2')
-->FUR:0.0, FU:0.0, P:25
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:8
-->FUR:0.0, FU:0.0, P:11
-->FUR:0.0, FU:0.0, P:48
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss tensor(0.0013, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [5/5], Loss: 0.0118, acc_loss, 0.0106, bias_loss:0.0013
-->batch_size 98
-->weights tensor([2.7273, 0.6122], device='cuda:2')
-->FUR:0.0, FU:0.0, P:43
-->FUR:0.0, FU:0.0, P:24
-->None
-->FUR:0.0, FU:0.0, P:3
-->None
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:15
-->FUR:0.0, FU:0.0, P:44
-->show_identity_num 6
-->z_score:-2.262918710708618, p_hat:0.00018011502106674016, n:98.0
-->bias_loss tensor(0.0013, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [5/5], Loss: 0.0013, acc_loss, 0.0000, bias_loss:0.0013
-->batch_size 98
-->weights tensor([2.0312, 0.6633], device='cuda:2')
-->FUR:0.0, FU:0.0, P:44
-->FUR:0.0, FU:0.0, P:25
-->FUR:0.0, FU:0.0, P:2
-->None
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:6
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:39
-->show_identity_num 7
-->z_score:-2.262918710708618, p_hat:0.00018011502106674016, n:98.0
-->bias_loss tensor(0.0013, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [5/5], Loss: 0.0013, acc_loss, 0.0000, bias_loss:0.0013
-->batch_size 98
-->weights tensor([2.2500, 0.6429], device='cuda:2')
-->FUR:0.02463572658598423, FU:0.985429048538208, P:40
-->FUR:0.0, FU:0.0, P:22
-->FUR:0.25, FU:1.0, P:4
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:6
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.06818182021379471, FU:3.0, P:44
-->show_identity_num 8
-->z_score:-0.32262229919433594, p_hat:0.04289722442626953, n:98.0
-->bias_loss tensor(0.2997, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [5/5], Loss: 0.3531, acc_loss, 0.0534, bias_loss:0.2997
-->batch_size 98
-->weights tensor([3.5625, 0.5816], device='cuda:2')
-->FUR:0.0, FU:0.0, P:44
-->FUR:0.03125, FU:1.0, P:32
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.3333333432674408, FU:1.0, P:3
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:8
-->FUR:0.0714285746216774, FU:1.0, P:14
-->FUR:0.0, FU:0.0, P:29
-->show_identity_num 8
-->z_score:0.206511989235878, p_hat:0.05454652011394501, n:98.0
-->bias_loss tensor(0.3811, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [5/5], Loss: 0.4737, acc_loss, 0.0925, bias_loss:0.3811
-->batch_size 98
-->weights tensor([2.6304, 0.6173], device='cuda:2')
-->FUR:0.02857142873108387, FU:1.0, P:35
-->FUR:0.04545454680919647, FU:1.0, P:22
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:9
-->FUR:0.11760374158620834, FU:1.9992636442184448, P:17
-->FUR:0.0, FU:0.0, P:46
-->show_identity_num 8
-->z_score:-1.1810290813446045, p_hat:0.023998742923140526, n:98.0
-->bias_loss tensor(0.1677, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [5/5], Loss: 0.1779, acc_loss, 0.0102, bias_loss:0.1677
-->batch_size 98
-->weights tensor([1.9412, 0.6735], device='cuda:2')
-->FUR:0.0, FU:0.0, P:36
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:25
-->FUR:0.024390242993831635, FU:1.0, P:41
-->show_identity_num 8
-->z_score:-2.1264824867248535, p_hat:0.0031838666182011366, n:98.0
-->bias_loss tensor(0.0222, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [5/5], Loss: 0.1019, acc_loss, 0.0797, bias_loss:0.0222
-->batch_size 98
-->weights tensor([1.9412, 0.6735], device='cuda:2')
-->FUR:0.0, FU:0.0, P:37
-->FUR:0.0, FU:0.0, P:23
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:21
-->FUR:0.019607843831181526, FU:1.0, P:51
-->show_identity_num 8
-->z_score:-2.1556808948516846, p_hat:0.0025410379748791456, n:98.0
-->bias_loss tensor(0.0178, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [5/5], Loss: 0.0669, acc_loss, 0.0491, bias_loss:0.0178
-->batch_size 98
-->weights tensor([2.0806, 0.6582], device='cuda:2')
-->FUR:0.0, FU:0.0, P:30
-->FUR:0.0, FU:0.0, P:26
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:5
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:40
-->show_identity_num 8
-->z_score:-2.2639412879943848, p_hat:0.00015760063251946121, n:98.0
-->bias_loss tensor(0.0011, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [5/5], Loss: 0.0011, acc_loss, 0.0000, bias_loss:0.0011
-->batch_size 98
-->weights tensor([2.0312, 0.6633], device='cuda:2')
-->FUR:0.0, FU:0.0, P:34
-->FUR:0.0, FU:0.0, P:23
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.020408162847161293, FU:1.0, P:49
-->show_identity_num 8
-->z_score:-2.1501142978668213, p_hat:0.0026635921094566584, n:98.0
-->bias_loss tensor(0.0186, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [5/5], Loss: 0.2660, acc_loss, 0.2474, bias_loss:0.0186
-->batch_size 98
-->weights tensor([2.3846, 0.6327], device='cuda:2')
-->FUR:0.0, FU:0.0, P:32
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:12
-->FUR:0.0, FU:0.0, P:18
-->FUR:0.0, FU:0.0, P:49
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss tensor(0.0013, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [5/5], Loss: 0.0013, acc_loss, 0.0000, bias_loss:0.0013
-->batch_size 98
-->weights tensor([3.4000, 0.5862], device='cuda:2')
-->FUR:0.0, FU:0.0, P:38
-->FUR:0.0, FU:0.0, P:19
-->None
-->None
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:8
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:36
-->show_identity_num 6
-->z_score:-2.2642822265625, p_hat:0.00015009584603831172, n:98.0
-->bias_loss tensor(0.0010, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [5/5], Loss: 0.0010, acc_loss, 0.0000, bias_loss:0.0010
-->after epoch 4
-->overall baseline on testing dataset
-->ACC 0.9280597944565556
-->F1 0.9599861423869738
-->FPR: 0.45714285714285713
-->FNR: 0.019462137296532202
testing dataset
-->original metric score:
-->identity male
-->length 292
-->ACC 0.8972602739726028
-->F1 0.9404761904761905
-->FPR 0.45652173913043476
-->FNR 0.036585365853658534
-->positive probability:0.8835616438356164, 258/292
-->group-truth label positive probability:0.8424657534246576, 246/292
-->identity female
-->length 195
-->ACC 0.8564102564102564
-->F1 0.9084967320261438
-->FPR 0.391304347826087
-->FNR 0.06711409395973154
-->positive probability:0.8051282051282052, 157/195
-->group-truth label positive probability:0.764102564102564, 149/195
-->identity homosexual
-->length 14
-->ACC 0.9285714285714286
-->F1 0.9473684210526316
-->FPR 0.2
-->FNR 0.0
-->positive probability:0.7142857142857143, 10/14
-->group-truth label positive probability:0.6428571428571429, 9/14
-->identity christian
-->length 25
-->ACC 0.92
-->F1 0.9565217391304348
-->FPR 0.6666666666666666
-->FNR 0.0
-->positive probability:0.96, 24/25
-->group-truth label positive probability:0.88, 22/25
-->identity muslim
-->length 13
-->ACC 0.8461538461538461
-->F1 0.888888888888889
-->FPR 0.4
-->FNR 0.0
-->positive probability:0.7692307692307693, 10/13
-->group-truth label positive probability:0.6153846153846154, 8/13
-->identity jewish
-->length 72
-->ACC 0.7361111111111112
-->F1 0.7532467532467533
-->FPR 0.4
-->FNR 0.09375
-->positive probability:0.625, 45/72
-->group-truth label positive probability:0.4444444444444444, 32/72
-->identity black
-->length 157
-->ACC 0.7834394904458599
-->F1 0.8333333333333334
-->FPR 0.40625
-->FNR 0.08602150537634409
-->positive probability:0.7070063694267515, 111/157
-->group-truth label positive probability:0.5923566878980892, 93/157
-->identity white
-->length 381
-->ACC 0.863517060367454
-->F1 0.9153094462540716
-->FPR 0.45454545454545453
-->FNR 0.040955631399317405
-->positive probability:0.84251968503937, 321/381
-->group-truth label positive probability:0.7690288713910761, 293/381
-->fpr_diff [0.0006211180124223725, 0.06583850931677016, 0.2571428571428571, 0.2095238095238095, 0.057142857142857106, 0.057142857142857106, 0.05089285714285713, 0.0025974025974025983]
-->fnr_diff [0.017123228557126332, 0.04765195666319934, 0.019462137296532202, 0.019462137296532202, 0.019462137296532202, 0.0742878627034678, 0.06655936807981189, 0.021493494102785202]
-->FPR:[0.45652173913043476, 0.391304347826087, 0.2, 0.6666666666666666, 0.4, 0.4, 0.40625, 0.45454545454545453], mean FPR:0.4219110260210804, mean FPR metric:0.08761278350272914
-->FNR:[0.036585365853658534, 0.06711409395973154, 0.0, 0.0, 0.0, 0.09375, 0.08602150537634409, 0.040955631399317405], mean FNR:0.04055332457363145, mean FNR metric:0.03568779024949839
-->group metric: 0.03568779024949839
   test_acc   test_f1  ...  test_fnr_mean  test_fnr_metric
0  0.926503  0.958971  ...       0.055538         0.043507
1  0.929306  0.959816  ...       0.104765         0.074245
2  0.931486  0.961444  ...       0.084765         0.062737
3  0.928683  0.960401  ...       0.043525         0.039190
4  0.928060  0.959986  ...       0.040553         0.035688

[5 rows x 10 columns]
-->gamma 0.8
-->gamma 0.8
-->model AddedLayers(
  (model): Sequential(
    (0): Linear(in_features=4096, out_features=328, bias=True)
    (1): GELU(approximate='none')
    (2): Linear(in_features=328, out_features=4096, bias=True)
    (3): GELU(approximate='none')
    (4): Linear(in_features=4096, out_features=328, bias=True)
    (5): GELU(approximate='none')
    (6): Linear(in_features=328, out_features=4096, bias=True)
  )
)
-->classifier Linear(in_features=4096, out_features=2, bias=False)
-->MinValue:-2.271099895830676, MaxValue:2.2792810789854263
-->epoch 0
-->batch_size 98
-->weights tensor([2.3148, 0.6378], device='cuda:2')
-->FUR:0.0, FU:0.0, P:40
-->FUR:0.0, FU:0.0, P:26
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:4
-->None
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:13
-->FUR:0.0, FU:0.0, P:43
-->show_identity_num 7
-->z_score:-2.262918710708618, p_hat:0.00018011502106674016, n:98.0
-->bias_loss tensor(0.0014, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.3257, acc_loss, 0.3243, bias_loss:0.0014
-->batch_size 98
-->weights tensor([1.9412, 0.6735], device='cuda:2')
-->FUR:0.3142857253551483, FU:11.0, P:35
-->FUR:0.11328629404306412, FU:2.945443630218506, P:26
-->FUR:0.5, FU:1.0, P:2
-->FUR:0.3333333432674408, FU:1.0, P:3
-->None
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.1764705926179886, FU:3.0, P:17
-->FUR:0.20466011762619019, FU:9.005044937133789, P:44
-->show_identity_num 7
-->z_score:8.377994537353516, p_hat:0.23444795608520508, n:98.0
-->bias_loss tensor(0.8000, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 1.0536, acc_loss, 0.2536, bias_loss:0.8000
-->batch_size 98
-->weights tensor([2.7273, 0.6122], device='cuda:2')
-->FUR:0.0, FU:0.0, P:33
-->FUR:0.0, FU:0.0, P:16
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:11
-->FUR:0.0, FU:0.0, P:50
-->show_identity_num 8
-->z_score:-2.2639412879943848, p_hat:0.00015760063251946121, n:98.0
-->bias_loss tensor(0.0013, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 1.0629, acc_loss, 1.0616, bias_loss:0.0013
-->batch_size 98
-->weights tensor([2.4600, 0.6276], device='cuda:2')
-->FUR:0.0, FU:0.0, P:35
-->FUR:4.563480615615845e-06, FU:0.00014603137969970703, P:32
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:11
-->FUR:0.0, FU:0.0, P:41
-->show_identity_num 8
-->z_score:-2.263967514038086, p_hat:0.00015703019744250923, n:98.0
-->bias_loss tensor(0.0013, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.0146, acc_loss, 0.0134, bias_loss:0.0013
-->batch_size 98
-->weights tensor([1.9848, 0.6684], device='cuda:2')
-->FUR:0.11861718446016312, FU:2.9654295444488525, P:25
-->FUR:0.3111717700958252, FU:4.978748321533203, P:16
-->FUR:0.6666666865348816, FU:2.0, P:3
-->FUR:0.5, FU:1.0, P:2
-->FUR:0.4827273190021515, FU:0.965454638004303, P:2
-->FUR:0.5, FU:4.0, P:8
-->FUR:0.4514514207839966, FU:4.965965747833252, P:11
-->FUR:0.2287260890007019, FU:10.978852272033691, P:48
-->show_identity_num 8
-->z_score:16.226551055908203, p_hat:0.4072399139404297, n:98.0
-->bias_loss tensor(0.8000, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 1.2528, acc_loss, 0.4528, bias_loss:0.8000
-->batch_size 98
-->weights tensor([2.7273, 0.6122], device='cuda:2')
-->FUR:0.0, FU:0.0, P:43
-->FUR:0.0, FU:0.0, P:24
-->None
-->FUR:0.0, FU:0.0, P:3
-->None
-->FUR:0.19993692636489868, FU:0.9996846318244934, P:5
-->FUR:0.0, FU:0.0, P:15
-->FUR:0.04545454680919647, FU:2.0, P:44
-->show_identity_num 6
-->z_score:-0.41067755222320557, p_hat:0.040958620607852936, n:98.0
-->bias_loss tensor(0.3271, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.4919, acc_loss, 0.1649, bias_loss:0.3271
-->batch_size 98
-->weights tensor([2.0312, 0.6633], device='cuda:2')
-->FUR:0.022727273404598236, FU:1.0, P:44
-->FUR:0.0, FU:0.0, P:25
-->FUR:0.0, FU:0.0, P:2
-->None
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:6
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:39
-->show_identity_num 7
-->z_score:-2.1177821159362793, p_hat:0.00337540777400136, n:98.0
-->bias_loss tensor(0.0270, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.0398, acc_loss, 0.0129, bias_loss:0.0270
-->batch_size 98
-->weights tensor([2.2500, 0.6429], device='cuda:2')
-->FUR:0.0, FU:0.0, P:40
-->FUR:0.0, FU:0.0, P:22
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:6
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.0, FU:0.0, P:44
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss tensor(0.0014, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.0119, acc_loss, 0.0105, bias_loss:0.0014
-->batch_size 98
-->weights tensor([3.5625, 0.5816], device='cuda:2')
-->FUR:0.0, FU:0.0, P:44
-->FUR:0.03125, FU:1.0, P:32
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.3333333432674408, FU:1.0, P:3
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:8
-->FUR:0.0, FU:0.0, P:14
-->FUR:0.0, FU:0.0, P:29
-->show_identity_num 8
-->z_score:-0.19699612259864807, p_hat:0.045662980526685715, n:98.0
-->bias_loss tensor(0.3646, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.4376, acc_loss, 0.0730, bias_loss:0.3646
-->batch_size 98
-->weights tensor([2.6304, 0.6173], device='cuda:2')
-->FUR:0.0, FU:0.0, P:35
-->FUR:0.0, FU:0.0, P:22
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:9
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.0, FU:0.0, P:46
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss tensor(0.0014, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.0041, acc_loss, 0.0026, bias_loss:0.0014
-->batch_size 98
-->weights tensor([1.9412, 0.6735], device='cuda:2')
-->FUR:0.0, FU:0.0, P:36
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:25
-->FUR:0.0, FU:0.0, P:41
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss tensor(0.0014, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.0044, acc_loss, 0.0029, bias_loss:0.0014
-->batch_size 98
-->weights tensor([1.9412, 0.6735], device='cuda:2')
-->FUR:0.0, FU:0.0, P:37
-->FUR:0.0, FU:0.0, P:23
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:21
-->FUR:0.019607843831181526, FU:1.0, P:51
-->show_identity_num 8
-->z_score:-2.1556808948516846, p_hat:0.0025410379748791456, n:98.0
-->bias_loss tensor(0.0203, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.1172, acc_loss, 0.0969, bias_loss:0.0203
-->batch_size 98
-->weights tensor([2.0806, 0.6582], device='cuda:2')
-->FUR:0.0, FU:0.0, P:30
-->FUR:0.0, FU:0.0, P:26
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:5
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:40
-->show_identity_num 8
-->z_score:-2.2639412879943848, p_hat:0.00015760063251946121, n:98.0
-->bias_loss tensor(0.0013, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.0078, acc_loss, 0.0066, bias_loss:0.0013
-->batch_size 98
-->weights tensor([2.0312, 0.6633], device='cuda:2')
-->FUR:0.0, FU:0.0, P:34
-->FUR:0.0, FU:0.0, P:23
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.020408162847161293, FU:1.0, P:49
-->show_identity_num 8
-->z_score:-2.1501142978668213, p_hat:0.0026635921094566584, n:98.0
-->bias_loss tensor(0.0213, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.0480, acc_loss, 0.0267, bias_loss:0.0213
-->batch_size 98
-->weights tensor([2.3846, 0.6327], device='cuda:2')
-->FUR:0.09375, FU:3.0, P:32
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.3333333432674408, FU:1.0, P:3
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:12
-->FUR:0.0, FU:0.0, P:18
-->FUR:0.020408162847161293, FU:1.0, P:49
-->show_identity_num 8
-->z_score:0.27169036865234375, p_hat:0.05598147213459015, n:98.0
-->bias_loss tensor(0.4470, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.5312, acc_loss, 0.0841, bias_loss:0.4470
-->batch_size 98
-->weights tensor([3.4000, 0.5862], device='cuda:2')
-->FUR:0.0, FU:0.0, P:38
-->FUR:0.0, FU:0.0, P:19
-->None
-->None
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:8
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:36
-->show_identity_num 6
-->z_score:-2.2642822265625, p_hat:0.00015009584603831172, n:98.0
-->bias_loss tensor(0.0012, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.0036, acc_loss, 0.0024, bias_loss:0.0012
-->after epoch 0
-->overall baseline on testing dataset
-->ACC 0.9283712239177826
-->F1 0.9599303135888502
-->FPR: 0.412987012987013
-->FNR: 0.025123849964614295
testing dataset
-->original metric score:
-->identity male
-->length 292
-->ACC 0.910958904109589
-->F1 0.9475806451612904
-->FPR 0.32608695652173914
-->FNR 0.044715447154471545
-->positive probability:0.8561643835616438, 250/292
-->group-truth label positive probability:0.8424657534246576, 246/292
-->identity female
-->length 195
-->ACC 0.8666666666666667
-->F1 0.9139072847682119
-->FPR 0.32608695652173914
-->FNR 0.0738255033557047
-->positive probability:0.7846153846153846, 153/195
-->group-truth label positive probability:0.764102564102564, 149/195
-->identity homosexual
-->length 14
-->ACC 0.9285714285714286
-->F1 0.9473684210526316
-->FPR 0.2
-->FNR 0.0
-->positive probability:0.7142857142857143, 10/14
-->group-truth label positive probability:0.6428571428571429, 9/14
-->identity christian
-->length 25
-->ACC 0.88
-->F1 0.9333333333333332
-->FPR 0.6666666666666666
-->FNR 0.045454545454545456
-->positive probability:0.92, 23/25
-->group-truth label positive probability:0.88, 22/25
-->identity muslim
-->length 13
-->ACC 0.8461538461538461
-->F1 0.888888888888889
-->FPR 0.4
-->FNR 0.0
-->positive probability:0.7692307692307693, 10/13
-->group-truth label positive probability:0.6153846153846154, 8/13
-->identity jewish
-->length 72
-->ACC 0.7638888888888888
-->F1 0.767123287671233
-->FPR 0.325
-->FNR 0.125
-->positive probability:0.5694444444444444, 41/72
-->group-truth label positive probability:0.4444444444444444, 32/72
-->identity black
-->length 157
-->ACC 0.802547770700637
-->F1 0.841025641025641
-->FPR 0.3125
-->FNR 0.11827956989247312
-->positive probability:0.6496815286624203, 102/157
-->group-truth label positive probability:0.5923566878980892, 93/157
-->identity white
-->length 381
-->ACC 0.8713910761154856
-->F1 0.9192751235584844
-->FPR 0.3977272727272727
-->FNR 0.04778156996587031
-->positive probability:0.8241469816272966, 314/381
-->group-truth label positive probability:0.7690288713910761, 293/381
-->fpr_diff [0.08690005646527388, 0.08690005646527388, 0.212987012987013, 0.2536796536796536, 0.012987012987012991, 0.087987012987013, 0.10048701298701301, 0.015259740259740306]
-->fnr_diff [0.01959159718985725, 0.04870165339109041, 0.025123849964614295, 0.02033069548993116, 0.025123849964614295, 0.0998761500353857, 0.09315571992785883, 0.022657720001256015]
-->FPR:[0.32608695652173914, 0.32608695652173914, 0.2, 0.6666666666666666, 0.4, 0.325, 0.3125, 0.3977272727272727], mean FPR:0.3692584815546772, mean FPR metric:0.1071484448522492
-->FNR:[0.044715447154471545, 0.0738255033557047, 0.0, 0.045454545454545456, 0.0, 0.125, 0.11827956989247312, 0.04778156996587031], mean FNR:0.05688207947788314, mean FNR metric:0.044320154495576
-->group metric: 0.044320154495576
-->epoch 1
-->batch_size 98
-->weights tensor([2.3148, 0.6378], device='cuda:2')
-->FUR:0.0, FU:0.0, P:40
-->FUR:0.0, FU:0.0, P:26
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:4
-->None
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:13
-->FUR:0.0, FU:0.0, P:43
-->show_identity_num 7
-->z_score:-2.262918710708618, p_hat:0.00018011502106674016, n:98.0
-->bias_loss tensor(0.0014, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [2/5], Loss: 0.0023, acc_loss, 0.0009, bias_loss:0.0014
-->batch_size 98
-->weights tensor([1.9412, 0.6735], device='cuda:2')
-->FUR:0.0, FU:0.0, P:35
-->FUR:0.03846153989434242, FU:1.0, P:26
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:3
-->None
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.0, FU:0.0, P:44
-->show_identity_num 7
-->z_score:-2.0156848430633545, p_hat:0.005623158998787403, n:98.0
-->bias_loss tensor(0.0449, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [2/5], Loss: 0.0794, acc_loss, 0.0345, bias_loss:0.0449
-->batch_size 98
-->weights tensor([2.7273, 0.6122], device='cuda:2')
-->FUR:0.0, FU:0.0, P:33
-->FUR:0.0, FU:0.0, P:16
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:11
-->FUR:0.0, FU:0.0, P:50
-->show_identity_num 8
-->z_score:-2.2639412879943848, p_hat:0.00015760063251946121, n:98.0
-->bias_loss tensor(0.0013, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [2/5], Loss: 0.0021, acc_loss, 0.0009, bias_loss:0.0013
-->batch_size 98
-->weights tensor([2.4600, 0.6276], device='cuda:2')
-->FUR:0.007581789046525955, FU:0.26536262035369873, P:35
-->FUR:0.03125, FU:1.0, P:32
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:11
-->FUR:8.722630617796767e-09, FU:3.5762786865234375e-07, P:41
-->show_identity_num 8
-->z_score:-2.0475549697875977, p_hat:0.004921515006572008, n:98.0
-->bias_loss tensor(0.0393, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [2/5], Loss: 0.0880, acc_loss, 0.0487, bias_loss:0.0393
-->batch_size 98
-->weights tensor([1.9848, 0.6684], device='cuda:2')
-->FUR:0.0, FU:0.0, P:25
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:8
-->FUR:0.0, FU:0.0, P:11
-->FUR:0.0, FU:0.0, P:48
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss tensor(0.0014, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [2/5], Loss: 0.0256, acc_loss, 0.0242, bias_loss:0.0014
-->batch_size 98
-->weights tensor([2.7273, 0.6122], device='cuda:2')
-->FUR:0.0, FU:0.0, P:43
-->FUR:0.0, FU:0.0, P:24
-->None
-->FUR:0.0, FU:0.0, P:3
-->None
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:15
-->FUR:0.0, FU:0.0, P:44
-->show_identity_num 6
-->z_score:-2.262918710708618, p_hat:0.00018011502106674016, n:98.0
-->bias_loss tensor(0.0014, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [2/5], Loss: 0.2514, acc_loss, 0.2500, bias_loss:0.0014
-->batch_size 98
-->weights tensor([2.0312, 0.6633], device='cuda:2')
-->FUR:0.0, FU:0.0, P:44
-->FUR:0.0, FU:0.0, P:25
-->FUR:0.0, FU:0.0, P:2
-->None
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:6
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:39
-->show_identity_num 7
-->z_score:-2.262918710708618, p_hat:0.00018011502106674016, n:98.0
-->bias_loss tensor(0.0014, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [2/5], Loss: 0.0497, acc_loss, 0.0482, bias_loss:0.0014
-->batch_size 98
-->weights tensor([2.2500, 0.6429], device='cuda:2')
-->FUR:0.0, FU:0.0, P:40
-->FUR:0.0, FU:0.0, P:22
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:6
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.0, FU:0.0, P:44
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss tensor(0.0014, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [2/5], Loss: 0.1248, acc_loss, 0.1233, bias_loss:0.0014
-->batch_size 98
-->weights tensor([3.5625, 0.5816], device='cuda:2')
-->FUR:0.0669516995549202, FU:2.9458746910095215, P:44
-->FUR:0.15459585189819336, FU:4.9470672607421875, P:32
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.3333333432674408, FU:1.0, P:3
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0008684322237968445, FU:0.006947457790374756, P:8
-->FUR:0.17415039241313934, FU:2.438105583190918, P:14
-->FUR:0.22048315405845642, FU:6.394011497497559, P:29
-->show_identity_num 8
-->z_score:3.1208460330963135, p_hat:0.1187078058719635, n:98.0
-->bias_loss tensor(0.8000, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [2/5], Loss: 1.1488, acc_loss, 0.3488, bias_loss:0.8000
-->batch_size 98
-->weights tensor([2.6304, 0.6173], device='cuda:2')
-->FUR:0.0, FU:0.0, P:35
-->FUR:0.0, FU:0.0, P:22
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:9
-->FUR:0.05882352963089943, FU:1.0, P:17
-->FUR:0.0, FU:0.0, P:46
-->show_identity_num 8
-->z_score:-1.9309788942337036, p_hat:0.007488027680665255, n:98.0
-->bias_loss tensor(0.0598, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [2/5], Loss: 0.0811, acc_loss, 0.0213, bias_loss:0.0598
-->batch_size 98
-->weights tensor([1.9412, 0.6735], device='cuda:2')
-->FUR:0.0, FU:0.0, P:36
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:25
-->FUR:0.0, FU:0.0, P:41
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss tensor(0.0014, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [2/5], Loss: 0.0203, acc_loss, 0.0189, bias_loss:0.0014
-->batch_size 98
-->weights tensor([1.9412, 0.6735], device='cuda:2')
-->FUR:0.0, FU:0.0, P:37
-->FUR:0.0, FU:0.0, P:23
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:21
-->FUR:0.0, FU:0.0, P:51
-->show_identity_num 8
-->z_score:-2.2649641036987305, p_hat:0.0001350862585240975, n:98.0
-->bias_loss tensor(0.0011, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [2/5], Loss: 0.2644, acc_loss, 0.2633, bias_loss:0.0011
-->batch_size 98
-->weights tensor([2.0806, 0.6582], device='cuda:2')
-->FUR:0.0, FU:0.0, P:30
-->FUR:0.0, FU:0.0, P:26
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:5
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:40
-->show_identity_num 8
-->z_score:-2.2639412879943848, p_hat:0.00015760063251946121, n:98.0
-->bias_loss tensor(0.0013, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [2/5], Loss: 0.0013, acc_loss, 0.0000, bias_loss:0.0013
-->batch_size 98
-->weights tensor([2.0312, 0.6633], device='cuda:2')
-->FUR:0.0, FU:0.0, P:34
-->FUR:0.0, FU:0.0, P:23
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.0, FU:0.0, P:49
-->show_identity_num 8
-->z_score:-2.2639412879943848, p_hat:0.00015760063251946121, n:98.0
-->bias_loss tensor(0.0013, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [2/5], Loss: 0.0013, acc_loss, 0.0000, bias_loss:0.0013
-->batch_size 98
-->weights tensor([2.3846, 0.6327], device='cuda:2')
-->FUR:0.0, FU:0.0, P:32
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:12
-->FUR:0.0, FU:0.0, P:18
-->FUR:0.0, FU:0.0, P:49
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss tensor(0.0014, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [2/5], Loss: 0.0014, acc_loss, 0.0000, bias_loss:0.0014
-->batch_size 98
-->weights tensor([3.4000, 0.5862], device='cuda:2')
-->FUR:0.0, FU:0.0, P:38
-->FUR:0.0, FU:0.0, P:19
-->None
-->None
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:8
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:36
-->show_identity_num 6
-->z_score:-2.2642822265625, p_hat:0.00015009584603831172, n:98.0
-->bias_loss tensor(0.0012, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [2/5], Loss: 0.0012, acc_loss, 0.0000, bias_loss:0.0012
-->after epoch 1
-->overall baseline on testing dataset
-->ACC 0.9311740890688259
-->F1 0.9614243323442138
-->FPR: 0.38701298701298703
-->FNR: 0.025477707006369428
testing dataset
-->original metric score:
-->identity male
-->length 292
-->ACC 0.9178082191780822
-->F1 0.9518072289156626
-->FPR 0.32608695652173914
-->FNR 0.036585365853658534
-->positive probability:0.863013698630137, 252/292
-->group-truth label positive probability:0.8424657534246576, 246/292
-->identity female
-->length 195
-->ACC 0.8717948717948718
-->F1 0.9169435215946845
-->FPR 0.30434782608695654
-->FNR 0.0738255033557047
-->positive probability:0.7794871794871795, 152/195
-->group-truth label positive probability:0.764102564102564, 149/195
-->identity homosexual
-->length 14
-->ACC 0.9285714285714286
-->F1 0.9473684210526316
-->FPR 0.2
-->FNR 0.0
-->positive probability:0.7142857142857143, 10/14
-->group-truth label positive probability:0.6428571428571429, 9/14
-->identity christian
-->length 25
-->ACC 0.92
-->F1 0.9565217391304348
-->FPR 0.6666666666666666
-->FNR 0.0
-->positive probability:0.96, 24/25
-->group-truth label positive probability:0.88, 22/25
-->identity muslim
-->length 13
-->ACC 0.8461538461538461
-->F1 0.888888888888889
-->FPR 0.4
-->FNR 0.0
-->positive probability:0.7692307692307693, 10/13
-->group-truth label positive probability:0.6153846153846154, 8/13
-->identity jewish
-->length 72
-->ACC 0.75
-->F1 0.75
-->FPR 0.325
-->FNR 0.15625
-->positive probability:0.5555555555555556, 40/72
-->group-truth label positive probability:0.4444444444444444, 32/72
-->identity black
-->length 157
-->ACC 0.8089171974522293
-->F1 0.846938775510204
-->FPR 0.3125
-->FNR 0.10752688172043011
-->positive probability:0.6560509554140127, 103/157
-->group-truth label positive probability:0.5923566878980892, 93/157
-->identity white
-->length 381
-->ACC 0.8713910761154856
-->F1 0.9192751235584844
-->FPR 0.3977272727272727
-->FNR 0.04778156996587031
-->positive probability:0.8241469816272966, 314/381
-->group-truth label positive probability:0.7690288713910761, 293/381
-->fpr_diff [0.060926030491247896, 0.08266516092603049, 0.18701298701298702, 0.2796536796536796, 0.012987012987012991, 0.06201298701298702, 0.07451298701298703, 0.010714285714285676]
-->fnr_diff [0.011107658847289106, 0.048347796349335274, 0.025477707006369428, 0.025477707006369428, 0.025477707006369428, 0.13077229299363058, 0.08204917471406067, 0.022303862959500882]
-->FPR:[0.32608695652173914, 0.30434782608695654, 0.2, 0.6666666666666666, 0.4, 0.325, 0.3125, 0.3977272727272727], mean FPR:0.36654109025032944, mean FPR metric:0.09631064135140222
-->FNR:[0.036585365853658534, 0.0738255033557047, 0.0, 0.0, 0.0, 0.15625, 0.10752688172043011, 0.04778156996587031], mean FNR:0.052746165111957954, mean FNR metric:0.0463767383603656
-->group metric: 0.0463767383603656
-->epoch 2
-->batch_size 98
-->weights tensor([2.3148, 0.6378], device='cuda:2')
-->FUR:0.0, FU:0.0, P:40
-->FUR:0.0, FU:0.0, P:26
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:4
-->None
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:13
-->FUR:0.0, FU:0.0, P:43
-->show_identity_num 7
-->z_score:-2.262918710708618, p_hat:0.00018011502106674016, n:98.0
-->bias_loss tensor(0.0014, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [3/5], Loss: 0.0014, acc_loss, 0.0000, bias_loss:0.0014
-->batch_size 98
-->weights tensor([1.9412, 0.6735], device='cuda:2')
-->FUR:0.0, FU:0.0, P:35
-->FUR:0.0, FU:0.0, P:26
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:3
-->None
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.0, FU:0.0, P:44
-->show_identity_num 7
-->z_score:-2.262918710708618, p_hat:0.00018011502106674016, n:98.0
-->bias_loss tensor(0.0014, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [3/5], Loss: 0.2527, acc_loss, 0.2513, bias_loss:0.0014
-->batch_size 98
-->weights tensor([2.7273, 0.6122], device='cuda:2')
-->FUR:0.0, FU:0.0, P:33
-->FUR:0.0, FU:0.0, P:16
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:11
-->FUR:0.0, FU:0.0, P:50
-->show_identity_num 8
-->z_score:-2.2639412879943848, p_hat:0.00015760063251946121, n:98.0
-->bias_loss tensor(0.0013, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [3/5], Loss: 0.0013, acc_loss, 0.0000, bias_loss:0.0013
-->batch_size 98
-->weights tensor([2.4600, 0.6276], device='cuda:2')
-->FUR:0.0, FU:0.0, P:35
-->FUR:0.0, FU:0.0, P:32
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:11
-->FUR:0.0, FU:0.0, P:41
-->show_identity_num 8
-->z_score:-2.2639412879943848, p_hat:0.00015760063251946121, n:98.0
-->bias_loss tensor(0.0013, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [3/5], Loss: 0.0023, acc_loss, 0.0010, bias_loss:0.0013
-->batch_size 98
-->weights tensor([1.9848, 0.6684], device='cuda:2')
-->FUR:0.0, FU:0.0, P:25
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:8
-->FUR:0.0, FU:0.0, P:11
-->FUR:0.0, FU:0.0, P:48
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss tensor(0.0014, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [3/5], Loss: 0.0029, acc_loss, 0.0015, bias_loss:0.0014
-->batch_size 98
-->weights tensor([2.7273, 0.6122], device='cuda:2')
-->FUR:0.0, FU:0.0, P:43
-->FUR:0.0, FU:0.0, P:24
-->None
-->FUR:0.0, FU:0.0, P:3
-->None
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:15
-->FUR:0.022727273404598236, FU:1.0, P:44
-->show_identity_num 6
-->z_score:-2.093592882156372, p_hat:0.003907955717295408, n:98.0
-->bias_loss tensor(0.0312, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [3/5], Loss: 0.1423, acc_loss, 0.1111, bias_loss:0.0312
-->batch_size 98
-->weights tensor([2.0312, 0.6633], device='cuda:2')
-->FUR:0.0, FU:0.0, P:44
-->FUR:0.0, FU:0.0, P:25
-->FUR:0.0, FU:0.0, P:2
-->None
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:6
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:39
-->show_identity_num 7
-->z_score:-2.262918710708618, p_hat:0.00018011502106674016, n:98.0
-->bias_loss tensor(0.0014, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [3/5], Loss: 0.0023, acc_loss, 0.0008, bias_loss:0.0014
-->batch_size 98
-->weights tensor([2.2500, 0.6429], device='cuda:2')
-->FUR:0.05000000074505806, FU:2.0, P:40
-->FUR:0.0, FU:0.0, P:22
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:6
-->FUR:0.05714049190282822, FU:0.9713883399963379, P:17
-->FUR:0.09025905281305313, FU:3.97139835357666, P:44
-->show_identity_num 8
-->z_score:-1.1482694149017334, p_hat:0.024719972163438797, n:98.0
-->bias_loss tensor(0.1974, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [3/5], Loss: 0.3218, acc_loss, 0.1244, bias_loss:0.1974
-->batch_size 98
-->weights tensor([3.5625, 0.5816], device='cuda:2')
-->FUR:0.0, FU:0.0, P:44
-->FUR:0.03125, FU:1.0, P:32
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.3333333432674408, FU:1.0, P:3
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:8
-->FUR:0.0, FU:0.0, P:14
-->FUR:0.0, FU:0.0, P:29
-->show_identity_num 8
-->z_score:-0.19699612259864807, p_hat:0.045662980526685715, n:98.0
-->bias_loss tensor(0.3646, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [3/5], Loss: 0.4785, acc_loss, 0.1139, bias_loss:0.3646
-->batch_size 98
-->weights tensor([2.6304, 0.6173], device='cuda:2')
-->FUR:0.0, FU:0.0, P:35
-->FUR:0.0, FU:0.0, P:22
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:9
-->FUR:0.05882352963089943, FU:1.0, P:17
-->FUR:0.0, FU:0.0, P:46
-->show_identity_num 8
-->z_score:-1.9309788942337036, p_hat:0.007488027680665255, n:98.0
-->bias_loss tensor(0.0598, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [3/5], Loss: 2.3204, acc_loss, 2.2606, bias_loss:0.0598
-->batch_size 98
-->weights tensor([1.9412, 0.6735], device='cuda:2')
-->FUR:0.02777777798473835, FU:1.0, P:36
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.03999139741063118, FU:0.9997849464416504, P:25
-->FUR:0.0243849977850914, FU:0.9997849464416504, P:41
-->show_identity_num 8
-->z_score:-1.7458263635635376, p_hat:0.011564300395548344, n:98.0
-->bias_loss tensor(0.0923, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [3/5], Loss: 0.4775, acc_loss, 0.3852, bias_loss:0.0923
-->batch_size 98
-->weights tensor([1.9412, 0.6735], device='cuda:2')
-->FUR:0.0, FU:0.0, P:37
-->FUR:0.0, FU:0.0, P:23
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0476190485060215, FU:1.0, P:21
-->FUR:0.019607843831181526, FU:1.0, P:51
-->show_identity_num 8
-->z_score:-1.8873573541641235, p_hat:0.008448390290141106, n:98.0
-->bias_loss tensor(0.0675, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [3/5], Loss: 0.2320, acc_loss, 0.1646, bias_loss:0.0675
-->batch_size 98
-->weights tensor([2.0806, 0.6582], device='cuda:2')
-->FUR:0.06666667014360428, FU:2.0, P:30
-->FUR:0.0, FU:0.0, P:26
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:5
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.10000000149011612, FU:1.0, P:10
-->FUR:0.125, FU:5.0, P:40
-->show_identity_num 8
-->z_score:-0.6140668988227844, p_hat:0.036480847746133804, n:98.0
-->bias_loss tensor(0.2913, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [3/5], Loss: 1.1611, acc_loss, 0.8697, bias_loss:0.2913
-->batch_size 98
-->weights tensor([2.0312, 0.6633], device='cuda:2')
-->FUR:0.029411764815449715, FU:1.0, P:34
-->FUR:0.043478261679410934, FU:1.0, P:23
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.05882352963089943, FU:1.0, P:17
-->FUR:0.0, FU:0.0, P:49
-->show_identity_num 8
-->z_score:-1.5222406387329102, p_hat:0.01648670993745327, n:98.0
-->bias_loss tensor(0.1317, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [3/5], Loss: 0.4380, acc_loss, 0.3064, bias_loss:0.1317
-->batch_size 98
-->weights tensor([2.3846, 0.6327], device='cuda:2')
-->FUR:0.03125, FU:1.0, P:32
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.3333333432674408, FU:1.0, P:3
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:12
-->FUR:0.0, FU:0.0, P:18
-->FUR:0.020408162847161293, FU:1.0, P:49
-->show_identity_num 8
-->z_score:-0.08316897600889206, p_hat:0.04816897213459015, n:98.0
-->bias_loss tensor(0.3847, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [3/5], Loss: 0.5935, acc_loss, 0.2089, bias_loss:0.3847
-->batch_size 98
-->weights tensor([3.4000, 0.5862], device='cuda:2')
-->FUR:0.0, FU:0.0, P:38
-->FUR:0.0, FU:0.0, P:19
-->None
-->None
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:8
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:36
-->show_identity_num 6
-->z_score:-2.2642822265625, p_hat:0.00015009584603831172, n:98.0
-->bias_loss tensor(0.0012, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [3/5], Loss: 0.0012, acc_loss, 0.0000, bias_loss:0.0012
-->after epoch 2
-->overall baseline on testing dataset
-->ACC 0.9243226409218313
-->F1 0.9565528338995172
-->FPR: 0.23896103896103896
-->FNR: 0.05343241330502477
testing dataset
-->original metric score:
-->identity male
-->length 292
-->ACC 0.9041095890410958
-->F1 0.9416666666666668
-->FPR 0.17391304347826086
-->FNR 0.08130081300813008
-->positive probability:0.8013698630136986, 234/292
-->group-truth label positive probability:0.8424657534246576, 246/292
-->identity female
-->length 195
-->ACC 0.8974358974358975
-->F1 0.93006993006993
-->FPR 0.08695652173913043
-->FNR 0.10738255033557047
-->positive probability:0.7025641025641025, 137/195
-->group-truth label positive probability:0.764102564102564, 149/195
-->identity homosexual
-->length 14
-->ACC 0.9285714285714286
-->F1 0.9411764705882353
-->FPR 0.0
-->FNR 0.1111111111111111
-->positive probability:0.5714285714285714, 8/14
-->group-truth label positive probability:0.6428571428571429, 9/14
-->identity christian
-->length 25
-->ACC 0.88
-->F1 0.9302325581395349
-->FPR 0.3333333333333333
-->FNR 0.09090909090909091
-->positive probability:0.84, 21/25
-->group-truth label positive probability:0.88, 22/25
-->identity muslim
-->length 13
-->ACC 0.7692307692307693
-->F1 0.7999999999999999
-->FPR 0.2
-->FNR 0.25
-->positive probability:0.5384615384615384, 7/13
-->group-truth label positive probability:0.6153846153846154, 8/13
-->identity jewish
-->length 72
-->ACC 0.7638888888888888
-->F1 0.711864406779661
-->FPR 0.15
-->FNR 0.34375
-->positive probability:0.375, 27/72
-->group-truth label positive probability:0.4444444444444444, 32/72
-->identity black
-->length 157
-->ACC 0.7961783439490446
-->F1 0.8222222222222222
-->FPR 0.203125
-->FNR 0.20430107526881722
-->positive probability:0.554140127388535, 87/157
-->group-truth label positive probability:0.5923566878980892, 93/157
-->identity white
-->length 381
-->ACC 0.8530183727034121
-->F1 0.9014084507042254
-->FPR 0.2159090909090909
-->FNR 0.12627986348122866
-->positive probability:0.7217847769028871, 275/381
-->group-truth label positive probability:0.7690288713910761, 293/381
-->fpr_diff [0.06504799548277809, 0.15200451722190852, 0.23896103896103896, 0.09437229437229436, 0.038961038961038946, 0.08896103896103896, 0.03583603896103896, 0.023051948051948046]
-->fnr_diff [0.027868399703105312, 0.0539501370305457, 0.05767869780608634, 0.037476677604066144, 0.19656758669497523, 0.2903175866949752, 0.15086866196379245, 0.07284745017620389]
-->FPR:[0.17391304347826086, 0.08695652173913043, 0.0, 0.3333333333333333, 0.2, 0.15, 0.203125, 0.2159090909090909], mean FPR:0.17040462368247694, mean FPR metric:0.09214948887163561
-->FNR:[0.08130081300813008, 0.10738255033557047, 0.1111111111111111, 0.09090909090909091, 0.25, 0.34375, 0.20430107526881722, 0.12627986348122866], mean FNR:0.16437931301424358, mean FNR metric:0.11094689970921878
-->group metric: 0.11094689970921878
-->epoch 3
-->batch_size 98
-->weights tensor([2.3148, 0.6378], device='cuda:2')
-->FUR:0.0, FU:0.0, P:40
-->FUR:0.03846153989434242, FU:1.0, P:26
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.25, FU:1.0, P:4
-->None
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:13
-->FUR:0.0, FU:0.0, P:43
-->show_identity_num 7
-->z_score:-0.3958078622817993, p_hat:0.04128598794341087, n:98.0
-->bias_loss tensor(0.3297, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [4/5], Loss: 0.3338, acc_loss, 0.0041, bias_loss:0.3297
-->batch_size 98
-->weights tensor([1.9412, 0.6735], device='cuda:2')
-->FUR:0.0, FU:0.0, P:35
-->FUR:0.0, FU:0.0, P:26
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:3
-->None
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.0, FU:0.0, P:44
-->show_identity_num 7
-->z_score:-2.262918710708618, p_hat:0.00018011502106674016, n:98.0
-->bias_loss tensor(0.0014, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [4/5], Loss: 0.0014, acc_loss, 0.0000, bias_loss:0.0014
-->batch_size 98
-->weights tensor([2.7273, 0.6122], device='cuda:2')
-->FUR:0.0, FU:0.0, P:33
-->FUR:0.0, FU:0.0, P:16
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:11
-->FUR:0.0, FU:0.0, P:50
-->show_identity_num 8
-->z_score:-2.2639412879943848, p_hat:0.00015760063251946121, n:98.0
-->bias_loss tensor(0.0013, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [4/5], Loss: 0.0013, acc_loss, 0.0000, bias_loss:0.0013
-->batch_size 98
-->weights tensor([2.4600, 0.6276], device='cuda:2')
-->FUR:0.0, FU:0.0, P:35
-->FUR:0.0, FU:0.0, P:32
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:11
-->FUR:0.0, FU:0.0, P:41
-->show_identity_num 8
-->z_score:-2.2639412879943848, p_hat:0.00015760063251946121, n:98.0
-->bias_loss tensor(0.0013, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [4/5], Loss: 0.0013, acc_loss, 0.0000, bias_loss:0.0013
-->batch_size 98
-->weights tensor([1.9848, 0.6684], device='cuda:2')
-->FUR:0.0, FU:0.0, P:25
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:8
-->FUR:0.0, FU:0.0, P:11
-->FUR:0.0, FU:0.0, P:48
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss tensor(0.0014, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [4/5], Loss: 0.0358, acc_loss, 0.0344, bias_loss:0.0014
-->batch_size 98
-->weights tensor([2.7273, 0.6122], device='cuda:2')
-->FUR:0.0, FU:0.0, P:43
-->FUR:0.0, FU:0.0, P:24
-->None
-->FUR:0.0, FU:0.0, P:3
-->None
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:15
-->FUR:0.0, FU:0.0, P:44
-->show_identity_num 6
-->z_score:-2.262918710708618, p_hat:0.00018011502106674016, n:98.0
-->bias_loss tensor(0.0014, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [4/5], Loss: 0.0014, acc_loss, 0.0000, bias_loss:0.0014
-->batch_size 98
-->weights tensor([2.0312, 0.6633], device='cuda:2')
-->FUR:0.0, FU:0.0, P:44
-->FUR:0.0, FU:0.0, P:25
-->FUR:0.0, FU:0.0, P:2
-->None
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:6
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:39
-->show_identity_num 7
-->z_score:-2.262918710708618, p_hat:0.00018011502106674016, n:98.0
-->bias_loss tensor(0.0014, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [4/5], Loss: 0.0014, acc_loss, 0.0000, bias_loss:0.0014
-->batch_size 98
-->weights tensor([2.2500, 0.6429], device='cuda:2')
-->FUR:0.0, FU:0.0, P:40
-->FUR:0.0, FU:0.0, P:22
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:6
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.0, FU:0.0, P:44
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss tensor(0.0014, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [4/5], Loss: 0.0014, acc_loss, 0.0000, bias_loss:0.0014
-->batch_size 98
-->weights tensor([3.5625, 0.5816], device='cuda:2')
-->FUR:0.022727273404598236, FU:1.0, P:44
-->FUR:0.03125, FU:1.0, P:32
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.3333333432674408, FU:1.0, P:3
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:8
-->FUR:0.0, FU:0.0, P:14
-->FUR:0.0, FU:0.0, P:29
-->show_identity_num 8
-->z_score:-0.07000172138214111, p_hat:0.04845885932445526, n:98.0
-->bias_loss tensor(0.3870, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [4/5], Loss: 0.5621, acc_loss, 0.1752, bias_loss:0.3870
-->batch_size 98
-->weights tensor([2.6304, 0.6173], device='cuda:2')
-->FUR:0.0, FU:0.0, P:35
-->FUR:0.0, FU:0.0, P:22
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:9
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.0, FU:0.0, P:46
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss tensor(0.0014, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [4/5], Loss: 0.0014, acc_loss, 0.0000, bias_loss:0.0014
-->batch_size 98
-->weights tensor([1.9412, 0.6735], device='cuda:2')
-->FUR:0.0, FU:0.0, P:36
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:25
-->FUR:0.024390242993831635, FU:1.0, P:41
-->show_identity_num 8
-->z_score:-2.1264824867248535, p_hat:0.0031838666182011366, n:98.0
-->bias_loss tensor(0.0254, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [4/5], Loss: 0.2890, acc_loss, 0.2635, bias_loss:0.0254
-->batch_size 98
-->weights tensor([1.9412, 0.6735], device='cuda:2')
-->FUR:0.0, FU:0.0, P:37
-->FUR:0.0, FU:0.0, P:23
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:21
-->FUR:0.019607843831181526, FU:1.0, P:51
-->show_identity_num 8
-->z_score:-2.1556808948516846, p_hat:0.0025410379748791456, n:98.0
-->bias_loss tensor(0.0203, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [4/5], Loss: 0.1336, acc_loss, 0.1133, bias_loss:0.0203
-->batch_size 98
-->weights tensor([2.0806, 0.6582], device='cuda:2')
-->FUR:0.0, FU:0.0, P:30
-->FUR:0.0, FU:0.0, P:26
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:5
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.02500000037252903, FU:1.0, P:40
-->show_identity_num 8
-->z_score:-2.1240429878234863, p_hat:0.0032375718001276255, n:98.0
-->bias_loss tensor(0.0259, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [4/5], Loss: 0.0649, acc_loss, 0.0390, bias_loss:0.0259
-->batch_size 98
-->weights tensor([2.0312, 0.6633], device='cuda:2')
-->FUR:0.0, FU:0.0, P:34
-->FUR:0.0, FU:0.0, P:23
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.020408162847161293, FU:1.0, P:49
-->show_identity_num 8
-->z_score:-2.1501142978668213, p_hat:0.0026635921094566584, n:98.0
-->bias_loss tensor(0.0213, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [4/5], Loss: 0.1724, acc_loss, 0.1511, bias_loss:0.0213
-->batch_size 98
-->weights tensor([2.3846, 0.6327], device='cuda:2')
-->FUR:0.0, FU:0.0, P:32
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:12
-->FUR:0.0, FU:0.0, P:18
-->FUR:0.0, FU:0.0, P:49
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss tensor(0.0014, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [4/5], Loss: 0.0014, acc_loss, 0.0000, bias_loss:0.0014
-->batch_size 98
-->weights tensor([3.4000, 0.5862], device='cuda:2')
-->FUR:0.0, FU:0.0, P:38
-->FUR:0.0, FU:0.0, P:19
-->None
-->None
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:8
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:36
-->show_identity_num 6
-->z_score:-2.2642822265625, p_hat:0.00015009584603831172, n:98.0
-->bias_loss tensor(0.0012, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [4/5], Loss: 0.0012, acc_loss, 0.0000, bias_loss:0.0012
-->after epoch 3
-->overall baseline on testing dataset
-->ACC 0.9308626596075988
-->F1 0.9610389610389611
-->FPR: 0.34805194805194806
-->FNR: 0.03113941967445152
testing dataset
-->original metric score:
-->identity male
-->length 292
-->ACC 0.9143835616438356
-->F1 0.949290060851927
-->FPR 0.2826086956521739
-->FNR 0.04878048780487805
-->positive probability:0.8458904109589042, 247/292
-->group-truth label positive probability:0.8424657534246576, 246/292
-->identity female
-->length 195
-->ACC 0.8974358974358975
-->F1 0.9319727891156463
-->FPR 0.17391304347826086
-->FNR 0.08053691275167785
-->positive probability:0.7435897435897436, 145/195
-->group-truth label positive probability:0.764102564102564, 149/195
-->identity homosexual
-->length 14
-->ACC 0.9285714285714286
-->F1 0.9473684210526316
-->FPR 0.2
-->FNR 0.0
-->positive probability:0.7142857142857143, 10/14
-->group-truth label positive probability:0.6428571428571429, 9/14
-->identity christian
-->length 25
-->ACC 0.88
-->F1 0.9302325581395349
-->FPR 0.3333333333333333
-->FNR 0.09090909090909091
-->positive probability:0.84, 21/25
-->group-truth label positive probability:0.88, 22/25
-->identity muslim
-->length 13
-->ACC 0.7692307692307693
-->F1 0.823529411764706
-->FPR 0.4
-->FNR 0.125
-->positive probability:0.6923076923076923, 9/13
-->group-truth label positive probability:0.6153846153846154, 8/13
-->identity jewish
-->length 72
-->ACC 0.75
-->F1 0.75
-->FPR 0.325
-->FNR 0.15625
-->positive probability:0.5555555555555556, 40/72
-->group-truth label positive probability:0.4444444444444444, 32/72
-->identity black
-->length 157
-->ACC 0.8152866242038217
-->F1 0.8465608465608465
-->FPR 0.25
-->FNR 0.13978494623655913
-->positive probability:0.6114649681528662, 96/157
-->group-truth label positive probability:0.5923566878980892, 93/157
-->identity white
-->length 381
-->ACC 0.8661417322834646
-->F1 0.9142857142857144
-->FPR 0.3409090909090909
-->FNR 0.07167235494880546
-->positive probability:0.7926509186351706, 302/381
-->group-truth label positive probability:0.7690288713910761, 293/381
-->fpr_diff [0.06544325239977417, 0.1741389045736872, 0.14805194805194805, 0.014718614718614742, 0.051948051948051965, 0.023051948051948046, 0.09805194805194806, 0.007142857142857173]
-->fnr_diff [0.01764106813042653, 0.04939749307722632, 0.03113941967445152, 0.05976967123463939, 0.09386058032554848, 0.12511058032554848, 0.1086455265621076, 0.040532935274353935]
-->FPR:[0.2826086956521739, 0.17391304347826086, 0.2, 0.3333333333333333, 0.4, 0.325, 0.25, 0.3409090909090909], mean FPR:0.2882205204216074, mean FPR metric:0.07281844061735368
-->FNR:[0.04878048780487805, 0.08053691275167785, 0.0, 0.09090909090909091, 0.125, 0.15625, 0.13978494623655913, 0.07167235494880546], mean FNR:0.08911672408137643, mean FNR metric:0.06576215932553778
-->group metric: 0.06576215932553778
-->epoch 4
-->batch_size 98
-->weights tensor([2.3148, 0.6378], device='cuda:2')
-->FUR:0.0, FU:0.0, P:40
-->FUR:0.0, FU:0.0, P:26
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:4
-->None
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:13
-->FUR:0.0, FU:0.0, P:43
-->show_identity_num 7
-->z_score:-2.262918710708618, p_hat:0.00018011502106674016, n:98.0
-->bias_loss tensor(0.0014, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [5/5], Loss: 0.0014, acc_loss, 0.0000, bias_loss:0.0014
-->batch_size 98
-->weights tensor([1.9412, 0.6735], device='cuda:2')
-->FUR:0.0, FU:0.0, P:35
-->FUR:0.0, FU:0.0, P:26
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:3
-->None
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.022727273404598236, FU:1.0, P:44
-->show_identity_num 7
-->z_score:-2.1177821159362793, p_hat:0.0033754068426787853, n:98.0
-->bias_loss tensor(0.0270, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [5/5], Loss: 0.1026, acc_loss, 0.0757, bias_loss:0.0270
-->batch_size 98
-->weights tensor([2.7273, 0.6122], device='cuda:2')
-->FUR:0.0, FU:0.0, P:33
-->FUR:0.0, FU:0.0, P:16
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:11
-->FUR:0.0, FU:0.0, P:50
-->show_identity_num 8
-->z_score:-2.2639412879943848, p_hat:0.00015760063251946121, n:98.0
-->bias_loss tensor(0.0013, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [5/5], Loss: 0.0013, acc_loss, 0.0000, bias_loss:0.0013
-->batch_size 98
-->weights tensor([2.4600, 0.6276], device='cuda:2')
-->FUR:0.0, FU:0.0, P:35
-->FUR:0.0, FU:0.0, P:32
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:11
-->FUR:0.0, FU:0.0, P:41
-->show_identity_num 8
-->z_score:-2.2639412879943848, p_hat:0.00015760063251946121, n:98.0
-->bias_loss tensor(0.0013, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [5/5], Loss: 0.0013, acc_loss, 0.0000, bias_loss:0.0013
-->batch_size 98
-->weights tensor([1.9848, 0.6684], device='cuda:2')
-->FUR:0.0, FU:0.0, P:25
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:8
-->FUR:0.0, FU:0.0, P:11
-->FUR:0.0, FU:0.0, P:48
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss tensor(0.0014, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [5/5], Loss: 0.0014, acc_loss, 0.0000, bias_loss:0.0014
-->batch_size 98
-->weights tensor([2.7273, 0.6122], device='cuda:2')
-->FUR:0.0, FU:0.0, P:43
-->FUR:0.0, FU:0.0, P:24
-->None
-->FUR:0.0, FU:0.0, P:3
-->None
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:15
-->FUR:0.0, FU:0.0, P:44
-->show_identity_num 6
-->z_score:-2.262918710708618, p_hat:0.00018011502106674016, n:98.0
-->bias_loss tensor(0.0014, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [5/5], Loss: 0.0014, acc_loss, 0.0000, bias_loss:0.0014
-->batch_size 98
-->weights tensor([2.0312, 0.6633], device='cuda:2')
-->FUR:0.0, FU:0.0, P:44
-->FUR:0.0, FU:0.0, P:25
-->FUR:0.0, FU:0.0, P:2
-->None
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:6
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:39
-->show_identity_num 7
-->z_score:-2.262918710708618, p_hat:0.00018011502106674016, n:98.0
-->bias_loss tensor(0.0014, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [5/5], Loss: 0.0014, acc_loss, 0.0000, bias_loss:0.0014
-->batch_size 98
-->weights tensor([2.2500, 0.6429], device='cuda:2')
-->FUR:0.0, FU:0.0, P:40
-->FUR:0.0, FU:0.0, P:22
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:6
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.0, FU:0.0, P:44
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss tensor(0.0014, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [5/5], Loss: 0.0016, acc_loss, 0.0001, bias_loss:0.0014
-->batch_size 98
-->weights tensor([3.5625, 0.5816], device='cuda:2')
-->FUR:0.0, FU:0.0, P:44
-->FUR:0.0, FU:0.0, P:32
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:8
-->FUR:0.0, FU:0.0, P:14
-->FUR:0.0, FU:0.0, P:29
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss tensor(0.0014, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [5/5], Loss: 0.0014, acc_loss, 0.0000, bias_loss:0.0014
-->batch_size 98
-->weights tensor([2.6304, 0.6173], device='cuda:2')
-->FUR:0.0, FU:0.0, P:35
-->FUR:0.0, FU:0.0, P:22
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:9
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.0, FU:0.0, P:46
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss tensor(0.0014, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [5/5], Loss: 0.0014, acc_loss, 0.0000, bias_loss:0.0014
-->batch_size 98
-->weights tensor([1.9412, 0.6735], device='cuda:2')
-->FUR:0.0, FU:0.0, P:36
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:25
-->FUR:0.0, FU:0.0, P:41
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss tensor(0.0014, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [5/5], Loss: 0.0015, acc_loss, 0.0000, bias_loss:0.0014
-->batch_size 98
-->weights tensor([1.9412, 0.6735], device='cuda:2')
-->FUR:0.0, FU:0.0, P:37
-->FUR:0.0, FU:0.0, P:23
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:21
-->FUR:0.019607843831181526, FU:1.0, P:51
-->show_identity_num 8
-->z_score:-2.1556808948516846, p_hat:0.0025410379748791456, n:98.0
-->bias_loss tensor(0.0203, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [5/5], Loss: 0.2121, acc_loss, 0.1918, bias_loss:0.0203
-->batch_size 98
-->weights tensor([2.0806, 0.6582], device='cuda:2')
-->FUR:0.0, FU:0.0, P:30
-->FUR:0.0, FU:0.0, P:26
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:5
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.02500000037252903, FU:1.0, P:40
-->show_identity_num 8
-->z_score:-2.1240429878234863, p_hat:0.0032375718001276255, n:98.0
-->bias_loss tensor(0.0259, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [5/5], Loss: 0.0786, acc_loss, 0.0528, bias_loss:0.0259
-->batch_size 98
-->weights tensor([2.0312, 0.6633], device='cuda:2')
-->FUR:0.0, FU:0.0, P:34
-->FUR:0.0, FU:0.0, P:23
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.05882352963089943, FU:1.0, P:17
-->FUR:0.0, FU:0.0, P:49
-->show_identity_num 8
-->z_score:-1.9320015907287598, p_hat:0.007465512957423925, n:98.0
-->bias_loss tensor(0.0596, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [5/5], Loss: 0.1079, acc_loss, 0.0483, bias_loss:0.0596
-->batch_size 98
-->weights tensor([2.3846, 0.6327], device='cuda:2')
-->FUR:0.0, FU:0.0, P:32
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:12
-->FUR:0.0, FU:0.0, P:18
-->FUR:0.0, FU:0.0, P:49
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss tensor(0.0014, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [5/5], Loss: 0.0014, acc_loss, 0.0000, bias_loss:0.0014
-->batch_size 98
-->weights tensor([3.4000, 0.5862], device='cuda:2')
-->FUR:0.0, FU:0.0, P:38
-->FUR:0.0, FU:0.0, P:19
-->None
-->None
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:8
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:36
-->show_identity_num 6
-->z_score:-2.2642822265625, p_hat:0.00015009584603831172, n:98.0
-->bias_loss tensor(0.0012, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [5/5], Loss: 0.0012, acc_loss, 0.0000, bias_loss:0.0012
-->after epoch 4
-->overall baseline on testing dataset
-->ACC 0.9308626596075988
-->F1 0.9608189198729263
-->FPR: 0.3064935064935065
-->FNR: 0.03680113234253362
testing dataset
-->original metric score:
-->identity male
-->length 292
-->ACC 0.9143835616438356
-->F1 0.9490835030549898
-->FPR 0.2608695652173913
-->FNR 0.052845528455284556
-->positive probability:0.839041095890411, 245/292
-->group-truth label positive probability:0.8424657534246576, 246/292
-->identity female
-->length 195
-->ACC 0.8923076923076924
-->F1 0.9283276450511946
-->FPR 0.17391304347826086
-->FNR 0.087248322147651
-->positive probability:0.7384615384615385, 144/195
-->group-truth label positive probability:0.764102564102564, 149/195
-->identity homosexual
-->length 14
-->ACC 1.0
-->F1 1.0
-->FPR 0.0
-->FNR 0.0
-->positive probability:0.6428571428571429, 9/14
-->group-truth label positive probability:0.6428571428571429, 9/14
-->identity christian
-->length 25
-->ACC 0.88
-->F1 0.9302325581395349
-->FPR 0.3333333333333333
-->FNR 0.09090909090909091
-->positive probability:0.84, 21/25
-->group-truth label positive probability:0.88, 22/25
-->identity muslim
-->length 13
-->ACC 0.7692307692307693
-->F1 0.823529411764706
-->FPR 0.4
-->FNR 0.125
-->positive probability:0.6923076923076923, 9/13
-->group-truth label positive probability:0.6153846153846154, 8/13
-->identity jewish
-->length 72
-->ACC 0.7638888888888888
-->F1 0.7536231884057971
-->FPR 0.275
-->FNR 0.1875
-->positive probability:0.5138888888888888, 37/72
-->group-truth label positive probability:0.4444444444444444, 32/72
-->identity black
-->length 157
-->ACC 0.7961783439490446
-->F1 0.8279569892473119
-->FPR 0.25
-->FNR 0.17204301075268819
-->positive probability:0.5923566878980892, 93/157
-->group-truth label positive probability:0.5923566878980892, 93/157
-->identity white
-->length 381
-->ACC 0.8661417322834646
-->F1 0.9137055837563453
-->FPR 0.3181818181818182
-->FNR 0.07849829351535836
-->positive probability:0.7821522309711286, 298/381
-->group-truth label positive probability:0.7690288713910761, 293/381
-->fpr_diff [0.04562394127611519, 0.13258046301524562, 0.3064935064935065, 0.02683982683982683, 0.09350649350649354, 0.03149350649350646, 0.056493506493506485, 0.011688311688311692]
-->fnr_diff [0.016044396112750936, 0.050447189805117386, 0.03680113234253362, 0.05410795856655729, 0.08819886765746637, 0.15069886765746637, 0.13524187841015456, 0.041697161172824744]
-->FPR:[0.2608695652173913, 0.17391304347826086, 0.0, 0.3333333333333333, 0.4, 0.275, 0.25, 0.3181818181818182], mean FPR:0.25141222002635044, mean FPR metric:0.08808994447581403
-->FNR:[0.052845528455284556, 0.087248322147651, 0.0, 0.09090909090909091, 0.125, 0.1875, 0.17204301075268819, 0.07849829351535836], mean FNR:0.09925553072250913, mean FNR metric:0.07165468146560891
-->group metric: 0.07165468146560891
   test_acc   test_f1  ...  test_fnr_mean  test_fnr_metric
0  0.928371  0.959930  ...       0.056882         0.044320
1  0.931174  0.961424  ...       0.052746         0.046377
2  0.924323  0.956553  ...       0.164379         0.110947
3  0.930863  0.961039  ...       0.089117         0.065762
4  0.930863  0.960819  ...       0.099256         0.071655

[5 rows x 10 columns]
-->gamma 0.9
-->gamma 0.9
-->model AddedLayers(
  (model): Sequential(
    (0): Linear(in_features=4096, out_features=328, bias=True)
    (1): GELU(approximate='none')
    (2): Linear(in_features=328, out_features=4096, bias=True)
    (3): GELU(approximate='none')
    (4): Linear(in_features=4096, out_features=328, bias=True)
    (5): GELU(approximate='none')
    (6): Linear(in_features=328, out_features=4096, bias=True)
  )
)
-->classifier Linear(in_features=4096, out_features=2, bias=False)
-->MinValue:-2.271099895830676, MaxValue:2.2792810789854263
-->epoch 0
-->batch_size 98
-->weights tensor([2.3148, 0.6378], device='cuda:2')
-->FUR:0.0, FU:0.0, P:40
-->FUR:0.0, FU:0.0, P:26
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:4
-->None
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:13
-->FUR:0.0, FU:0.0, P:43
-->show_identity_num 7
-->z_score:-2.262918710708618, p_hat:0.00018011502106674016, n:98.0
-->bias_loss tensor(0.0016, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.3259, acc_loss, 0.3243, bias_loss:0.0016
-->batch_size 98
-->weights tensor([1.9412, 0.6735], device='cuda:2')
-->FUR:0.3142857253551483, FU:11.0, P:35
-->FUR:0.11328629404306412, FU:2.945443630218506, P:26
-->FUR:0.5, FU:1.0, P:2
-->FUR:0.3333333432674408, FU:1.0, P:3
-->None
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.1764705926179886, FU:3.0, P:17
-->FUR:0.20466011762619019, FU:9.005044937133789, P:44
-->show_identity_num 7
-->z_score:8.377994537353516, p_hat:0.23444795608520508, n:98.0
-->bias_loss tensor(0.9000, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 1.1536, acc_loss, 0.2536, bias_loss:0.9000
-->batch_size 98
-->weights tensor([2.7273, 0.6122], device='cuda:2')
-->FUR:0.0, FU:0.0, P:33
-->FUR:0.0, FU:0.0, P:16
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:11
-->FUR:0.0, FU:0.0, P:50
-->show_identity_num 8
-->z_score:-2.2639412879943848, p_hat:0.00015760063251946121, n:98.0
-->bias_loss tensor(0.0014, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 1.0630, acc_loss, 1.0616, bias_loss:0.0014
-->batch_size 98
-->weights tensor([2.4600, 0.6276], device='cuda:2')
-->FUR:0.0, FU:0.0, P:35
-->FUR:4.563480615615845e-06, FU:0.00014603137969970703, P:32
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:11
-->FUR:0.0, FU:0.0, P:41
-->show_identity_num 8
-->z_score:-2.263967514038086, p_hat:0.00015703019744250923, n:98.0
-->bias_loss tensor(0.0014, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.0148, acc_loss, 0.0134, bias_loss:0.0014
-->batch_size 98
-->weights tensor([1.9848, 0.6684], device='cuda:2')
-->FUR:0.11853671073913574, FU:2.9634177684783936, P:25
-->FUR:0.31117019057273865, FU:4.978723049163818, P:16
-->FUR:0.6666666865348816, FU:2.0, P:3
-->FUR:0.5, FU:1.0, P:2
-->FUR:0.4817197918891907, FU:0.9634395837783813, P:2
-->FUR:0.5, FU:4.0, P:8
-->FUR:0.4512678384780884, FU:4.963946342468262, P:11
-->FUR:0.22872550785541534, FU:10.978824615478516, P:48
-->show_identity_num 8
-->z_score:16.219318389892578, p_hat:0.4070807099342346, n:98.0
-->bias_loss tensor(0.9000, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 1.3529, acc_loss, 0.4529, bias_loss:0.9000
-->batch_size 98
-->weights tensor([2.7273, 0.6122], device='cuda:2')
-->FUR:0.0, FU:0.0, P:43
-->FUR:0.0, FU:0.0, P:24
-->None
-->FUR:0.0, FU:0.0, P:3
-->None
-->FUR:0.19993087649345398, FU:0.9996543526649475, P:5
-->FUR:0.0, FU:0.0, P:15
-->FUR:0.04545454680919647, FU:2.0, P:44
-->show_identity_num 6
-->z_score:-0.41072338819503784, p_hat:0.04095761105418205, n:98.0
-->bias_loss tensor(0.3680, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.5328, acc_loss, 0.1649, bias_loss:0.3680
-->batch_size 98
-->weights tensor([2.0312, 0.6633], device='cuda:2')
-->FUR:0.022727273404598236, FU:1.0, P:44
-->FUR:0.0, FU:0.0, P:25
-->FUR:0.0, FU:0.0, P:2
-->None
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:6
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:39
-->show_identity_num 7
-->z_score:-2.1177821159362793, p_hat:0.00337540777400136, n:98.0
-->bias_loss tensor(0.0303, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.0436, acc_loss, 0.0133, bias_loss:0.0303
-->batch_size 98
-->weights tensor([2.2500, 0.6429], device='cuda:2')
-->FUR:0.0, FU:0.0, P:40
-->FUR:0.0, FU:0.0, P:22
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:6
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.0, FU:0.0, P:44
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss tensor(0.0016, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.0132, acc_loss, 0.0116, bias_loss:0.0016
-->batch_size 98
-->weights tensor([3.5625, 0.5816], device='cuda:2')
-->FUR:0.0, FU:0.0, P:44
-->FUR:0.03125, FU:1.0, P:32
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.3333333432674408, FU:1.0, P:3
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:8
-->FUR:0.0, FU:0.0, P:14
-->FUR:0.0, FU:0.0, P:29
-->show_identity_num 8
-->z_score:-0.19699612259864807, p_hat:0.045662980526685715, n:98.0
-->bias_loss tensor(0.4102, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.4833, acc_loss, 0.0730, bias_loss:0.4102
-->batch_size 98
-->weights tensor([2.6304, 0.6173], device='cuda:2')
-->FUR:0.0, FU:0.0, P:35
-->FUR:0.0, FU:0.0, P:22
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:9
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.0, FU:0.0, P:46
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss tensor(0.0016, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.0036, acc_loss, 0.0020, bias_loss:0.0016
-->batch_size 98
-->weights tensor([1.9412, 0.6735], device='cuda:2')
-->FUR:0.0, FU:0.0, P:36
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:25
-->FUR:0.0, FU:0.0, P:41
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss tensor(0.0016, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.0045, acc_loss, 0.0029, bias_loss:0.0016
-->batch_size 98
-->weights tensor([1.9412, 0.6735], device='cuda:2')
-->FUR:0.0, FU:0.0, P:37
-->FUR:0.0, FU:0.0, P:23
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:21
-->FUR:0.019607843831181526, FU:1.0, P:51
-->show_identity_num 8
-->z_score:-2.1556808948516846, p_hat:0.0025410379748791456, n:98.0
-->bias_loss tensor(0.0228, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.1209, acc_loss, 0.0981, bias_loss:0.0228
-->batch_size 98
-->weights tensor([2.0806, 0.6582], device='cuda:2')
-->FUR:0.0, FU:0.0, P:30
-->FUR:0.0, FU:0.0, P:26
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:5
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:40
-->show_identity_num 8
-->z_score:-2.2639412879943848, p_hat:0.00015760063251946121, n:98.0
-->bias_loss tensor(0.0014, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.0076, acc_loss, 0.0062, bias_loss:0.0014
-->batch_size 98
-->weights tensor([2.0312, 0.6633], device='cuda:2')
-->FUR:0.0, FU:0.0, P:34
-->FUR:0.0, FU:0.0, P:23
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.020408162847161293, FU:1.0, P:49
-->show_identity_num 8
-->z_score:-2.1501142978668213, p_hat:0.0026635921094566584, n:98.0
-->bias_loss tensor(0.0239, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.0509, acc_loss, 0.0269, bias_loss:0.0239
-->batch_size 98
-->weights tensor([2.3846, 0.6327], device='cuda:2')
-->FUR:0.09375, FU:3.0, P:32
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.3333333432674408, FU:1.0, P:3
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:12
-->FUR:0.0, FU:0.0, P:18
-->FUR:0.020408162847161293, FU:1.0, P:49
-->show_identity_num 8
-->z_score:0.27169036865234375, p_hat:0.05598147213459015, n:98.0
-->bias_loss tensor(0.5029, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.5884, acc_loss, 0.0855, bias_loss:0.5029
-->batch_size 98
-->weights tensor([3.4000, 0.5862], device='cuda:2')
-->FUR:0.0, FU:0.0, P:38
-->FUR:0.0, FU:0.0, P:19
-->None
-->None
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:8
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:36
-->show_identity_num 6
-->z_score:-2.2642822265625, p_hat:0.00015009584603831172, n:98.0
-->bias_loss tensor(0.0013, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.0037, acc_loss, 0.0023, bias_loss:0.0013
-->after epoch 0
-->overall baseline on testing dataset
-->ACC 0.9283712239177826
-->F1 0.9599303135888502
-->FPR: 0.412987012987013
-->FNR: 0.025123849964614295
testing dataset
-->original metric score:
-->identity male
-->length 292
-->ACC 0.910958904109589
-->F1 0.9475806451612904
-->FPR 0.32608695652173914
-->FNR 0.044715447154471545
-->positive probability:0.8561643835616438, 250/292
-->group-truth label positive probability:0.8424657534246576, 246/292
-->identity female
-->length 195
-->ACC 0.8666666666666667
-->F1 0.9139072847682119
-->FPR 0.32608695652173914
-->FNR 0.0738255033557047
-->positive probability:0.7846153846153846, 153/195
-->group-truth label positive probability:0.764102564102564, 149/195
-->identity homosexual
-->length 14
-->ACC 0.9285714285714286
-->F1 0.9473684210526316
-->FPR 0.2
-->FNR 0.0
-->positive probability:0.7142857142857143, 10/14
-->group-truth label positive probability:0.6428571428571429, 9/14
-->identity christian
-->length 25
-->ACC 0.88
-->F1 0.9333333333333332
-->FPR 0.6666666666666666
-->FNR 0.045454545454545456
-->positive probability:0.92, 23/25
-->group-truth label positive probability:0.88, 22/25
-->identity muslim
-->length 13
-->ACC 0.8461538461538461
-->F1 0.888888888888889
-->FPR 0.4
-->FNR 0.0
-->positive probability:0.7692307692307693, 10/13
-->group-truth label positive probability:0.6153846153846154, 8/13
-->identity jewish
-->length 72
-->ACC 0.75
-->F1 0.75
-->FPR 0.325
-->FNR 0.15625
-->positive probability:0.5555555555555556, 40/72
-->group-truth label positive probability:0.4444444444444444, 32/72
-->identity black
-->length 157
-->ACC 0.7961783439490446
-->F1 0.8350515463917527
-->FPR 0.3125
-->FNR 0.12903225806451613
-->positive probability:0.643312101910828, 101/157
-->group-truth label positive probability:0.5923566878980892, 93/157
-->identity white
-->length 381
-->ACC 0.8713910761154856
-->F1 0.9192751235584844
-->FPR 0.3977272727272727
-->FNR 0.04778156996587031
-->positive probability:0.8241469816272966, 314/381
-->group-truth label positive probability:0.7690288713910761, 293/381
-->fpr_diff [0.08690005646527388, 0.08690005646527388, 0.212987012987013, 0.2536796536796536, 0.012987012987012991, 0.087987012987013, 0.10048701298701301, 0.015259740259740306]
-->fnr_diff [0.01959159718985725, 0.04870165339109041, 0.025123849964614295, 0.02033069548993116, 0.025123849964614295, 0.1311261500353857, 0.10390840809990183, 0.022657720001256015]
-->FPR:[0.32608695652173914, 0.32608695652173914, 0.2, 0.6666666666666666, 0.4, 0.325, 0.3125, 0.3977272727272727], mean FPR:0.3692584815546772, mean FPR metric:0.1071484448522492
-->FNR:[0.044715447154471545, 0.0738255033557047, 0.0, 0.045454545454545456, 0.0, 0.15625, 0.12903225806451613, 0.04778156996587031], mean FNR:0.06213241549938851, mean FNR metric:0.04957049051708137
-->group metric: 0.04957049051708137
-->epoch 1
-->batch_size 98
-->weights tensor([2.3148, 0.6378], device='cuda:2')
-->FUR:0.0, FU:0.0, P:40
-->FUR:0.0, FU:0.0, P:26
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:4
-->None
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:13
-->FUR:0.0, FU:0.0, P:43
-->show_identity_num 7
-->z_score:-2.262918710708618, p_hat:0.00018011502106674016, n:98.0
-->bias_loss tensor(0.0016, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [2/5], Loss: 0.0025, acc_loss, 0.0009, bias_loss:0.0016
-->batch_size 98
-->weights tensor([1.9412, 0.6735], device='cuda:2')
-->FUR:0.0, FU:0.0, P:35
-->FUR:0.03846153989434242, FU:1.0, P:26
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:3
-->None
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.0, FU:0.0, P:44
-->show_identity_num 7
-->z_score:-2.0156848430633545, p_hat:0.005623158998787403, n:98.0
-->bias_loss tensor(0.0505, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [2/5], Loss: 0.0838, acc_loss, 0.0332, bias_loss:0.0505
-->batch_size 98
-->weights tensor([2.7273, 0.6122], device='cuda:2')
-->FUR:0.0, FU:0.0, P:33
-->FUR:0.0, FU:0.0, P:16
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:11
-->FUR:0.0, FU:0.0, P:50
-->show_identity_num 8
-->z_score:-2.2639412879943848, p_hat:0.00015760063251946121, n:98.0
-->bias_loss tensor(0.0014, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [2/5], Loss: 0.0024, acc_loss, 0.0010, bias_loss:0.0014
-->batch_size 98
-->weights tensor([2.4600, 0.6276], device='cuda:2')
-->FUR:0.0, FU:0.0, P:35
-->FUR:0.03125, FU:1.0, P:32
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:11
-->FUR:0.0, FU:0.0, P:41
-->show_identity_num 8
-->z_score:-2.088557243347168, p_hat:0.004018821287900209, n:98.0
-->bias_loss tensor(0.0361, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [2/5], Loss: 0.0805, acc_loss, 0.0444, bias_loss:0.0361
-->batch_size 98
-->weights tensor([1.9848, 0.6684], device='cuda:2')
-->FUR:0.0, FU:0.0, P:25
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:8
-->FUR:0.0, FU:0.0, P:11
-->FUR:0.0, FU:0.0, P:48
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss tensor(0.0016, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [2/5], Loss: 0.0371, acc_loss, 0.0355, bias_loss:0.0016
-->batch_size 98
-->weights tensor([2.7273, 0.6122], device='cuda:2')
-->FUR:0.0, FU:0.0, P:43
-->FUR:0.0, FU:0.0, P:24
-->None
-->FUR:0.0, FU:0.0, P:3
-->None
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:15
-->FUR:0.0, FU:0.0, P:44
-->show_identity_num 6
-->z_score:-2.262918710708618, p_hat:0.00018011502106674016, n:98.0
-->bias_loss tensor(0.0016, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [2/5], Loss: 0.2485, acc_loss, 0.2469, bias_loss:0.0016
-->batch_size 98
-->weights tensor([2.0312, 0.6633], device='cuda:2')
-->FUR:0.0, FU:0.0, P:44
-->FUR:0.0, FU:0.0, P:25
-->FUR:0.0, FU:0.0, P:2
-->None
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:6
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:39
-->show_identity_num 7
-->z_score:-2.262918710708618, p_hat:0.00018011502106674016, n:98.0
-->bias_loss tensor(0.0016, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [2/5], Loss: 0.0017, acc_loss, 0.0001, bias_loss:0.0016
-->batch_size 98
-->weights tensor([2.2500, 0.6429], device='cuda:2')
-->FUR:0.0, FU:0.0, P:40
-->FUR:0.0, FU:0.0, P:22
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:6
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.0, FU:0.0, P:44
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss tensor(0.0016, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [2/5], Loss: 0.0128, acc_loss, 0.0111, bias_loss:0.0016
-->batch_size 98
-->weights tensor([3.5625, 0.5816], device='cuda:2')
-->FUR:0.0, FU:0.0, P:44
-->FUR:0.03125, FU:1.0, P:32
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.3333333432674408, FU:1.0, P:3
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:8
-->FUR:0.0714285746216774, FU:1.0, P:14
-->FUR:0.0, FU:0.0, P:29
-->show_identity_num 8
-->z_score:0.206511989235878, p_hat:0.05454652011394501, n:98.0
-->bias_loss tensor(0.4900, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [2/5], Loss: 0.6738, acc_loss, 0.1838, bias_loss:0.4900
-->batch_size 98
-->weights tensor([2.6304, 0.6173], device='cuda:2')
-->FUR:0.044575948268175125, FU:1.5601582527160645, P:35
-->FUR:0.04545454680919647, FU:1.0, P:22
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:9
-->FUR:0.11764705926179886, FU:2.0, P:17
-->FUR:0.0, FU:0.0, P:46
-->show_identity_num 8
-->z_score:-1.0899133682250977, p_hat:0.026004724204540253, n:98.0
-->bias_loss tensor(0.2336, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [2/5], Loss: 0.2984, acc_loss, 0.0648, bias_loss:0.2336
-->batch_size 98
-->weights tensor([1.9412, 0.6735], device='cuda:2')
-->FUR:0.02777777798473835, FU:1.0, P:36
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:25
-->FUR:0.024390242993831635, FU:1.0, P:41
-->show_identity_num 8
-->z_score:-1.9708123207092285, p_hat:0.0066110603511333466, n:98.0
-->bias_loss tensor(0.0594, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [2/5], Loss: 0.1108, acc_loss, 0.0514, bias_loss:0.0594
-->batch_size 98
-->weights tensor([1.9412, 0.6735], device='cuda:2')
-->FUR:0.0, FU:0.0, P:37
-->FUR:0.0, FU:0.0, P:23
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:21
-->FUR:0.0, FU:0.0, P:51
-->show_identity_num 8
-->z_score:-2.2649641036987305, p_hat:0.0001350862585240975, n:98.0
-->bias_loss tensor(0.0012, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [2/5], Loss: 0.1718, acc_loss, 0.1706, bias_loss:0.0012
-->batch_size 98
-->weights tensor([2.0806, 0.6582], device='cuda:2')
-->FUR:0.0, FU:0.0, P:30
-->FUR:0.0, FU:0.0, P:26
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:5
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:40
-->show_identity_num 8
-->z_score:-2.2639412879943848, p_hat:0.00015760063251946121, n:98.0
-->bias_loss tensor(0.0014, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [2/5], Loss: 0.0014, acc_loss, 0.0000, bias_loss:0.0014
-->batch_size 98
-->weights tensor([2.0312, 0.6633], device='cuda:2')
-->FUR:8.765388770370919e-08, FU:2.9802322387695312e-06, P:34
-->FUR:0.0, FU:0.0, P:23
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.05878698453307152, FU:0.9993787407875061, P:17
-->FUR:0.04080364853143692, FU:1.9993788003921509, P:49
-->show_identity_num 8
-->z_score:-1.702581763267517, p_hat:0.01251636166125536, n:98.0
-->bias_loss tensor(0.1124, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [2/5], Loss: 0.2140, acc_loss, 0.1015, bias_loss:0.1124
-->batch_size 98
-->weights tensor([2.3846, 0.6327], device='cuda:2')
-->FUR:0.0, FU:0.0, P:32
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:12
-->FUR:0.0, FU:0.0, P:18
-->FUR:0.0, FU:0.0, P:49
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss tensor(0.0016, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [2/5], Loss: 0.0472, acc_loss, 0.0456, bias_loss:0.0016
-->batch_size 98
-->weights tensor([3.4000, 0.5862], device='cuda:2')
-->FUR:0.0, FU:0.0, P:38
-->FUR:0.0, FU:0.0, P:19
-->None
-->None
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:8
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:36
-->show_identity_num 6
-->z_score:-2.2642822265625, p_hat:0.00015009584603831172, n:98.0
-->bias_loss tensor(0.0013, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [2/5], Loss: 0.0053, acc_loss, 0.0040, bias_loss:0.0013
-->after epoch 1
-->overall baseline on testing dataset
-->ACC 0.9258797882279663
-->F1 0.9589796621854534
-->FPR: 0.5038961038961038
-->FNR: 0.01556970983722576
testing dataset
-->original metric score:
-->identity male
-->length 292
-->ACC 0.8904109589041096
-->F1 0.9370078740157479
-->FPR 0.5217391304347826
-->FNR 0.032520325203252036
-->positive probability:0.8972602739726028, 262/292
-->group-truth label positive probability:0.8424657534246576, 246/292
-->identity female
-->length 195
-->ACC 0.8358974358974359
-->F1 0.8980891719745222
-->FPR 0.5217391304347826
-->FNR 0.053691275167785234
-->positive probability:0.8461538461538461, 165/195
-->group-truth label positive probability:0.764102564102564, 149/195
-->identity homosexual
-->length 14
-->ACC 0.9285714285714286
-->F1 0.9473684210526316
-->FPR 0.2
-->FNR 0.0
-->positive probability:0.7142857142857143, 10/14
-->group-truth label positive probability:0.6428571428571429, 9/14
-->identity christian
-->length 25
-->ACC 0.92
-->F1 0.9565217391304348
-->FPR 0.6666666666666666
-->FNR 0.0
-->positive probability:0.96, 24/25
-->group-truth label positive probability:0.88, 22/25
-->identity muslim
-->length 13
-->ACC 0.8461538461538461
-->F1 0.888888888888889
-->FPR 0.4
-->FNR 0.0
-->positive probability:0.7692307692307693, 10/13
-->group-truth label positive probability:0.6153846153846154, 8/13
-->identity jewish
-->length 72
-->ACC 0.7222222222222222
-->F1 0.7368421052631579
-->FPR 0.4
-->FNR 0.125
-->positive probability:0.6111111111111112, 44/72
-->group-truth label positive probability:0.4444444444444444, 32/72
-->identity black
-->length 157
-->ACC 0.7834394904458599
-->F1 0.8349514563106796
-->FPR 0.421875
-->FNR 0.07526881720430108
-->positive probability:0.7197452229299363, 113/157
-->group-truth label positive probability:0.5923566878980892, 93/157
-->identity white
-->length 381
-->ACC 0.8530183727034121
-->F1 0.909967845659164
-->FPR 0.5227272727272727
-->FNR 0.034129692832764506
-->positive probability:0.863517060367454, 329/381
-->group-truth label positive probability:0.7690288713910761, 293/381
-->fpr_diff [0.017843026538678752, 0.017843026538678752, 0.30389610389610383, 0.1627705627705628, 0.10389610389610382, 0.10389610389610382, 0.08202110389610384, 0.018831168831168865]
-->fnr_diff [0.016950615366026274, 0.03812156533055947, 0.01556970983722576, 0.01556970983722576, 0.01556970983722576, 0.10943029016277424, 0.059699107367075316, 0.018559982995538744]
-->FPR:[0.5217391304347826, 0.5217391304347826, 0.2, 0.6666666666666666, 0.4, 0.4, 0.421875, 0.5227272727272727], mean FPR:0.4568434000329381, mean FPR metric:0.10137465003293805
-->FNR:[0.032520325203252036, 0.053691275167785234, 0.0, 0.0, 0.0, 0.125, 0.07526881720430108, 0.034129692832764506], mean FNR:0.040076263801012854, mean FNR metric:0.03618383634170642
-->group metric: 0.03618383634170642
-->epoch 2
-->batch_size 98
-->weights tensor([2.3148, 0.6378], device='cuda:2')
-->FUR:0.0, FU:0.0, P:40
-->FUR:0.0, FU:0.0, P:26
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:4
-->None
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:13
-->FUR:0.0, FU:0.0, P:43
-->show_identity_num 7
-->z_score:-2.262918710708618, p_hat:0.00018011502106674016, n:98.0
-->bias_loss tensor(0.0016, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [3/5], Loss: 0.0016, acc_loss, 0.0000, bias_loss:0.0016
-->batch_size 98
-->weights tensor([1.9412, 0.6735], device='cuda:2')
-->FUR:0.0, FU:0.0, P:35
-->FUR:0.0, FU:0.0, P:26
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:3
-->None
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.0, FU:0.0, P:44
-->show_identity_num 7
-->z_score:-2.262918710708618, p_hat:0.00018011502106674016, n:98.0
-->bias_loss tensor(0.0016, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [3/5], Loss: 0.0037, acc_loss, 0.0021, bias_loss:0.0016
-->batch_size 98
-->weights tensor([2.7273, 0.6122], device='cuda:2')
-->FUR:0.0, FU:0.0, P:33
-->FUR:0.0, FU:0.0, P:16
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:11
-->FUR:0.0, FU:0.0, P:50
-->show_identity_num 8
-->z_score:-2.2639412879943848, p_hat:0.00015760063251946121, n:98.0
-->bias_loss tensor(0.0014, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [3/5], Loss: 0.4501, acc_loss, 0.4487, bias_loss:0.0014
-->batch_size 98
-->weights tensor([2.4600, 0.6276], device='cuda:2')
-->FUR:0.0, FU:0.0, P:35
-->FUR:0.03125, FU:1.0, P:32
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:11
-->FUR:0.02405209094285965, FU:0.986135721206665, P:41
-->show_identity_num 8
-->z_score:-1.9540406465530396, p_hat:0.0069803036749362946, n:98.0
-->bias_loss tensor(0.0627, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [3/5], Loss: 0.1699, acc_loss, 0.1072, bias_loss:0.0627
-->batch_size 98
-->weights tensor([1.9848, 0.6684], device='cuda:2')
-->FUR:0.0, FU:0.0, P:25
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:8
-->FUR:0.0, FU:0.0, P:11
-->FUR:0.0, FU:0.0, P:48
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss tensor(0.0016, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [3/5], Loss: 0.0032, acc_loss, 0.0016, bias_loss:0.0016
-->batch_size 98
-->weights tensor([2.7273, 0.6122], device='cuda:2')
-->FUR:0.0, FU:0.0, P:43
-->FUR:0.0, FU:0.0, P:24
-->None
-->FUR:0.0, FU:0.0, P:3
-->None
-->FUR:0.20000000298023224, FU:1.0, P:5
-->FUR:0.0, FU:0.0, P:15
-->FUR:0.04545454680919647, FU:2.0, P:44
-->show_identity_num 6
-->z_score:-0.4102000594139099, p_hat:0.040969133377075195, n:98.0
-->bias_loss tensor(0.3681, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [3/5], Loss: 0.7746, acc_loss, 0.4065, bias_loss:0.3681
-->batch_size 98
-->weights tensor([2.0312, 0.6633], device='cuda:2')
-->FUR:0.13636364042758942, FU:6.0, P:44
-->FUR:0.20000000298023224, FU:5.0, P:25
-->FUR:0.0, FU:0.0, P:2
-->None
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.3333323895931244, FU:1.9999942779541016, P:6
-->FUR:0.375, FU:6.0, P:16
-->FUR:0.3076923191547394, FU:12.0, P:39
-->show_identity_num 7
-->z_score:6.500848770141602, p_hat:0.19312115013599396, n:98.0
-->bias_loss tensor(0.9000, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [3/5], Loss: 1.3223, acc_loss, 0.4223, bias_loss:0.9000
-->batch_size 98
-->weights tensor([2.2500, 0.6429], device='cuda:2')
-->FUR:0.0, FU:0.0, P:40
-->FUR:0.0, FU:0.0, P:22
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:6
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.0, FU:0.0, P:44
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss tensor(0.0016, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [3/5], Loss: 0.0016, acc_loss, 0.0000, bias_loss:0.0016
-->batch_size 98
-->weights tensor([3.5625, 0.5816], device='cuda:2')
-->FUR:0.0, FU:0.0, P:44
-->FUR:0.0, FU:0.0, P:32
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:8
-->FUR:0.0, FU:0.0, P:14
-->FUR:0.0, FU:0.0, P:29
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss tensor(0.0016, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [3/5], Loss: 0.0016, acc_loss, 0.0000, bias_loss:0.0016
-->batch_size 98
-->weights tensor([2.6304, 0.6173], device='cuda:2')
-->FUR:0.0, FU:0.0, P:35
-->FUR:0.0, FU:0.0, P:22
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:9
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.0, FU:0.0, P:46
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss tensor(0.0016, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [3/5], Loss: 0.6274, acc_loss, 0.6258, bias_loss:0.0016
-->batch_size 98
-->weights tensor([1.9412, 0.6735], device='cuda:2')
-->FUR:0.0, FU:0.0, P:36
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:25
-->FUR:0.0, FU:0.0, P:41
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss tensor(0.0016, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [3/5], Loss: 0.2607, acc_loss, 0.2591, bias_loss:0.0016
-->batch_size 98
-->weights tensor([1.9412, 0.6735], device='cuda:2')
-->FUR:0.0, FU:0.0, P:37
-->FUR:0.0, FU:0.0, P:23
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:21
-->FUR:0.0, FU:0.0, P:51
-->show_identity_num 8
-->z_score:-2.2649641036987305, p_hat:0.0001350862585240975, n:98.0
-->bias_loss tensor(0.0012, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [3/5], Loss: 0.3198, acc_loss, 0.3186, bias_loss:0.0012
-->batch_size 98
-->weights tensor([2.0806, 0.6582], device='cuda:2')
-->FUR:0.0, FU:0.0, P:30
-->FUR:0.0, FU:0.0, P:26
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:5
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.02500000037252903, FU:1.0, P:40
-->show_identity_num 8
-->z_score:-2.1240429878234863, p_hat:0.0032375718001276255, n:98.0
-->bias_loss tensor(0.0291, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [3/5], Loss: 0.0363, acc_loss, 0.0072, bias_loss:0.0291
-->batch_size 98
-->weights tensor([2.0312, 0.6633], device='cuda:2')
-->FUR:0.0, FU:0.0, P:34
-->FUR:0.0, FU:0.0, P:23
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.05882352963089943, FU:1.0, P:17
-->FUR:0.0, FU:0.0, P:49
-->show_identity_num 8
-->z_score:-1.9320015907287598, p_hat:0.007465512957423925, n:98.0
-->bias_loss tensor(0.0671, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [3/5], Loss: 0.2198, acc_loss, 0.1528, bias_loss:0.0671
-->batch_size 98
-->weights tensor([2.3846, 0.6327], device='cuda:2')
-->FUR:0.03125, FU:1.0, P:32
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:12
-->FUR:0.0, FU:0.0, P:18
-->FUR:0.06122449040412903, FU:3.0, P:49
-->show_identity_num 8
-->z_score:-1.7419624328613281, p_hat:0.011649368330836296, n:98.0
-->bias_loss tensor(0.1047, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [3/5], Loss: 0.2854, acc_loss, 0.1808, bias_loss:0.1047
-->batch_size 98
-->weights tensor([3.4000, 0.5862], device='cuda:2')
-->FUR:0.02631578966975212, FU:1.0, P:38
-->FUR:0.0, FU:0.0, P:19
-->None
-->None
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:8
-->FUR:0.0625, FU:1.0, P:16
-->FUR:0.0, FU:0.0, P:36
-->show_identity_num 6
-->z_score:-1.597371220588684, p_hat:0.014832652173936367, n:98.0
-->bias_loss tensor(0.1333, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [3/5], Loss: 0.2026, acc_loss, 0.0694, bias_loss:0.1333
-->after epoch 2
-->overall baseline on testing dataset
-->ACC 0.8866396761133604
-->F1 0.9323420074349442
-->FPR: 0.11948051948051948
-->FNR: 0.11252653927813164
testing dataset
-->original metric score:
-->identity male
-->length 292
-->ACC 0.8424657534246576
-->F1 0.8982300884955753
-->FPR 0.06521739130434782
-->FNR 0.17479674796747968
-->positive probability:0.7054794520547946, 206/292
-->group-truth label positive probability:0.8424657534246576, 246/292
-->identity female
-->length 195
-->ACC 0.8102564102564103
-->F1 0.860377358490566
-->FPR 0.043478260869565216
-->FNR 0.2348993288590604
-->positive probability:0.5948717948717949, 116/195
-->group-truth label positive probability:0.764102564102564, 149/195
-->identity homosexual
-->length 14
-->ACC 0.7142857142857143
-->F1 0.7142857142857143
-->FPR 0.0
-->FNR 0.4444444444444444
-->positive probability:0.35714285714285715, 5/14
-->group-truth label positive probability:0.6428571428571429, 9/14
-->identity christian
-->length 25
-->ACC 0.72
-->F1 0.8205128205128205
-->FPR 0.3333333333333333
-->FNR 0.2727272727272727
-->positive probability:0.68, 17/25
-->group-truth label positive probability:0.88, 22/25
-->identity muslim
-->length 13
-->ACC 0.6923076923076923
-->F1 0.6666666666666666
-->FPR 0.0
-->FNR 0.5
-->positive probability:0.3076923076923077, 4/13
-->group-truth label positive probability:0.6153846153846154, 8/13
-->identity jewish
-->length 72
-->ACC 0.7222222222222222
-->F1 0.5833333333333334
-->FPR 0.05
-->FNR 0.5625
-->positive probability:0.2222222222222222, 16/72
-->group-truth label positive probability:0.4444444444444444, 32/72
-->identity black
-->length 157
-->ACC 0.7133757961783439
-->F1 0.7096774193548387
-->FPR 0.109375
-->FNR 0.40860215053763443
-->positive probability:0.39490445859872614, 62/157
-->group-truth label positive probability:0.5923566878980892, 93/157
-->identity white
-->length 381
-->ACC 0.7401574803149606
-->F1 0.8055009823182712
-->FPR 0.125
-->FNR 0.3003412969283277
-->positive probability:0.5669291338582677, 216/381
-->group-truth label positive probability:0.7690288713910761, 293/381
-->fpr_diff [0.054263128176171654, 0.07600225861095426, 0.11948051948051948, 0.21385281385281385, 0.11948051948051948, 0.06948051948051948, 0.010105519480519479, 0.005519480519480521]
-->fnr_diff [0.062270208689348044, 0.12237278958092876, 0.3319179051663128, 0.16020073344914107, 0.3874734607218684, 0.4499734607218684, 0.29607561125950277, 0.18781475765019603]
-->FPR:[0.06521739130434782, 0.043478260869565216, 0.0, 0.3333333333333333, 0.0, 0.05, 0.109375, 0.125], mean FPR:0.0908004981884058, mean FPR metric:0.08352309488518728
-->FNR:[0.17479674796747968, 0.2348993288590604, 0.4444444444444444, 0.2727272727272727, 0.5, 0.5625, 0.40860215053763443, 0.3003412969283277], mean FNR:0.3622889051830274, mean FNR metric:0.2497623659048958
-->group metric: 0.2497623659048958
-->epoch 3
-->batch_size 98
-->weights tensor([2.3148, 0.6378], device='cuda:2')
-->FUR:0.0, FU:0.0, P:40
-->FUR:0.07692307978868484, FU:2.0, P:26
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.25, FU:1.0, P:4
-->None
-->FUR:0.1428571492433548, FU:1.0, P:7
-->FUR:0.0, FU:0.0, P:13
-->FUR:0.11627907305955887, FU:5.0, P:43
-->show_identity_num 7
-->z_score:1.53058660030365, p_hat:0.08369703590869904, n:98.0
-->bias_loss tensor(0.7519, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [4/5], Loss: 1.2182, acc_loss, 0.4663, bias_loss:0.7519
-->batch_size 98
-->weights tensor([1.9412, 0.6735], device='cuda:2')
-->FUR:0.0, FU:0.0, P:35
-->FUR:0.0, FU:0.0, P:26
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:3
-->None
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.05882352963089943, FU:1.0, P:17
-->FUR:0.0, FU:0.0, P:44
-->show_identity_num 7
-->z_score:-1.8835588693618774, p_hat:0.008532015606760979, n:98.0
-->bias_loss tensor(0.0767, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [4/5], Loss: 0.0976, acc_loss, 0.0210, bias_loss:0.0767
-->batch_size 98
-->weights tensor([2.7273, 0.6122], device='cuda:2')
-->FUR:0.0, FU:0.0, P:33
-->FUR:0.0, FU:0.0, P:16
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:11
-->FUR:0.0, FU:0.0, P:50
-->show_identity_num 8
-->z_score:-2.2639412879943848, p_hat:0.00015760063251946121, n:98.0
-->bias_loss tensor(0.0014, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [4/5], Loss: 0.4008, acc_loss, 0.3993, bias_loss:0.0014
-->batch_size 98
-->weights tensor([2.4600, 0.6276], device='cuda:2')
-->FUR:0.0, FU:0.0, P:35
-->FUR:0.0, FU:0.0, P:32
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:11
-->FUR:0.0, FU:0.0, P:41
-->show_identity_num 8
-->z_score:-2.2639412879943848, p_hat:0.00015760063251946121, n:98.0
-->bias_loss tensor(0.0014, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [4/5], Loss: 0.0014, acc_loss, 0.0000, bias_loss:0.0014
-->batch_size 98
-->weights tensor([1.9848, 0.6684], device='cuda:2')
-->FUR:0.0, FU:0.0, P:25
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:8
-->FUR:0.0, FU:0.0, P:11
-->FUR:0.0, FU:0.0, P:48
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss tensor(0.0016, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [4/5], Loss: 0.0016, acc_loss, 0.0000, bias_loss:0.0016
-->batch_size 98
-->weights tensor([2.7273, 0.6122], device='cuda:2')
-->FUR:0.0, FU:0.0, P:43
-->FUR:0.0, FU:0.0, P:24
-->None
-->FUR:0.0, FU:0.0, P:3
-->None
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:15
-->FUR:0.0, FU:0.0, P:44
-->show_identity_num 6
-->z_score:-2.262918710708618, p_hat:0.00018011502106674016, n:98.0
-->bias_loss tensor(0.0016, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [4/5], Loss: 0.0016, acc_loss, 0.0000, bias_loss:0.0016
-->batch_size 98
-->weights tensor([2.0312, 0.6633], device='cuda:2')
-->FUR:0.0, FU:0.0, P:44
-->FUR:0.0, FU:0.0, P:25
-->FUR:0.0, FU:0.0, P:2
-->None
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:6
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:39
-->show_identity_num 7
-->z_score:-2.262918710708618, p_hat:0.00018011502106674016, n:98.0
-->bias_loss tensor(0.0016, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [4/5], Loss: 0.0095, acc_loss, 0.0079, bias_loss:0.0016
-->batch_size 98
-->weights tensor([2.2500, 0.6429], device='cuda:2')
-->FUR:0.0, FU:0.0, P:40
-->FUR:0.0, FU:0.0, P:22
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:6
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.0, FU:0.0, P:44
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss tensor(0.0016, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [4/5], Loss: 0.3008, acc_loss, 0.2992, bias_loss:0.0016
-->batch_size 98
-->weights tensor([3.5625, 0.5816], device='cuda:2')
-->FUR:0.0, FU:0.0, P:44
-->FUR:0.03125, FU:1.0, P:32
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.3333333432674408, FU:1.0, P:3
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:8
-->FUR:0.0, FU:0.0, P:14
-->FUR:0.0, FU:0.0, P:29
-->show_identity_num 8
-->z_score:-0.19699612259864807, p_hat:0.045662980526685715, n:98.0
-->bias_loss tensor(0.4102, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [4/5], Loss: 0.5290, acc_loss, 0.1187, bias_loss:0.4102
-->batch_size 98
-->weights tensor([2.6304, 0.6173], device='cuda:2')
-->FUR:0.0, FU:0.0, P:35
-->FUR:0.0, FU:0.0, P:22
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:9
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.0, FU:0.0, P:46
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss tensor(0.0016, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [4/5], Loss: 0.0016, acc_loss, 0.0000, bias_loss:0.0016
-->batch_size 98
-->weights tensor([1.9412, 0.6735], device='cuda:2')
-->FUR:0.0, FU:0.0, P:36
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:25
-->FUR:0.024390242993831635, FU:1.0, P:41
-->show_identity_num 8
-->z_score:-2.1264824867248535, p_hat:0.0031838666182011366, n:98.0
-->bias_loss tensor(0.0286, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [4/5], Loss: 0.0616, acc_loss, 0.0330, bias_loss:0.0286
-->batch_size 98
-->weights tensor([1.9412, 0.6735], device='cuda:2')
-->FUR:0.0, FU:0.0, P:37
-->FUR:0.0, FU:0.0, P:23
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:21
-->FUR:0.019607843831181526, FU:1.0, P:51
-->show_identity_num 8
-->z_score:-2.1556808948516846, p_hat:0.0025410379748791456, n:98.0
-->bias_loss tensor(0.0228, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [4/5], Loss: 0.1438, acc_loss, 0.1209, bias_loss:0.0228
-->batch_size 98
-->weights tensor([2.0806, 0.6582], device='cuda:2')
-->FUR:0.0, FU:0.0, P:30
-->FUR:0.0, FU:0.0, P:26
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:5
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:40
-->show_identity_num 8
-->z_score:-2.2639412879943848, p_hat:0.00015760063251946121, n:98.0
-->bias_loss tensor(0.0014, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [4/5], Loss: 0.0015, acc_loss, 0.0001, bias_loss:0.0014
-->batch_size 98
-->weights tensor([2.0312, 0.6633], device='cuda:2')
-->FUR:0.0, FU:0.0, P:34
-->FUR:0.0, FU:0.0, P:23
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.05882352963089943, FU:1.0, P:17
-->FUR:0.020408162847161293, FU:1.0, P:49
-->show_identity_num 8
-->z_score:-1.8181743621826172, p_hat:0.009971505030989647, n:98.0
-->bias_loss tensor(0.0896, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [4/5], Loss: 0.8824, acc_loss, 0.7928, bias_loss:0.0896
-->batch_size 98
-->weights tensor([2.3846, 0.6327], device='cuda:2')
-->FUR:0.0, FU:0.0, P:32
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:12
-->FUR:0.0, FU:0.0, P:18
-->FUR:0.0, FU:0.0, P:49
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss tensor(0.0016, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [4/5], Loss: 0.0016, acc_loss, 0.0000, bias_loss:0.0016
-->batch_size 98
-->weights tensor([3.4000, 0.5862], device='cuda:2')
-->FUR:0.0, FU:0.0, P:38
-->FUR:0.0, FU:0.0, P:19
-->None
-->None
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:8
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:36
-->show_identity_num 6
-->z_score:-2.2642822265625, p_hat:0.00015009584603831172, n:98.0
-->bias_loss tensor(0.0013, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [4/5], Loss: 0.0013, acc_loss, 0.0000, bias_loss:0.0013
-->after epoch 3
-->overall baseline on testing dataset
-->ACC 0.9280597944565556
-->F1 0.9599306157849088
-->FPR: 0.44675324675324674
-->FNR: 0.020877565463552725
testing dataset
-->original metric score:
-->identity male
-->length 292
-->ACC 0.8972602739726028
-->F1 0.9400000000000001
-->FPR 0.41304347826086957
-->FNR 0.044715447154471545
-->positive probability:0.8698630136986302, 254/292
-->group-truth label positive probability:0.8424657534246576, 246/292
-->identity female
-->length 195
-->ACC 0.8666666666666667
-->F1 0.9144736842105262
-->FPR 0.34782608695652173
-->FNR 0.06711409395973154
-->positive probability:0.7948717948717948, 155/195
-->group-truth label positive probability:0.764102564102564, 149/195
-->identity homosexual
-->length 14
-->ACC 0.9285714285714286
-->F1 0.9473684210526316
-->FPR 0.2
-->FNR 0.0
-->positive probability:0.7142857142857143, 10/14
-->group-truth label positive probability:0.6428571428571429, 9/14
-->identity christian
-->length 25
-->ACC 0.88
-->F1 0.9333333333333332
-->FPR 0.6666666666666666
-->FNR 0.045454545454545456
-->positive probability:0.92, 23/25
-->group-truth label positive probability:0.88, 22/25
-->identity muslim
-->length 13
-->ACC 0.8461538461538461
-->F1 0.888888888888889
-->FPR 0.4
-->FNR 0.0
-->positive probability:0.7692307692307693, 10/13
-->group-truth label positive probability:0.6153846153846154, 8/13
-->identity jewish
-->length 72
-->ACC 0.7222222222222222
-->F1 0.7368421052631579
-->FPR 0.4
-->FNR 0.125
-->positive probability:0.6111111111111112, 44/72
-->group-truth label positive probability:0.4444444444444444, 32/72
-->identity black
-->length 157
-->ACC 0.7898089171974523
-->F1 0.83248730964467
-->FPR 0.34375
-->FNR 0.11827956989247312
-->positive probability:0.6624203821656051, 104/157
-->group-truth label positive probability:0.5923566878980892, 93/157
-->identity white
-->length 381
-->ACC 0.8713910761154856
-->F1 0.9198036006546645
-->FPR 0.42045454545454547
-->FNR 0.040955631399317405
-->positive probability:0.8346456692913385, 318/381
-->group-truth label positive probability:0.7690288713910761, 293/381
-->fpr_diff [0.03370976849237717, 0.098927159796725, 0.24675324675324672, 0.2199134199134199, 0.04675324675324671, 0.04675324675324671, 0.10300324675324674, 0.026298701298701266]
-->fnr_diff [0.02383788169091882, 0.04623652849617882, 0.020877565463552725, 0.02457697999099273, 0.020877565463552725, 0.10412243453644728, 0.0974020044289204, 0.02007806593576468]
-->FPR:[0.41304347826086957, 0.34782608695652173, 0.2, 0.6666666666666666, 0.4, 0.4, 0.34375, 0.42045454545454547], mean FPR:0.39896759716732544, mean FPR metric:0.10276400456427628
-->FNR:[0.044715447154471545, 0.06711409395973154, 0.0, 0.045454545454545456, 0.0, 0.125, 0.11827956989247312, 0.040955631399317405], mean FNR:0.05518991098256738, mean FNR metric:0.04475112825079102
-->group metric: 0.04475112825079102
-->epoch 4
-->batch_size 98
-->weights tensor([2.3148, 0.6378], device='cuda:2')
-->FUR:0.0, FU:0.0, P:40
-->FUR:0.0, FU:0.0, P:26
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:4
-->None
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:13
-->FUR:0.0, FU:0.0, P:43
-->show_identity_num 7
-->z_score:-2.262918710708618, p_hat:0.00018011502106674016, n:98.0
-->bias_loss tensor(0.0016, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [5/5], Loss: 0.0016, acc_loss, 0.0000, bias_loss:0.0016
-->batch_size 98
-->weights tensor([1.9412, 0.6735], device='cuda:2')
-->FUR:0.0, FU:0.0, P:35
-->FUR:0.03846153989434242, FU:1.0, P:26
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:3
-->None
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.05882352963089943, FU:1.0, P:17
-->FUR:0.022727273404598236, FU:1.0, P:44
-->show_identity_num 7
-->z_score:-1.4911882877349854, p_hat:0.01717035099864006, n:98.0
-->bias_loss tensor(0.1543, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [5/5], Loss: 0.3506, acc_loss, 0.1964, bias_loss:0.1543
-->batch_size 98
-->weights tensor([2.7273, 0.6122], device='cuda:2')
-->FUR:0.0, FU:0.0, P:33
-->FUR:0.0, FU:0.0, P:16
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:11
-->FUR:0.0, FU:0.0, P:50
-->show_identity_num 8
-->z_score:-2.2639412879943848, p_hat:0.00015760063251946121, n:98.0
-->bias_loss tensor(0.0014, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [5/5], Loss: 0.0014, acc_loss, 0.0000, bias_loss:0.0014
-->batch_size 98
-->weights tensor([2.4600, 0.6276], device='cuda:2')
-->FUR:0.0, FU:0.0, P:35
-->FUR:0.03125, FU:1.0, P:32
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:11
-->FUR:0.0, FU:0.0, P:41
-->show_identity_num 8
-->z_score:-2.088557243347168, p_hat:0.004018821287900209, n:98.0
-->bias_loss tensor(0.0361, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [5/5], Loss: 0.4030, acc_loss, 0.3669, bias_loss:0.0361
-->batch_size 98
-->weights tensor([1.9848, 0.6684], device='cuda:2')
-->FUR:0.0, FU:0.0, P:25
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:8
-->FUR:0.0, FU:0.0, P:11
-->FUR:0.0, FU:0.0, P:48
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss tensor(0.0016, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [5/5], Loss: 0.3641, acc_loss, 0.3625, bias_loss:0.0016
-->batch_size 98
-->weights tensor([2.7273, 0.6122], device='cuda:2')
-->FUR:0.0, FU:0.0, P:43
-->FUR:0.0, FU:0.0, P:24
-->None
-->FUR:0.0, FU:0.0, P:3
-->None
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:15
-->FUR:0.0, FU:0.0, P:44
-->show_identity_num 6
-->z_score:-2.262918710708618, p_hat:0.00018011502106674016, n:98.0
-->bias_loss tensor(0.0016, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [5/5], Loss: 0.0200, acc_loss, 0.0184, bias_loss:0.0016
-->batch_size 98
-->weights tensor([2.0312, 0.6633], device='cuda:2')
-->FUR:0.0, FU:0.0, P:44
-->FUR:0.0, FU:0.0, P:25
-->FUR:0.0, FU:0.0, P:2
-->None
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:6
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:39
-->show_identity_num 7
-->z_score:-2.262918710708618, p_hat:0.00018011502106674016, n:98.0
-->bias_loss tensor(0.0016, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [5/5], Loss: 0.0016, acc_loss, 0.0000, bias_loss:0.0016
-->batch_size 98
-->weights tensor([2.2500, 0.6429], device='cuda:2')
-->FUR:0.0, FU:0.0, P:40
-->FUR:0.0, FU:0.0, P:22
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:6
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.0, FU:0.0, P:44
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss tensor(0.0016, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [5/5], Loss: 0.0016, acc_loss, 0.0000, bias_loss:0.0016
-->batch_size 98
-->weights tensor([3.5625, 0.5816], device='cuda:2')
-->FUR:0.0, FU:0.0, P:44
-->FUR:0.0, FU:0.0, P:32
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:8
-->FUR:0.0, FU:0.0, P:14
-->FUR:0.0, FU:0.0, P:29
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss tensor(0.0016, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [5/5], Loss: 0.0016, acc_loss, 0.0000, bias_loss:0.0016
-->batch_size 98
-->weights tensor([2.6304, 0.6173], device='cuda:2')
-->FUR:0.02857142873108387, FU:1.0, P:35
-->FUR:0.04545454680919647, FU:1.0, P:22
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.3333333432674408, FU:1.0, P:3
-->FUR:0.0, FU:0.0, P:9
-->FUR:0.05882352963089943, FU:1.0, P:17
-->FUR:0.021739130839705467, FU:1.0, P:46
-->show_identity_num 8
-->z_score:0.49715372920036316, p_hat:0.06094522029161453, n:98.0
-->bias_loss tensor(0.5475, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [5/5], Loss: 0.6207, acc_loss, 0.0732, bias_loss:0.5475
-->batch_size 98
-->weights tensor([1.9412, 0.6735], device='cuda:2')
-->FUR:0.0, FU:0.0, P:36
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.03999999910593033, FU:1.0, P:25
-->FUR:0.04878048598766327, FU:2.0, P:41
-->show_identity_num 8
-->z_score:-1.7629361152648926, p_hat:0.011187618598341942, n:98.0
-->bias_loss tensor(0.1005, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [5/5], Loss: 0.3315, acc_loss, 0.2310, bias_loss:0.1005
-->batch_size 98
-->weights tensor([1.9412, 0.6735], device='cuda:2')
-->FUR:0.054054055362939835, FU:2.0, P:37
-->FUR:0.043478261679410934, FU:1.0, P:23
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:21
-->FUR:0.019607843831181526, FU:1.0, P:51
-->show_identity_num 8
-->z_score:-1.6060073375701904, p_hat:0.014642521739006042, n:98.0
-->bias_loss tensor(0.1315, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [5/5], Loss: 0.3793, acc_loss, 0.2477, bias_loss:0.1315
-->batch_size 98
-->weights tensor([2.0806, 0.6582], device='cuda:2')
-->FUR:0.03333333507180214, FU:1.0, P:30
-->FUR:0.03846153989434242, FU:1.0, P:26
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:5
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.125, FU:5.0, P:40
-->show_identity_num 8
-->z_score:-1.1527252197265625, p_hat:0.0246218740940094, n:98.0
-->bias_loss tensor(0.2212, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [5/5], Loss: 0.5196, acc_loss, 0.2984, bias_loss:0.2212
-->batch_size 98
-->weights tensor([2.0312, 0.6633], device='cuda:2')
-->FUR:0.0, FU:0.0, P:34
-->FUR:0.0, FU:0.0, P:23
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.05882352963089943, FU:1.0, P:17
-->FUR:0.0, FU:0.0, P:49
-->show_identity_num 8
-->z_score:-1.9320015907287598, p_hat:0.007465512957423925, n:98.0
-->bias_loss tensor(0.0671, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [5/5], Loss: 0.1231, acc_loss, 0.0560, bias_loss:0.0671
-->batch_size 98
-->weights tensor([2.3846, 0.6327], device='cuda:2')
-->FUR:0.0, FU:0.0, P:32
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:12
-->FUR:0.0, FU:0.0, P:18
-->FUR:0.0, FU:0.0, P:49
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss tensor(0.0016, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [5/5], Loss: 0.0016, acc_loss, 0.0000, bias_loss:0.0016
-->batch_size 98
-->weights tensor([3.4000, 0.5862], device='cuda:2')
-->FUR:0.0, FU:0.0, P:38
-->FUR:0.0, FU:0.0, P:19
-->None
-->None
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:8
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:36
-->show_identity_num 6
-->z_score:-2.2642822265625, p_hat:0.00015009584603831172, n:98.0
-->bias_loss tensor(0.0013, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [5/5], Loss: 0.0013, acc_loss, 0.0000, bias_loss:0.0013
-->after epoch 4
-->overall baseline on testing dataset
-->ACC 0.9314855185300529
-->F1 0.9612266478674657
-->FPR: 0.3142857142857143
-->FNR: 0.03503184713375796
testing dataset
-->original metric score:
-->identity male
-->length 292
-->ACC 0.9075342465753424
-->F1 0.945010183299389
-->FPR 0.2826086956521739
-->FNR 0.056910569105691054
-->positive probability:0.839041095890411, 245/292
-->group-truth label positive probability:0.8424657534246576, 246/292
-->identity female
-->length 195
-->ACC 0.8923076923076924
-->F1 0.9283276450511946
-->FPR 0.17391304347826086
-->FNR 0.087248322147651
-->positive probability:0.7384615384615385, 144/195
-->group-truth label positive probability:0.764102564102564, 149/195
-->identity homosexual
-->length 14
-->ACC 1.0
-->F1 1.0
-->FPR 0.0
-->FNR 0.0
-->positive probability:0.6428571428571429, 9/14
-->group-truth label positive probability:0.6428571428571429, 9/14
-->identity christian
-->length 25
-->ACC 0.88
-->F1 0.9302325581395349
-->FPR 0.3333333333333333
-->FNR 0.09090909090909091
-->positive probability:0.84, 21/25
-->group-truth label positive probability:0.88, 22/25
-->identity muslim
-->length 13
-->ACC 0.7692307692307693
-->F1 0.823529411764706
-->FPR 0.4
-->FNR 0.125
-->positive probability:0.6923076923076923, 9/13
-->group-truth label positive probability:0.6153846153846154, 8/13
-->identity jewish
-->length 72
-->ACC 0.7638888888888888
-->F1 0.7536231884057971
-->FPR 0.275
-->FNR 0.1875
-->positive probability:0.5138888888888888, 37/72
-->group-truth label positive probability:0.4444444444444444, 32/72
-->identity black
-->length 157
-->ACC 0.7961783439490446
-->F1 0.8279569892473119
-->FPR 0.25
-->FNR 0.17204301075268819
-->positive probability:0.5923566878980892, 93/157
-->group-truth label positive probability:0.5923566878980892, 93/157
-->identity white
-->length 381
-->ACC 0.863517060367454
-->F1 0.911864406779661
-->FPR 0.3181818181818182
-->FNR 0.08191126279863481
-->positive probability:0.7795275590551181, 297/381
-->group-truth label positive probability:0.7690288713910761, 293/381
-->fpr_diff [0.03167701863354039, 0.14037267080745341, 0.3142857142857143, 0.019047619047619035, 0.08571428571428574, 0.03928571428571426, 0.06428571428571428, 0.0038961038961038974]
-->fnr_diff [0.021878721971933093, 0.052216475013893045, 0.03503184713375796, 0.05587724377533295, 0.08996815286624205, 0.15246815286624205, 0.13701116361893023, 0.04687941566487685]
-->FPR:[0.2826086956521739, 0.17391304347826086, 0.0, 0.3333333333333333, 0.4, 0.275, 0.25, 0.3181818181818182], mean FPR:0.2541296113306983, mean FPR metric:0.08732060511951817
-->FNR:[0.056910569105691054, 0.087248322147651, 0.0, 0.09090909090909091, 0.125, 0.1875, 0.17204301075268819, 0.08191126279863481], mean FNR:0.10019028196421949, mean FNR metric:0.07391639661390104
-->group metric: 0.07391639661390104
   test_acc   test_f1  ...  test_fnr_mean  test_fnr_metric
0  0.928371  0.959930  ...       0.062132         0.049570
1  0.925880  0.958980  ...       0.040076         0.036184
2  0.886640  0.932342  ...       0.362289         0.249762
3  0.928060  0.959931  ...       0.055190         0.044751
4  0.931486  0.961227  ...       0.100190         0.073916

[5 rows x 10 columns]
-->gamma 1.0
-->gamma 1.0
-->model AddedLayers(
  (model): Sequential(
    (0): Linear(in_features=4096, out_features=328, bias=True)
    (1): GELU(approximate='none')
    (2): Linear(in_features=328, out_features=4096, bias=True)
    (3): GELU(approximate='none')
    (4): Linear(in_features=4096, out_features=328, bias=True)
    (5): GELU(approximate='none')
    (6): Linear(in_features=328, out_features=4096, bias=True)
  )
)
-->classifier Linear(in_features=4096, out_features=2, bias=False)
-->MinValue:-2.271099895830676, MaxValue:2.2792810789854263
-->epoch 0
-->batch_size 98
-->weights tensor([2.3148, 0.6378], device='cuda:2')
-->FUR:0.0, FU:0.0, P:40
-->FUR:0.0, FU:0.0, P:26
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:4
-->None
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:13
-->FUR:0.0, FU:0.0, P:43
-->show_identity_num 7
-->z_score:-2.262918710708618, p_hat:0.00018011502106674016, n:98.0
-->bias_loss tensor(0.0018, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.3261, acc_loss, 0.3243, bias_loss:0.0018
-->batch_size 98
-->weights tensor([1.9412, 0.6735], device='cuda:2')
-->FUR:0.3142857253551483, FU:11.0, P:35
-->FUR:0.11328629404306412, FU:2.945443630218506, P:26
-->FUR:0.5, FU:1.0, P:2
-->FUR:0.3333333432674408, FU:1.0, P:3
-->None
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.1764705926179886, FU:3.0, P:17
-->FUR:0.20466011762619019, FU:9.005044937133789, P:44
-->show_identity_num 7
-->z_score:8.377994537353516, p_hat:0.23444795608520508, n:98.0
-->bias_loss tensor(1., device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 1.2536, acc_loss, 0.2536, bias_loss:1.0000
-->batch_size 98
-->weights tensor([2.7273, 0.6122], device='cuda:2')
-->FUR:0.0, FU:0.0, P:33
-->FUR:0.0, FU:0.0, P:16
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:7
-->FUR:0.0, FU:0.0, P:11
-->FUR:0.0, FU:0.0, P:50
-->show_identity_num 8
-->z_score:-2.2639412879943848, p_hat:0.00015760063251946121, n:98.0
-->bias_loss tensor(0.0016, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 1.0632, acc_loss, 1.0616, bias_loss:0.0016
-->batch_size 98
-->weights tensor([2.4600, 0.6276], device='cuda:2')
-->FUR:0.0, FU:0.0, P:35
-->FUR:4.563480615615845e-06, FU:0.00014603137969970703, P:32
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:11
-->FUR:0.0, FU:0.0, P:41
-->show_identity_num 8
-->z_score:-2.263967514038086, p_hat:0.00015703019744250923, n:98.0
-->bias_loss tensor(0.0016, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.0149, acc_loss, 0.0134, bias_loss:0.0016
-->batch_size 98
-->weights tensor([1.9848, 0.6684], device='cuda:2')
-->FUR:0.11844868957996368, FU:2.961217164993286, P:25
-->FUR:0.3111688494682312, FU:4.978701591491699, P:16
-->FUR:0.6666666865348816, FU:2.0, P:3
-->FUR:0.5, FU:1.0, P:2
-->FUR:0.48062434792518616, FU:0.9612486958503723, P:2
-->FUR:0.5, FU:4.0, P:8
-->FUR:0.4510685205459595, FU:4.961753845214844, P:11
-->FUR:0.22872503101825714, FU:10.978801727294922, P:48
-->show_identity_num 8
-->z_score:16.21146011352539, p_hat:0.40690767765045166, n:98.0
-->bias_loss tensor(1., device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 1.4529, acc_loss, 0.4529, bias_loss:1.0000
-->batch_size 98
-->weights tensor([2.7273, 0.6122], device='cuda:2')
-->FUR:0.0, FU:0.0, P:43
-->FUR:0.0, FU:0.0, P:24
-->None
-->FUR:0.0, FU:0.0, P:3
-->None
-->FUR:0.1999240219593048, FU:0.9996201395988464, P:5
-->FUR:0.0, FU:0.0, P:15
-->FUR:0.04545454680919647, FU:2.0, P:44
-->show_identity_num 6
-->z_score:-0.410775363445282, p_hat:0.040956467390060425, n:98.0
-->bias_loss tensor(0.4088, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.5737, acc_loss, 0.1649, bias_loss:0.4088
-->batch_size 98
-->weights tensor([2.0312, 0.6633], device='cuda:2')
-->FUR:0.022727273404598236, FU:1.0, P:44
-->FUR:0.0, FU:0.0, P:25
-->FUR:0.0, FU:0.0, P:2
-->None
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:6
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:39
-->show_identity_num 7
-->z_score:-2.1177821159362793, p_hat:0.00337540777400136, n:98.0
-->bias_loss tensor(0.0337, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.0474, acc_loss, 0.0137, bias_loss:0.0337
-->batch_size 98
-->weights tensor([2.2500, 0.6429], device='cuda:2')
-->FUR:0.0, FU:0.0, P:40
-->FUR:0.0, FU:0.0, P:22
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:6
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.0, FU:0.0, P:44
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss tensor(0.0018, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.0148, acc_loss, 0.0130, bias_loss:0.0018
-->batch_size 98
-->weights tensor([3.5625, 0.5816], device='cuda:2')
-->FUR:0.0, FU:0.0, P:44
-->FUR:0.03125, FU:1.0, P:32
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.3333333432674408, FU:1.0, P:3
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:8
-->FUR:0.0, FU:0.0, P:14
-->FUR:0.0, FU:0.0, P:29
-->show_identity_num 8
-->z_score:-0.19699612259864807, p_hat:0.045662980526685715, n:98.0
-->bias_loss tensor(0.4558, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.5295, acc_loss, 0.0737, bias_loss:0.4558
-->batch_size 98
-->weights tensor([2.6304, 0.6173], device='cuda:2')
-->FUR:0.0, FU:0.0, P:35
-->FUR:0.0, FU:0.0, P:22
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:9
-->FUR:0.0, FU:0.0, P:17
-->FUR:0.0, FU:0.0, P:46
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss tensor(0.0018, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.0031, acc_loss, 0.0013, bias_loss:0.0018
-->batch_size 98
-->weights tensor([1.9412, 0.6735], device='cuda:2')
-->FUR:0.0, FU:0.0, P:36
-->FUR:0.0, FU:0.0, P:16
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:1
-->FUR:0.0, FU:0.0, P:2
-->FUR:0.0, FU:0.0, P:4
-->FUR:0.0, FU:0.0, P:25
-->FUR:0.0, FU:0.0, P:41
-->show_identity_num 8
-->z_score:-2.262918710708618, p_hat:0.00018011500651482493, n:98.0
-->bias_loss tensor(0.0018, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.0045, acc_loss, 0.0027, bias_loss:0.0018
-->batch_size 98
-->weights tensor([1.9412, 0.6735], device='cuda:2')
-->FUR:0.0, FU:0.0, P:37
-->FUR:0.0, FU:0.0, P:23
-->FUR:0.0, FU:0.0, P:1
-->FUR:nan, FU:0.0, P:0
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:21
-->FUR:0.019607843831181526, FU:1.0, P:51
-->show_identity_num 8
-->z_score:-2.1556808948516846, p_hat:0.0025410379748791456, n:98.0
-->bias_loss tensor(0.0254, device='cuda:2', grad_fn=<MulBackward0>)
Epoch [1/5], Loss: 0.1276, acc_loss, 0.1022, bias_loss:0.0254
-->batch_size 98
-->weights tensor([2.0806, 0.6582], device='cuda:2')
-->FUR:0.0, FU:0.0, P:30
-->FUR:0.0, FU:0.0, P:26
-->FUR:0.0, FU:0.0, P:3
-->FUR:0.0, FU:0.0, P:5
-->FUR:nan, FU:0.0, P:0
-->FUR:0.0, FU:0.0, P:5
-->FUR:0.0, FU:0.0, P:10
-->FUR:0.0, FU:0.0, P:40
-->show_identity_num 8
